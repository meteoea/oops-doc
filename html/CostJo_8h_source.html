<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OOPS Documentation: src/oops/assimilation/CostJo.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OOPS Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_afa5bd3fe80c99e418f1c47086bf1a5a.html">oops</a></li><li class="navelem"><a class="el" href="dir_fcca2513b47fd1c6ccb424945867cb8c.html">assimilation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CostJo.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CostJo_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * (C) Copyright 2009-2016 ECMWF.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This software is licensed under the terms of the Apache Licence Version 2.0</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * In applying this licence, ECMWF does not waive the privileges and immunities</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * granted to it by virtue of its status as an intergovernmental organisation</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * nor does it submit to any jurisdiction.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#ifndef OOPS_ASSIMILATION_COSTJO_H_</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#define OOPS_ASSIMILATION_COSTJO_H_</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span>  <span class="comment">// for std::dynamic_pointer_cast, std::shared_ptr, std::unique_ptr</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;eckit/config/LocalConfiguration.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;eckit/memory/NonCopyable.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ControlIncrement_8h.html">oops/assimilation/ControlIncrement.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ControlVariable_8h.html">oops/assimilation/ControlVariable.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CostTermBase_8h.html">oops/assimilation/CostTermBase.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Departures_8h.html">oops/base/Departures.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LinearObsOperators_8h.html">oops/base/LinearObsOperators.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObsAuxControls_8h.html">oops/base/ObsAuxControls.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObsErrors_8h.html">oops/base/ObsErrors.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObsOperators_8h.html">oops/base/ObsOperators.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObservationSpaces_8h.html">oops/base/ObservationSpaces.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Observations_8h.html">oops/base/Observations.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Observer_8h.html">oops/base/Observer.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObserverAD_8h.html">oops/base/ObserverAD.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObserverTL_8h.html">oops/base/ObserverTL.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PostBase_8h.html">oops/base/PostBase.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PostBaseAD_8h.html">oops/base/PostBaseAD.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PostBaseTL_8h.html">oops/base/PostBaseTL.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GeoVaLs_8h.html">oops/interface/GeoVaLs.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oops_2interface_2Geometry_8h.html">oops/interface/Geometry.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oops_2interface_2Increment_8h.html">oops/interface/Increment.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oops_2interface_2State_8h.html">oops/interface/State.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DateTime_8h.html">util/DateTime.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Duration_8h.html">util/Duration.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Logger_8h.html">util/Logger.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoops.html">oops</a> {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html">  218</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoops_1_1CostJo.html">CostJo</a> : <span class="keyword">public</span> <a class="code" href="classoops_1_1CostTermBase.html">CostTermBase</a>&lt;MODEL&gt;, <span class="keyword">private</span> eckit::NonCopyable {</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a26d3de1fa0f729df243d3d87e363b5ae">  219</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1ControlVariable.html">CtrlVar_</a> = <a class="code" href="classoops_1_1ControlVariable.html">ControlVariable&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ae9d99cb14f33f1647bd137ea7d26f2b9">  220</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1ControlIncrement.html">CtrlInc_</a> = <a class="code" href="classoops_1_1ControlIncrement.html">ControlIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">  221</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1Departures.html">Departures_</a> = <a class="code" href="classoops_1_1Departures.html">Departures&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a69d1f06e1f127ef25e19341de12a9072">  222</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1Observations.html">Observations_</a> = <a class="code" href="classoops_1_1Observations.html">Observations&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a50a27b3a207dd7bb5aecbd695a090b0b">  223</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1Geometry.html">Geometry_</a> = <a class="code" href="classoops_1_1Geometry.html">Geometry&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a0acc2acc0fc723c33d7c8f76b0b992c4">  224</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1GeoVaLs.html">GeoVaLs_</a> = <a class="code" href="classoops_1_1GeoVaLs.html">GeoVaLs&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#acc7c823f2633822e997c2ac24176eec1">  225</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1State.html">State_</a> = <a class="code" href="classoops_1_1State.html">State&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ac13feb07a68f598ef5631de8c07da8fa">  226</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1Increment.html">Increment_</a> = <a class="code" href="classoops_1_1Increment.html">Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a8eae24a33735641eb5b3d1fb892533ee">  227</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1ObsAuxControls.html">ObsAuxControls_</a> = <a class="code" href="classoops_1_1ObsAuxControls.html">ObsAuxControls&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a1f3c7fe4911156af2f793201216c4df1">  228</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1ObsErrors.html">ObsErrors_</a> = <a class="code" href="classoops_1_1ObsErrors.html">ObsErrors&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#aee1a026f4c2453f92b9952ba6a71b5e9">  229</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1ObsOperators.html">ObsOperators_</a> = <a class="code" href="classoops_1_1ObsOperators.html">ObsOperators&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a3218544321e2a4f616eb52f6e877e80d">  230</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1ObservationSpaces.html">ObsSpaces_</a> = <a class="code" href="classoops_1_1ObservationSpaces.html">ObservationSpaces&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#abac7b0165c28a802e490a3d2bc330a8a">  231</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classoops_1_1LinearObsOperators.html">LinearObsOperators_</a> = <a class="code" href="classoops_1_1LinearObsOperators.html">LinearObsOperators&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a7eaaa6a4605bc90b3ec1e72d6802e717">  234</a></span>&#160;  <span class="keyword">const</span> std::string <a class="code" href="classoops_1_1CostJo.html#a7eaaa6a4605bc90b3ec1e72d6802e717">classname</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;Jo&quot;</span>; }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107efaa1f7c5295f32377647ff9df173982a53">  237</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107ef">OS</a> : <span class="keywordtype">size_t</span> { <a class="code" href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107efa9de8e148fb6c941d79b3c1ba4c5f0bf4">NotScreened</a> = 0, <a class="code" href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107efaa1f7c5295f32377647ff9df173982a53">Screened</a> = 1, <a class="code" href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107efaf5c164e62b8b1ee0d59f4f93b77d447b">Quadratic</a> = 2 };</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="classoops_1_1CostJo.html#a31bd4e4e5f9a73381a3c6bc4bcc32fc4">CostJo</a>(<span class="keyword">const</span> eckit::Configuration &amp;, <span class="keyword">const</span> <a class="code" href="classoops_1_1CostJo.html#a50a27b3a207dd7bb5aecbd695a090b0b">Geometry_</a> &amp;geom,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;         <span class="keyword">const</span> util::DateTime &amp;, <span class="keyword">const</span> util::DateTime &amp;, <span class="keyword">const</span> util::Duration &amp;,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">bool</span> subwindows = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#aa8fb94902226d4cf52ffb5b1f147ac8f">  245</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classoops_1_1CostJo.html#aa8fb94902226d4cf52ffb5b1f147ac8f">~CostJo</a>() {}</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  std::shared_ptr&lt;PostBase&lt;State_&gt; &gt; <a class="code" href="classoops_1_1CostJo.html#a6d8ef544f60faf1c4d722c43d3c5f365">initialize</a>(</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keyword">const</span> <a class="code" href="classoops_1_1CostJo.html#a26d3de1fa0f729df243d3d87e363b5ae">CtrlVar_</a> &amp;, <span class="keyword">const</span> eckit::Configuration &amp;) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  std::shared_ptr&lt;PostBase&lt;State_&gt; &gt; <a class="code" href="classoops_1_1CostJo.html#ac16b6c752e4f5fc44205251a43065735">initializeTraj</a>(</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keyword">const</span> <a class="code" href="classoops_1_1CostJo.html#a26d3de1fa0f729df243d3d87e363b5ae">CtrlVar_</a> &amp;, <span class="keyword">const</span> <a class="code" href="classoops_1_1CostJo.html#a50a27b3a207dd7bb5aecbd695a090b0b">Geometry_</a> &amp;,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keyword">const</span> eckit::Configuration &amp;) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoops_1_1CostJo.html#a20765c265859ba0e30cc34f5302c0d31">finalize</a>(<span class="keyword">const</span> eckit::Configuration &amp;) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoops_1_1CostJo.html#a473d7f8463e4ae7b6bcb5015fff3f233">finalizeTraj</a>(<span class="keyword">const</span> eckit::Configuration &amp;) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a51fc766070aec1205489415fca08e81a">screenObservations</a>(std::unique_ptr&lt;Observations_&gt; &amp;,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                          <span class="keyword">const</span> eckit::Configuration &amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  std::shared_ptr&lt;PostBaseTL&lt;Increment_&gt; &gt; <a class="code" href="classoops_1_1CostJo.html#a0cf21e6bf99d2a02ce80497b5ff0e832">setupTL</a>(</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keyword">const</span> <a class="code" href="classoops_1_1CostJo.html#ae9d99cb14f33f1647bd137ea7d26f2b9">CtrlInc_</a> &amp;) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  std::shared_ptr&lt;PostBaseAD&lt;Increment_&gt; &gt; <a class="code" href="classoops_1_1CostJo.html#ac381a940bef3cb634d9f10774415695a">setupAD</a>(</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      std::shared_ptr&lt;const GeneralizedDepartures&gt;, <a class="code" href="classoops_1_1CostJo.html#ae9d99cb14f33f1647bd137ea7d26f2b9">CtrlInc_</a> &amp;) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <a class="code" href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">Departures_</a> *<a class="code" href="classoops_1_1CostJo.html#a9a0eab45d0a0cf121c4b835d2222bab8">multiplyCovar</a>(<span class="keyword">const</span> <a class="code" href="classoops_1_1GeneralizedDepartures.html">GeneralizedDepartures</a> &amp;) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">Departures_</a> *<a class="code" href="classoops_1_1CostJo.html#a4cf7984c7dc5be3a58894203f25090e7">multiplyCoInv</a>(<span class="keyword">const</span> <a class="code" href="classoops_1_1GeneralizedDepartures.html">GeneralizedDepartures</a> &amp;) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">Departures_</a> *<a class="code" href="classoops_1_1CostJo.html#a728c458f1f7bcdb6eed61f9aee3f48bc">newDualVector</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#abdb995be9e71096f1a34d27864d96833">  284</a></span>&#160;  <a class="code" href="classoops_1_1Departures.html">Departures_</a> *<a class="code" href="classoops_1_1CostJo.html#abdb995be9e71096f1a34d27864d96833">newDepartures</a>()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">Departures_</a>(*<a class="code" href="classoops_1_1CostJo.html#a84b83f064efca2b6fad70ad26836b7b3">ydep_</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#aa4e3165d1ec4bb5ebb98e820c8245991">  289</a></span>&#160;  <a class="code" href="classoops_1_1Departures.html">Departures_</a> *<a class="code" href="classoops_1_1CostJo.html#aa4e3165d1ec4bb5ebb98e820c8245991">newGradientFG</a>()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">Departures_</a>(*<a class="code" href="classoops_1_1CostJo.html#a9caf2dc103eae322870b9591c7f79fab">gradFG_</a>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a02ce1c86c4295907bb78beb895883333">resetLinearization</a>() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoops_1_1CostJo.html#ac15e252f153e54195f1e19b9cda107a9">printJo</a>(<span class="keyword">const</span> <a class="code" href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">Departures_</a> &amp;, <span class="keyword">const</span> <a class="code" href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">Departures_</a> &amp;,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">size_t</span> &amp;<a class="code" href="config_8intfb_8h.html#a564260a5bdf721c2836ab616ca2e83c5">type</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a6fc72d99578f3d4ce6244e520c25c905">  301</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classoops_1_1ObservationSpaces.html">ObsSpaces_</a> &amp;<a class="code" href="classoops_1_1CostJo.html#a6fc72d99578f3d4ce6244e520c25c905">obspaces</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<a class="code" href="classoops_1_1CostJo.html#af211a5d2f4b5a04315865d4fc5cfca13">obsSpaces_</a>; }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a029ee4c09a37bc9255ca5d003beb67e8">checkpoint</a>(eckit::LocalConfiguration &amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a201df549be43dc054f07b8a05615633b">restart</a>(<span class="keyword">const</span> eckit::Configuration &amp;);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a3e8ca24a08b0dfc2e3ff9c280036d701">  310</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a3e8ca24a08b0dfc2e3ff9c280036d701">setBackground</a>(<span class="keyword">const</span> <a class="code" href="classoops_1_1ControlVariable.html">CtrlVar_</a> &amp;xb)<span class="keyword"> const </span>{ <a class="code" href="classoops_1_1CostJo.html#ac35d897c2d0a1a9b1959a2b0f5e76df8">xb_</a> = &amp;xb; }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a1a4e233b0db9abb55780b2dfdf56ccf0">  313</a></span>&#160;  <span class="keyword">const</span> eckit::LocalConfiguration <a class="code" href="classoops_1_1CostJo.html#a1a4e233b0db9abb55780b2dfdf56ccf0">conf_</a>;  </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ab84830651f83780d8989c645a956d928">  315</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classoops_1_1Geometry.html">Geometry_</a> &amp;<a class="code" href="classoops_1_1CostJo.html#ab84830651f83780d8989c645a956d928">geom_</a>;  </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#acae760ea80fa3355c6dc90a89f9dac9b">  317</a></span>&#160;  <span class="keyword">const</span> util::DateTime <a class="code" href="classoops_1_1CostJo.html#acae760ea80fa3355c6dc90a89f9dac9b">winbgn_</a>;  </div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a6824fb0431774ae8583f6cd28975d458">  318</a></span>&#160;  <span class="keyword">const</span> util::DateTime <a class="code" href="classoops_1_1CostJo.html#a6824fb0431774ae8583f6cd28975d458">winend_</a>;  </div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#aba5fff9b3bb7f9c4aa4a10fd591b1859">  319</a></span>&#160;  <span class="keyword">const</span> util::Duration <a class="code" href="classoops_1_1CostJo.html#aba5fff9b3bb7f9c4aa4a10fd591b1859">tslot_</a>;   </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ad8084c2ea97f4a18df48fb1a90e3c570">  321</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classoops_1_1CostJo.html#ad8084c2ea97f4a18df48fb1a90e3c570">subwindows_</a>;    </div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#aa1e1f31a57edc0023460aa0ecd8a3c25">  322</a></span>&#160;  <span class="keyword">mutable</span> <span class="keywordtype">bool</span> <a class="code" href="classoops_1_1CostJo.html#aa1e1f31a57edc0023460aa0ecd8a3c25">lsetupOnce_</a>;  </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keyword">mutable</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#acaab2f925c4030f3b0d031eeada40dcd">  324</a></span>&#160;      <a class="code" href="classoops_1_1CostJo.html#acaab2f925c4030f3b0d031eeada40dcd">lscreenObservations_</a>;  </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ac35d897c2d0a1a9b1959a2b0f5e76df8">  326</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classoops_1_1ControlVariable.html">CtrlVar_</a> <span class="keyword">mutable</span> *<a class="code" href="classoops_1_1CostJo.html#ac35d897c2d0a1a9b1959a2b0f5e76df8">xb_</a>;  </div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ab47c8c6a779927467e7a9e7827cb994e">  327</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classoops_1_1ControlVariable.html">CtrlVar_</a> <span class="keyword">mutable</span> *<a class="code" href="classoops_1_1CostJo.html#ab47c8c6a779927467e7a9e7827cb994e">fg_</a>;  </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#af211a5d2f4b5a04315865d4fc5cfca13">  329</a></span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;ObsSpaces_&gt; <a class="code" href="classoops_1_1CostJo.html#af211a5d2f4b5a04315865d4fc5cfca13">obsSpaces_</a>;  </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;ObsOperators_&gt;</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a53da9090b91e37f0b5f5856266747ac2">  332</a></span>&#160;      <a class="code" href="classoops_1_1CostJo.html#a53da9090b91e37f0b5f5856266747ac2">hop_</a>;  </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  std::shared_ptr&lt;LinearObsOperators_&gt;</div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#afe1a54cf8c86b03900d4ca0c03d5f1eb">  334</a></span>&#160;      <a class="code" href="classoops_1_1CostJo.html#afe1a54cf8c86b03900d4ca0c03d5f1eb">hoptlad_</a>;  </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;ObsErrors_&gt;</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a49ff2aaeb1089107ca4527aab0e8c1ea">  336</a></span>&#160;      <a class="code" href="classoops_1_1CostJo.html#a49ff2aaeb1089107ca4527aab0e8c1ea">R_</a>;  </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a0ccf115a20500f74561f75d2fd37e8d1">  338</a></span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;Observations_&gt; <a class="code" href="classoops_1_1CostJo.html#a0ccf115a20500f74561f75d2fd37e8d1">yobs_</a>;  </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;Departures_&gt;</div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a84b83f064efca2b6fad70ad26836b7b3">  340</a></span>&#160;      <a class="code" href="classoops_1_1CostJo.html#a84b83f064efca2b6fad70ad26836b7b3">ydep_</a>;  </div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a9caf2dc103eae322870b9591c7f79fab">  341</a></span>&#160;  <span class="keyword">mutable</span> std::unique_ptr&lt;Departures_&gt; <a class="code" href="classoops_1_1CostJo.html#a9caf2dc103eae322870b9591c7f79fab">gradFG_</a>;  </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a932e5bf21ccc48c7d7db2fbeccdcf1ba">  346</a></span>&#160;  <span class="keyword">mutable</span> std::shared_ptr&lt;Observer&lt;MODEL, State_&gt; &gt; <a class="code" href="classoops_1_1CostJo.html#a932e5bf21ccc48c7d7db2fbeccdcf1ba">pobs_</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a58c62568991a776f91a2a6850407c31c">  350</a></span>&#160;  <span class="keyword">mutable</span> std::shared_ptr&lt;Observer&lt;MODEL, State_&gt; &gt; <a class="code" href="classoops_1_1CostJo.html#a58c62568991a776f91a2a6850407c31c">pobstraj_</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a8017c8c12b30ca89f297219a6140970b">  353</a></span>&#160;  <span class="keyword">mutable</span> std::shared_ptr&lt;ObserverTL&lt;MODEL, Increment_&gt; &gt; <a class="code" href="classoops_1_1CostJo.html#a8017c8c12b30ca89f297219a6140970b">pobstl_</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#aaf6eb952736c6f7fc2a3750392c94d7c">  356</a></span>&#160;  <span class="keyword">mutable</span> std::shared_ptr&lt;ObserverAD&lt;MODEL, Increment_&gt; &gt; <a class="code" href="classoops_1_1CostJo.html#aaf6eb952736c6f7fc2a3750392c94d7c">pobsad_</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;};</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">// =============================================================================</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a31bd4e4e5f9a73381a3c6bc4bcc32fc4">  362</a></span>&#160;<a class="code" href="classoops_1_1CostJo.html#a31bd4e4e5f9a73381a3c6bc4bcc32fc4">CostJo&lt;MODEL&gt;::CostJo</a>(<span class="keyword">const</span> eckit::Configuration &amp;joConf, <span class="keyword">const</span> <a class="code" href="classoops_1_1Geometry.html">Geometry_</a> &amp;geom,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                      <span class="keyword">const</span> util::DateTime &amp;winbgn,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                      <span class="keyword">const</span> util::DateTime &amp;winend, <span class="keyword">const</span> util::Duration &amp;ts,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">bool</span> subwindows)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    : conf_(joConf),</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      geom_(geom),</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      winbgn_(winbgn),</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      winend_(winend),</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      tslot_(ts),</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      subwindows_(subwindows),</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      lsetupOnce_(true),</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      lscreenObservations_(false),</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      xb_(),</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      fg_(),</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      obsSpaces_(),</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      hop_(),</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      hoptlad_(),</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      R_(),</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      yobs_(),</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      ydep_(),</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      gradFG_(),</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      pobs_(),</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      pobstraj_(),</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      pobstl_(),</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      pobsad_() {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// Check if screening block is present</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classoops_1_1CostJo.html#a1a4e233b0db9abb55780b2dfdf56ccf0">conf_</a>.has(<span class="stringliteral">&quot;screening&quot;</span>)) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// Check if screening is requested</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordtype">bool</span> lscreen = <a class="code" href="classoops_1_1CostJo.html#a1a4e233b0db9abb55780b2dfdf56ccf0">conf_</a>.getBool(<span class="stringliteral">&quot;screening&quot;</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    Log::info() &lt;&lt; <span class="stringliteral">&quot;CostJo::CostJo lscreen = &quot;</span> &lt;&lt; lscreen &lt;&lt; std::endl;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (lscreen) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="comment">// Load un-screened ObservationSpaces if screening is requested</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <a class="code" href="classoops_1_1CostJo.html#af211a5d2f4b5a04315865d4fc5cfca13">obsSpaces_</a>.reset(</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <span class="keyword">new</span> <a class="code" href="classoops_1_1CostJo.html#a3218544321e2a4f616eb52f6e877e80d">ObsSpaces_</a>(<a class="code" href="classoops_1_1CostJo.html#a1a4e233b0db9abb55780b2dfdf56ccf0">conf_</a>, <a class="code" href="classoops_1_1CostJo.html#ab84830651f83780d8989c645a956d928">geom_</a>, <a class="code" href="classoops_1_1CostJo.html#acae760ea80fa3355c6dc90a89f9dac9b">winbgn_</a>, <a class="code" href="classoops_1_1CostJo.html#a6824fb0431774ae8583f6cd28975d458">winend_</a>, OS::NotScreened));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="comment">// Load screened ObservationSpaces if screening is not requested</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <a class="code" href="classoops_1_1CostJo.html#af211a5d2f4b5a04315865d4fc5cfca13">obsSpaces_</a>.reset(</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          <span class="keyword">new</span> <a class="code" href="classoops_1_1CostJo.html#a3218544321e2a4f616eb52f6e877e80d">ObsSpaces_</a>(<a class="code" href="classoops_1_1CostJo.html#a1a4e233b0db9abb55780b2dfdf56ccf0">conf_</a>, <a class="code" href="classoops_1_1CostJo.html#ab84830651f83780d8989c645a956d928">geom_</a>, <a class="code" href="classoops_1_1CostJo.html#acae760ea80fa3355c6dc90a89f9dac9b">winbgn_</a>, <a class="code" href="classoops_1_1CostJo.html#a6824fb0431774ae8583f6cd28975d458">winend_</a>, OS::Screened));</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// Load screened ObservationSpaces if screening block is missing</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="classoops_1_1CostJo.html#af211a5d2f4b5a04315865d4fc5cfca13">obsSpaces_</a>.reset(</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keyword">new</span> <a class="code" href="classoops_1_1CostJo.html#a3218544321e2a4f616eb52f6e877e80d">ObsSpaces_</a>(<a class="code" href="classoops_1_1CostJo.html#a1a4e233b0db9abb55780b2dfdf56ccf0">conf_</a>, <a class="code" href="classoops_1_1CostJo.html#ab84830651f83780d8989c645a956d928">geom_</a>, <a class="code" href="classoops_1_1CostJo.html#acae760ea80fa3355c6dc90a89f9dac9b">winbgn_</a>, <a class="code" href="classoops_1_1CostJo.html#a6824fb0431774ae8583f6cd28975d458">winend_</a>, OS::Screened));</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostJo:CostJo done&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a6d8ef544f60faf1c4d722c43d3c5f365">  416</a></span>&#160;std::shared_ptr&lt;PostBase&lt;State&lt;MODEL&gt; &gt; &gt; <a class="code" href="classoops_1_1CostJo.html#a6d8ef544f60faf1c4d722c43d3c5f365">CostJo&lt;MODEL&gt;::initialize</a>(</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoops_1_1ControlVariable.html">CtrlVar_</a> &amp;fg, <span class="keyword">const</span> eckit::Configuration &amp;conf)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  ASSERT(lscreenObservations_ == <span class="keyword">false</span>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;screening&quot;</span>))</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    lscreenObservations_ = conf.getBool(<span class="stringliteral">&quot;screening.active&quot;</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  fg_ = &amp;fg;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">if</span> (not lsetupOnce_ &amp;&amp; lscreenObservations_) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// Close ObservationSpaces</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    obsSpaces_.reset();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// Open new ObservationSpaces</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    obsSpaces_.reset(</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keyword">new</span> <a class="code" href="classoops_1_1ObservationSpaces.html">ObsSpaces_</a>(conf_, geom_, winbgn_, winend_, OS::NotScreened));</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">if</span> (lsetupOnce_ || lscreenObservations_) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// Setup once or reset operators if new screening is to be performed</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    hop_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1ObsOperators.html">ObsOperators_</a>(*obsSpaces_));</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    R_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1ObsErrors.html">ObsErrors_</a>(*obsSpaces_));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    yobs_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1Observations.html">Observations_</a>(*obsSpaces_));</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    yobs_-&gt;<a class="code" href="classoops_1_1ControlVariable.html#ab0d586bcc35408b75555e9eafd6fd501">read</a>(conf_);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// Read and apply correction to the observation vector( In the case of EDA )</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (conf_.has(<span class="stringliteral">&quot;apply_correction&quot;</span>)) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keyword">const</span> eckit::LocalConfiguration biasconf(conf_, <span class="stringliteral">&quot;apply_correction&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      Log::info() &lt;&lt; <span class="stringliteral">&quot;Jo: Apply correction to yobs from : &quot;</span> &lt;&lt; biasconf &lt;&lt; std::endl;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="classoops_1_1Departures.html">Departures_</a> dy(*obsSpaces_);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      dy.<a class="code" href="classoops_1_1Departures.html#ace0afd3172cab34defb8bc9f6a26059b">read</a>(biasconf);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      (*yobs_) -= dy;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  pobs_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1Observer.html">Observer&lt;MODEL, State_&gt;</a>(*obsSpaces_, *hop_, fg_-&gt;obsVar(),</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                          tslot_, subwindows_));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">return</span> pobs_;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;}</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a20765c265859ba0e30cc34f5302c0d31">  469</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoops_1_1CostJo.html#a20765c265859ba0e30cc34f5302c0d31">CostJo&lt;MODEL&gt;::finalize</a>(<span class="keyword">const</span> eckit::Configuration &amp;conf)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  std::unique_ptr&lt;Observations_&gt; yeqv(pobs_-&gt;release());</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  Log::info() &lt;&lt; <span class="stringliteral">&quot;Jo Observation Equivalent: &quot;</span> &lt;&lt; *yeqv &lt;&lt; std::endl;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">// 1.5. Reload observations if H operator change the observation vector</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;reload_observations&quot;</span>)) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    yobs_-&gt;read(conf_);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  ydep_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1Departures.html">Departures_</a>(*yobs_ - *yeqv));</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  Log::info() &lt;&lt; <span class="stringliteral">&quot;Jo Departures: &quot;</span> &lt;&lt; *ydep_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;statesObsAux&quot;</span>)) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    fg_-&gt;obsVar().write(conf);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">if</span> (lscreenObservations_) this-&gt;screenObservations(yeqv, conf);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  R_-&gt;linearize(*yeqv);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">if</span> (conf.getBool(<span class="stringliteral">&quot;varQC.activate&quot;</span>, <span class="keyword">false</span>)) R_-&gt;setupWeights(*ydep_);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  gradFG_.reset(R_-&gt;inverseMultiply(*ydep_));</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordtype">double</span> zjo = this-&gt;printJo(*ydep_, *gradFG_, OS::Screened);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  eckit::LocalConfiguration diagnostics;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;diagnostics&quot;</span>)) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    diagnostics = eckit::LocalConfiguration(conf, <span class="stringliteral">&quot;diagnostics&quot;</span>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span> (diagnostics.has(<span class="stringliteral">&quot;departures&quot;</span>)) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keyword">const</span> eckit::LocalConfiguration depconf(diagnostics, <span class="stringliteral">&quot;departures&quot;</span>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      ydep_-&gt;save(depconf);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  pobs_.reset();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// Reset the first guess pointer</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  fg_ = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">return</span> zjo;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a51fc766070aec1205489415fca08e81a">  532</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a51fc766070aec1205489415fca08e81a">CostJo&lt;MODEL&gt;::screenObservations</a>(std::unique_ptr&lt;Observations_&gt; &amp;yeqv,</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                       <span class="keyword">const</span> eckit::Configuration &amp;conf)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// ---------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// MC: should be implemented as a post-processor in the Observer at some point</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// ---------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span>  R_-&gt;linearize(*yeqv);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">if</span> (conf.getBool(<span class="stringliteral">&quot;varQC.activate&quot;</span>, <span class="keyword">false</span>)) R_-&gt;setupWeights(*ydep_);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  std::unique_ptr&lt;Departures_&gt; gradFG(R_-&gt;inverseMultiply(*ydep_));</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">double</span> zjo = this-&gt;printJo(*ydep_, *gradFG, OS::NotScreened);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  Log::debug() &lt;&lt; <span class="stringliteral">&quot;CostJo (before screening)&quot;</span> &lt;&lt; zjo &lt;&lt; std::endl;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keyword">const</span> eckit::LocalConfiguration depconf(conf, <span class="stringliteral">&quot;screening.departures&quot;</span>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  ydep_-&gt;save(depconf);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keyword">const</span> std::vector&lt;std::shared_ptr&lt;GeoVaLs_&gt; &gt; &amp;gvals = pobs_-&gt;geovals();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  obsSpaces_-&gt;screenObservations(*ydep_, gvals);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  obsSpaces_.reset();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  obsSpaces_.reset(</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keyword">new</span> <a class="code" href="classoops_1_1ObservationSpaces.html">ObsSpaces_</a>(conf_, geom_, winbgn_, winend_, OS::Screened));</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  R_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1ObsErrors.html">ObsErrors_</a>(*obsSpaces_));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  hop_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1ObsOperators.html">ObsOperators_</a>(*obsSpaces_));</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  yobs_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1Observations.html">Observations_</a>(*obsSpaces_));</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  yobs_-&gt;read(conf_);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  ydep_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1Departures.html">Departures_</a>(*obsSpaces_));</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  ydep_-&gt;read(depconf);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  yeqv.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1Observations.html">Observations_</a>(*yobs_));</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  *yeqv -= *ydep_;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <a class="code" href="classoops_1_1ObsAuxControls.html">ObsAuxControls_</a> &amp;obsvarfg = <span class="keyword">const_cast&lt;</span><a class="code" href="classoops_1_1ObsAuxControls.html">ObsAuxControls_</a> &amp;<span class="keyword">&gt;</span>(fg_-&gt;obsVar());</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  obsvarfg.<a class="code" href="classoops_1_1ObsAuxControls.html#a90dff2500a64e642ee2440c3e05d1982">reset</a>(*obsSpaces_, <span class="stringliteral">&quot;fg&quot;</span>, conf);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <a class="code" href="classoops_1_1ObsAuxControls.html">ObsAuxControls_</a> &amp;obsvarbg = <span class="keyword">const_cast&lt;</span><a class="code" href="classoops_1_1ObsAuxControls.html">ObsAuxControls_</a> &amp;<span class="keyword">&gt;</span>(xb_-&gt;obsVar());</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  obsvarbg.<a class="code" href="classoops_1_1ObsAuxControls.html#a90dff2500a64e642ee2440c3e05d1982">reset</a>(*obsSpaces_, <span class="stringliteral">&quot;xb&quot;</span>, conf);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ac16b6c752e4f5fc44205251a43065735">  595</a></span>&#160;std::shared_ptr&lt;PostBase&lt;State&lt;MODEL&gt; &gt; &gt; <a class="code" href="classoops_1_1CostJo.html#ac16b6c752e4f5fc44205251a43065735">CostJo&lt;MODEL&gt;::initializeTraj</a>(</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoops_1_1ControlVariable.html">CtrlVar_</a> &amp;fg, <span class="keyword">const</span> <a class="code" href="classoops_1_1Geometry.html">Geometry_</a> &amp;, <span class="keyword">const</span> eckit::Configuration &amp;conf) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  util::Duration tltstep = tslot_;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;linearmodel&quot;</span>))</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    tltstep = util::Duration(conf.getString(<span class="stringliteral">&quot;linearmodel.tstep&quot;</span>));</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;timeslot&quot;</span>))</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    tltstep = util::Duration(conf.getString(<span class="stringliteral">&quot;timeslot&quot;</span>));</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  hoptlad_.reset();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  pobstraj_.reset();</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  hoptlad_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1LinearObsOperators.html">LinearObsOperators_</a>(*obsSpaces_));</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  pobstraj_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1Observer.html">Observer&lt;MODEL, State_&gt;</a>(*obsSpaces_, *hop_, fg.<a class="code" href="classoops_1_1ControlVariable.html#aa37049addedf7f5a0904813ec56d7618">obsVar</a>(),</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                              tltstep, subwindows_, hoptlad_));</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">return</span> pobstraj_;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;}</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a473d7f8463e4ae7b6bcb5015fff3f233">  627</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoops_1_1CostJo.html#a473d7f8463e4ae7b6bcb5015fff3f233">CostJo&lt;MODEL&gt;::finalizeTraj</a>(<span class="keyword">const</span> eckit::Configuration &amp;conf) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  std::unique_ptr&lt;Observations_&gt; yeqv(pobstraj_-&gt;release());</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  Log::info() &lt;&lt; <span class="stringliteral">&quot;Jo Observation Equivalent:&quot;</span> &lt;&lt; *yeqv &lt;&lt; std::endl;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <a class="code" href="classoops_1_1Departures.html">Departures_</a> ydep(*yobs_ - *yeqv);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  Log::info() &lt;&lt; <span class="stringliteral">&quot;Jo Departures:&quot;</span> &lt;&lt; ydep &lt;&lt; std::endl;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  std::unique_ptr&lt;Departures_&gt; grad(R_-&gt;inverseMultiply(ydep));</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// Check config if the inner loop trajectory Jo needs to be printed</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordtype">bool</span> printInnerLoopTrajJo = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;printInnerLoopTrajJo&quot;</span>))</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    printInnerLoopTrajJo = conf.getBool(<span class="stringliteral">&quot;printInnerLoopTrajJo&quot;</span>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">double</span> zjo = 0.0;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">if</span> (printInnerLoopTrajJo) {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// Print JO table</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    Log::info() &lt;&lt; <span class="stringliteral">&quot;Print inner loop trajectory JO-table&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    zjo = this-&gt;printJo(ydep, *grad, OS::Screened);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// Calculate JO</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">for</span> (std::size_t jj = 0; jj &lt; ydep.<a class="code" href="classoops_1_1Departures.html#aca706597582ffcabafeb6e8ea52a23f6">size</a>(); ++jj) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> zz =</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          0.5 * <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(ydep[jj].obsvector(), (*grad)[jj].obsvector());</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      zjo += zz;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;innerloop_departures&quot;</span>)) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keyword">const</span> eckit::LocalConfiguration depconf(conf, <span class="stringliteral">&quot;innerloop_departures&quot;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    ydep.<a class="code" href="classoops_1_1Departures.html#a56d674f242759e53b2ae8a5227b4a7b8">save</a>(depconf);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  pobstraj_.reset();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">return</span> zjo;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;}</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a0cf21e6bf99d2a02ce80497b5ff0e832">  677</a></span>&#160;std::shared_ptr&lt;PostBaseTL&lt;Increment&lt;MODEL&gt; &gt; &gt; <a class="code" href="classoops_1_1CostJo.html#a0cf21e6bf99d2a02ce80497b5ff0e832">CostJo&lt;MODEL&gt;::setupTL</a>(</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoops_1_1ControlIncrement.html">CtrlInc_</a> &amp;dx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  ASSERT(hoptlad_);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">if</span> (pobstl_ == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    pobstl_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1ObserverTL.html">ObserverTL&lt;MODEL, Increment_&gt;</a>(</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        *obsSpaces_, *hoptlad_, dx.<a class="code" href="classoops_1_1ControlIncrement.html#a8ca2b37a736bca34976b032468669b81">obsVar</a>(), tslot_, subwindows_));</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    pobstl_-&gt;setupTL(dx.<a class="code" href="classoops_1_1ControlIncrement.html#a8ca2b37a736bca34976b032468669b81">obsVar</a>());</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">return</span> pobstl_;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ac381a940bef3cb634d9f10774415695a">  696</a></span>&#160;std::shared_ptr&lt;PostBaseAD&lt;Increment&lt;MODEL&gt; &gt; &gt; <a class="code" href="classoops_1_1CostJo.html#ac381a940bef3cb634d9f10774415695a">CostJo&lt;MODEL&gt;::setupAD</a>(</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    std::shared_ptr&lt;const GeneralizedDepartures&gt; pv, <a class="code" href="classoops_1_1ControlIncrement.html">CtrlInc_</a> &amp;dx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  ASSERT(hoptlad_);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  std::shared_ptr&lt;const Departures_&gt; dy =</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      std::dynamic_pointer_cast&lt;const Departures_&gt;(pv);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">if</span> (pobsad_ == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    pobsad_.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1ObserverAD.html">ObserverAD&lt;MODEL, Increment_&gt;</a>(</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        *obsSpaces_, *hoptlad_, dy, dx.<a class="code" href="classoops_1_1ControlIncrement.html#a8ca2b37a736bca34976b032468669b81">obsVar</a>(), tslot_, subwindows_));</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    pobsad_-&gt;setupAD(dy, dx.<a class="code" href="classoops_1_1ControlIncrement.html#a8ca2b37a736bca34976b032468669b81">obsVar</a>());</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">return</span> pobsad_;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;}</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a9a0eab45d0a0cf121c4b835d2222bab8">  717</a></span>&#160;<a class="code" href="classoops_1_1Departures.html">Departures&lt;MODEL&gt;</a> *<a class="code" href="classoops_1_1CostJo.html#a9a0eab45d0a0cf121c4b835d2222bab8">CostJo&lt;MODEL&gt;::multiplyCovar</a>(</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoops_1_1GeneralizedDepartures.html">GeneralizedDepartures</a> &amp;v1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoops_1_1Departures.html">Departures_</a> &amp;y1 = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classoops_1_1Departures.html">Departures_</a> &amp;<span class="keyword">&gt;</span>(v1);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">return</span> R_-&gt;multiply(y1);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a4cf7984c7dc5be3a58894203f25090e7">  726</a></span>&#160;<a class="code" href="classoops_1_1Departures.html">Departures&lt;MODEL&gt;</a> *<a class="code" href="classoops_1_1CostJo.html#a4cf7984c7dc5be3a58894203f25090e7">CostJo&lt;MODEL&gt;::multiplyCoInv</a>(</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoops_1_1GeneralizedDepartures.html">GeneralizedDepartures</a> &amp;v1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoops_1_1Departures.html">Departures_</a> &amp;y1 = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classoops_1_1Departures.html">Departures_</a> &amp;<span class="keyword">&gt;</span>(v1);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordflow">return</span> R_-&gt;inverseMultiply(y1);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a728c458f1f7bcdb6eed61f9aee3f48bc">  735</a></span>&#160;<a class="code" href="classoops_1_1Departures.html">Departures&lt;MODEL&gt;</a> *<a class="code" href="classoops_1_1CostJo.html#a728c458f1f7bcdb6eed61f9aee3f48bc">CostJo&lt;MODEL&gt;::newDualVector</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <a class="code" href="classoops_1_1Departures.html">Departures_</a> *ydep = <span class="keyword">new</span> <a class="code" href="classoops_1_1Departures.html">Departures_</a>(*obsSpaces_);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  ydep-&gt;<a class="code" href="classoops_1_1Departures.html#aba68d2dc189acd6deb60d1695d0b7c1a">zero</a>();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">return</span> ydep;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00744"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a02ce1c86c4295907bb78beb895883333">  744</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a02ce1c86c4295907bb78beb895883333">CostJo&lt;MODEL&gt;::resetLinearization</a>() {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  hoptlad_.reset();</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  pobs_.reset();</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  pobstraj_.reset();</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  pobstl_.reset();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  pobsad_.reset();</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  lsetupOnce_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  lscreenObservations_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;}</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00757"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#ac15e252f153e54195f1e19b9cda107a9">  757</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoops_1_1CostJo.html#ac15e252f153e54195f1e19b9cda107a9">CostJo&lt;MODEL&gt;::printJo</a>(<span class="keyword">const</span> <a class="code" href="classoops_1_1Departures.html">Departures_</a> &amp;dy, <span class="keyword">const</span> <a class="code" href="classoops_1_1Departures.html">Departures_</a> &amp;grad,</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">size_t</span> &amp;<a class="code" href="config_8intfb_8h.html#a564260a5bdf721c2836ab616ca2e83c5">type</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  obsSpaces_-&gt;printJo(dy, grad);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="keywordtype">double</span> zjo = 0.0;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordflow">for</span> (std::size_t jj = 0; jj &lt; dy.<a class="code" href="classoops_1_1Departures.html#aca706597582ffcabafeb6e8ea52a23f6">size</a>(); ++jj) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> zz =</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        0.5 * <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dy[jj].obsvector(), grad[jj].obsvector());</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nobs = dy[jj].<a class="code" href="classoops_1_1Departures.html#aca706597582ffcabafeb6e8ea52a23f6">size</a>();</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (nobs &gt; 0) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="config_8intfb_8h.html#a564260a5bdf721c2836ab616ca2e83c5">type</a>) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">case</span> OS::Screened:</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;          Log::test() &lt;&lt; <span class="stringliteral">&quot;CostJo   : Nonlinear Jo = &quot;</span> &lt;&lt; zz</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, nobs = &quot;</span> &lt;&lt; nobs &lt;&lt; <span class="stringliteral">&quot;, Jo/n = &quot;</span> &lt;&lt; zz / nobs</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, err = &quot;</span> &lt;&lt; (*R_)[jj].getRMSE() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">case</span> OS::NotScreened:</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;          Log::info() &lt;&lt; <span class="stringliteral">&quot;CostJo (not screened)   : Nonlinear Jo = &quot;</span> &lt;&lt; zz</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, nobs = &quot;</span> &lt;&lt; nobs &lt;&lt; <span class="stringliteral">&quot;, Jo/n = &quot;</span> &lt;&lt; zz / nobs</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, err = &quot;</span> &lt;&lt; (*R_)[jj].getRMSE() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">case</span> OS::Quadratic:</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          Log::info() &lt;&lt; <span class="stringliteral">&quot;  CostJo : Quadratic Jo = &quot;</span> &lt;&lt; zz</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, nobs = &quot;</span> &lt;&lt; nobs &lt;&lt; <span class="stringliteral">&quot;, Jo/n = &quot;</span> &lt;&lt; zz / nobs</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                      &lt;&lt; std::endl;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          Log::info() &lt;&lt; <span class="stringliteral">&quot;CostJo : wrong settings&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordflow">if</span> (dy[jj].hasBias()) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        ASSERT(grad[jj].hasBias());</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordtype">double</span> zjc =</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            0.5 * <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dy[jj].biasvector(), grad[jj].biasvector());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="config_8intfb_8h.html#a564260a5bdf721c2836ab616ca2e83c5">type</a>) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          <span class="keywordflow">case</span> OS::Screened:</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            Log::test() &lt;&lt; <span class="stringliteral">&quot;CostJo   : Nonlinear JoCVarBC = &quot;</span> &lt;&lt; zjc</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                        &lt;&lt; std::endl;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          <span class="keywordflow">case</span> OS::NotScreened:</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            Log::info() &lt;&lt; <span class="stringliteral">&quot;CostJo (not screened)  : Nonlinear JoCVarBC = &quot;</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                        &lt;&lt; zjc &lt;&lt; std::endl;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      Log::info() &lt;&lt; <span class="stringliteral">&quot;CostJo --- No Observations&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    zjo += zz;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordflow">return</span> zjo;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;}</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00813"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a029ee4c09a37bc9255ca5d003beb67e8">  813</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a029ee4c09a37bc9255ca5d003beb67e8">CostJo&lt;MODEL&gt;::checkpoint</a>(eckit::LocalConfiguration &amp;conf)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;Jo&quot;</span>)) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    Log::info() &lt;&lt; <span class="stringliteral">&quot;CostJo&lt;MODEL&gt;::checkpoint starting&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    obsSpaces_-&gt;saveObservations();</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    Log::info() &lt;&lt; <span class="stringliteral">&quot;CostJo&lt;MODEL&gt;::checkpoint done&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;}</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><a name="l00824"></a><span class="lineno"><a class="line" href="classoops_1_1CostJo.html#a201df549be43dc054f07b8a05615633b">  824</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoops_1_1CostJo.html#a201df549be43dc054f07b8a05615633b">CostJo&lt;MODEL&gt;::restart</a>(<span class="keyword">const</span> eckit::Configuration &amp;conf) {}</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}  <span class="comment">// namespace oops</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">#endif  // OOPS_ASSIMILATION_COSTJO_H_</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoops_1_1CostJo_html_a20765c265859ba0e30cc34f5302c0d31"><div class="ttname"><a href="classoops_1_1CostJo.html#a20765c265859ba0e30cc34f5302c0d31">oops::CostJo::finalize</a></div><div class="ttdeci">double finalize(const eckit::Configuration &amp;) const override</div><div class="ttdoc">Various computations after the integration of the model.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00469">CostJo.h:469</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a51fc766070aec1205489415fca08e81a"><div class="ttname"><a href="classoops_1_1CostJo.html#a51fc766070aec1205489415fca08e81a">oops::CostJo::screenObservations</a></div><div class="ttdeci">void screenObservations(std::unique_ptr&lt; Observations_ &gt; &amp;, const eckit::Configuration &amp;) const</div><div class="ttdoc">Screen observations.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00532">CostJo.h:532</a></div></div>
<div class="ttc" id="aclassoops_1_1GeneralizedDepartures_html"><div class="ttname"><a href="classoops_1_1GeneralizedDepartures.html">oops::GeneralizedDepartures</a></div><div class="ttdoc">Abstract base class for quantities.</div><div class="ttdef"><b>Definition:</b> <a href="GeneralizedDepartures_8h_source.html#l00022">GeneralizedDepartures.h:22</a></div></div>
<div class="ttc" id="aclassoops_1_1LinearObsOperators_html"><div class="ttname"><a href="classoops_1_1LinearObsOperators.html">oops::LinearObsOperators</a></div><div class="ttdoc">A container class storing a vector of LinearObsOpertor objects.</div><div class="ttdef"><b>Definition:</b> <a href="LinearObsOperators_8h_source.html#l00039">LinearObsOperators.h:39</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a473d7f8463e4ae7b6bcb5015fff3f233"><div class="ttname"><a href="classoops_1_1CostJo.html#a473d7f8463e4ae7b6bcb5015fff3f233">oops::CostJo::finalizeTraj</a></div><div class="ttdeci">double finalizeTraj(const eckit::Configuration &amp;) override</div><div class="ttdoc">Various computations after the linearisation trajectory computation.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00627">CostJo.h:627</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html"><div class="ttname"><a href="classoops_1_1CostTermBase.html">oops::CostTermBase</a></div><div class="ttdoc">Abstract base class for the terms of the cost function (e.g. Jo, Jc).</div><div class="ttdef"><b>Definition:</b> <a href="CostTermBase_8h_source.html#l00049">CostTermBase.h:49</a></div></div>
<div class="ttc" id="anamespaceoops_html"><div class="ttname"><a href="namespaceoops.html">oops</a></div><div class="ttdoc">The namespace for the main oops code.</div><div class="ttdef"><b>Definition:</b> <a href="BMatrix_8h_source.html#l00020">BMatrix.h:20</a></div></div>
<div class="ttc" id="aPostBaseTL_8h_html"><div class="ttname"><a href="PostBaseTL_8h.html">PostBaseTL.h</a></div></div>
<div class="ttc" id="aclassoops_1_1ObsOperators_html"><div class="ttname"><a href="classoops_1_1ObsOperators.html">oops::ObsOperators</a></div><div class="ttdoc">A container class storing a vector of ObsOperator objects.</div><div class="ttdef"><b>Definition:</b> <a href="ObsOperators_8h_source.html#l00042">ObsOperators.h:42</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a0ccf115a20500f74561f75d2fd37e8d1"><div class="ttname"><a href="classoops_1_1CostJo.html#a0ccf115a20500f74561f75d2fd37e8d1">oops::CostJo::yobs_</a></div><div class="ttdeci">std::unique_ptr&lt; Observations_ &gt; yobs_</div><div class="ttdoc">Observations.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00338">CostJo.h:338</a></div></div>
<div class="ttc" id="aclassoops_1_1ControlVariable_html_aa37049addedf7f5a0904813ec56d7618"><div class="ttname"><a href="classoops_1_1ControlVariable.html#aa37049addedf7f5a0904813ec56d7618">oops::ControlVariable::obsVar</a></div><div class="ttdeci">ObsAuxCtrls_ &amp; obsVar()</div><div class="ttdoc">Returns the auxiliary observation space component of the control variable.</div><div class="ttdef"><b>Definition:</b> <a href="ControlVariable_8h_source.html#l00144">ControlVariable.h:144</a></div></div>
<div class="ttc" id="aPostBase_8h_html"><div class="ttname"><a href="PostBase_8h.html">PostBase.h</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_acaab2f925c4030f3b0d031eeada40dcd"><div class="ttname"><a href="classoops_1_1CostJo.html#acaab2f925c4030f3b0d031eeada40dcd">oops::CostJo::lscreenObservations_</a></div><div class="ttdeci">bool lscreenObservations_</div><div class="ttdoc">Logical controlling screening of observations.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00324">CostJo.h:324</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a728c458f1f7bcdb6eed61f9aee3f48bc"><div class="ttname"><a href="classoops_1_1CostJo.html#a728c458f1f7bcdb6eed61f9aee3f48bc">oops::CostJo::newDualVector</a></div><div class="ttdeci">Departures_ * newDualVector() const override</div><div class="ttdoc">Provide new (zeroed) departures.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00735">CostJo.h:735</a></div></div>
<div class="ttc" id="aclassoops_1_1ObserverAD_html"><div class="ttname"><a href="classoops_1_1ObserverAD.html">oops::ObserverAD</a></div><div class="ttdoc">Computes observation equivalent AD and AD to/from increments.</div><div class="ttdef"><b>Definition:</b> <a href="ObserverAD_8h_source.html#l00035">ObserverAD.h:35</a></div></div>
<div class="ttc" id="aControlIncrement_8h_html"><div class="ttname"><a href="ControlIncrement_8h.html">ControlIncrement.h</a></div></div>
<div class="ttc" id="aclassoops_1_1Departures_html_a56d674f242759e53b2ae8a5227b4a7b8"><div class="ttname"><a href="classoops_1_1Departures.html#a56d674f242759e53b2ae8a5227b4a7b8">oops::Departures::save</a></div><div class="ttdeci">void save(const eckit::Configuration &amp;) const</div><div class="ttdoc">Write departures.</div><div class="ttdef"><b>Definition:</b> <a href="Departures_8h_source.html#l00270">Departures.h:270</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html"><div class="ttname"><a href="classoops_1_1CostJo.html">oops::CostJo</a></div><div class="ttdoc">term of the cost function</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00218">CostJo.h:218</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_ac16b6c752e4f5fc44205251a43065735"><div class="ttname"><a href="classoops_1_1CostJo.html#ac16b6c752e4f5fc44205251a43065735">oops::CostJo::initializeTraj</a></div><div class="ttdeci">std::shared_ptr&lt; PostBase&lt; State_ &gt; &gt; initializeTraj(const CtrlVar_ &amp;, const Geometry_ &amp;, const eckit::Configuration &amp;) override</div><div class="ttdoc">Various set ups prior to the linearisation trajectory computation.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00595">CostJo.h:595</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a49ff2aaeb1089107ca4527aab0e8c1ea"><div class="ttname"><a href="classoops_1_1CostJo.html#a49ff2aaeb1089107ca4527aab0e8c1ea">oops::CostJo::R_</a></div><div class="ttdeci">std::unique_ptr&lt; ObsErrors_ &gt; R_</div><div class="ttdoc">Observation error covariance matrices.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00336">CostJo.h:336</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a4d01a26bc17921eda02c74bc62a107ef"><div class="ttname"><a href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107ef">oops::CostJo::OS</a></div><div class="ttdeci">OS</div><div class="ttdoc">Define which ObservationSpace to use.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00237">CostJo.h:237</a></div></div>
<div class="ttc" id="aclassoops_1_1Departures_html_ace0afd3172cab34defb8bc9f6a26059b"><div class="ttname"><a href="classoops_1_1Departures.html#ace0afd3172cab34defb8bc9f6a26059b">oops::Departures::read</a></div><div class="ttdeci">void read(const eckit::Configuration &amp;)</div><div class="ttdoc">Read departures.</div><div class="ttdef"><b>Definition:</b> <a href="Departures_8h_source.html#l00279">Departures.h:279</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_ab84830651f83780d8989c645a956d928"><div class="ttname"><a href="classoops_1_1CostJo.html#ab84830651f83780d8989c645a956d928">oops::CostJo::geom_</a></div><div class="ttdeci">const Geometry_ &amp; geom_</div><div class="ttdoc">Constant reference to geometry.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00315">CostJo.h:315</a></div></div>
<div class="ttc" id="aCostTermBase_8h_html"><div class="ttname"><a href="CostTermBase_8h.html">CostTermBase.h</a></div></div>
<div class="ttc" id="aDateTime_8h_html"><div class="ttname"><a href="DateTime_8h.html">DateTime.h</a></div></div>
<div class="ttc" id="aObserverAD_8h_html"><div class="ttname"><a href="ObserverAD_8h.html">ObserverAD.h</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a3e8ca24a08b0dfc2e3ff9c280036d701"><div class="ttname"><a href="classoops_1_1CostJo.html#a3e8ca24a08b0dfc2e3ff9c280036d701">oops::CostJo::setBackground</a></div><div class="ttdeci">void setBackground(const CtrlVar_ &amp;xb) const</div><div class="ttdoc">Set xb.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00310">CostJo.h:310</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_acae760ea80fa3355c6dc90a89f9dac9b"><div class="ttname"><a href="classoops_1_1CostJo.html#acae760ea80fa3355c6dc90a89f9dac9b">oops::CostJo::winbgn_</a></div><div class="ttdeci">const util::DateTime winbgn_</div><div class="ttdoc">Beginning of the window.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00317">CostJo.h:317</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a4cf7984c7dc5be3a58894203f25090e7"><div class="ttname"><a href="classoops_1_1CostJo.html#a4cf7984c7dc5be3a58894203f25090e7">oops::CostJo::multiplyCoInv</a></div><div class="ttdeci">Departures_ * multiplyCoInv(const GeneralizedDepartures &amp;) const override</div><div class="ttdoc">Multiply by .</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00726">CostJo.h:726</a></div></div>
<div class="ttc" id="aObsErrors_8h_html"><div class="ttname"><a href="ObsErrors_8h.html">ObsErrors.h</a></div></div>
<div class="ttc" id="aDuration_8h_html"><div class="ttname"><a href="Duration_8h.html">Duration.h</a></div></div>
<div class="ttc" id="aclassoops_1_1ControlVariable_html_ab0d586bcc35408b75555e9eafd6fd501"><div class="ttname"><a href="classoops_1_1ControlVariable.html#ab0d586bcc35408b75555e9eafd6fd501">oops::ControlVariable::read</a></div><div class="ttdeci">void read(const eckit::Configuration &amp;)</div><div class="ttdoc">Read a control variable.</div><div class="ttdef"><b>Definition:</b> <a href="ControlVariable_8h_source.html#l00239">ControlVariable.h:239</a></div></div>
<div class="ttc" id="aclassoops_1_1Observations_html"><div class="ttname"><a href="classoops_1_1Observations.html">oops::Observations</a></div><div class="ttdoc">Observations Class.</div><div class="ttdef"><b>Definition:</b> <a href="Observations_8h_source.html#l00066">Observations.h:66</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a58c62568991a776f91a2a6850407c31c"><div class="ttname"><a href="classoops_1_1CostJo.html#a58c62568991a776f91a2a6850407c31c">oops::CostJo::pobstraj_</a></div><div class="ttdeci">std::shared_ptr&lt; Observer&lt; MODEL, State_ &gt; &gt; pobstraj_</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00350">CostJo.h:350</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a9caf2dc103eae322870b9591c7f79fab"><div class="ttname"><a href="classoops_1_1CostJo.html#a9caf2dc103eae322870b9591c7f79fab">oops::CostJo::gradFG_</a></div><div class="ttdeci">std::unique_ptr&lt; Departures_ &gt; gradFG_</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00341">CostJo.h:341</a></div></div>
<div class="ttc" id="aObserver_8h_html"><div class="ttname"><a href="Observer_8h.html">Observer.h</a></div></div>
<div class="ttc" id="aObservations_8h_html"><div class="ttname"><a href="Observations_8h.html">Observations.h</a></div></div>
<div class="ttc" id="aconfig_8intfb_8h_html_a564260a5bdf721c2836ab616ca2e83c5"><div class="ttname"><a href="config_8intfb_8h.html#a564260a5bdf721c2836ab616ca2e83c5">type</a></div><div class="ttdeci">C Copyright ECMWF ! This software is licensed under the terms of the Apache Licence Version ! which can be obtained at ECMWF does not waive the privileges and immunities ! granted to it by virtue of its status as an intergovernmental organisation nor ! does it submit to any jurisdiction Define interface for C config code called from Fortran interface type(c_ptr) function c_config_get_testdata() bind(C</div></div>
<div class="ttc" id="aoops_2interface_2State_8h_html"><div class="ttname"><a href="oops_2interface_2State_8h.html">State.h</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a0cf21e6bf99d2a02ce80497b5ff0e832"><div class="ttname"><a href="classoops_1_1CostJo.html#a0cf21e6bf99d2a02ce80497b5ff0e832">oops::CostJo::setupTL</a></div><div class="ttdeci">std::shared_ptr&lt; PostBaseTL&lt; Increment_ &gt; &gt; setupTL(const CtrlInc_ &amp;) const override</div><div class="ttdoc">Initialize ObserverTL (computes ) before starting the TL run.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00677">CostJo.h:677</a></div></div>
<div class="ttc" id="aclassoops_1_1ControlIncrement_html_a8ca2b37a736bca34976b032468669b81"><div class="ttname"><a href="classoops_1_1ControlIncrement.html#a8ca2b37a736bca34976b032468669b81">oops::ControlIncrement::obsVar</a></div><div class="ttdeci">ObsAuxIncrs_ &amp; obsVar()</div><div class="ttdoc">Get augmented observation control increment.</div><div class="ttdef"><b>Definition:</b> <a href="ControlIncrement_8h_source.html#l00155">ControlIncrement.h:155</a></div></div>
<div class="ttc" id="aDepartures_8h_html"><div class="ttname"><a href="Departures_8h.html">Departures.h</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_ac381a940bef3cb634d9f10774415695a"><div class="ttname"><a href="classoops_1_1CostJo.html#ac381a940bef3cb634d9f10774415695a">oops::CostJo::setupAD</a></div><div class="ttdeci">std::shared_ptr&lt; PostBaseAD&lt; Increment_ &gt; &gt; setupAD(std::shared_ptr&lt; const GeneralizedDepartures &gt;, CtrlInc_ &amp;) const override</div><div class="ttdoc">Initialize ObserverAD (computes ) before starting the AD run.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00696">CostJo.h:696</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_afe1a54cf8c86b03900d4ca0c03d5f1eb"><div class="ttname"><a href="classoops_1_1CostJo.html#afe1a54cf8c86b03900d4ca0c03d5f1eb">oops::CostJo::hoptlad_</a></div><div class="ttdeci">std::shared_ptr&lt; LinearObsOperators_ &gt; hoptlad_</div><div class="ttdoc">Linear observation operators.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00334">CostJo.h:334</a></div></div>
<div class="ttc" id="aLinearObsOperators_8h_html"><div class="ttname"><a href="LinearObsOperators_8h.html">LinearObsOperators.h</a></div></div>
<div class="ttc" id="aclassoops_1_1Geometry_html"><div class="ttname"><a href="classoops_1_1Geometry.html">oops::Geometry</a></div><div class="ttdoc">Wrapper for geometry.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2Geometry_8h_source.html#l00037">Geometry.h:37</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a4d01a26bc17921eda02c74bc62a107efaa1f7c5295f32377647ff9df173982a53"><div class="ttname"><a href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107efaa1f7c5295f32377647ff9df173982a53">oops::CostJo::Screened</a></div><div class="ttdeci">@ Screened</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00237">CostJo.h:237</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a4d01a26bc17921eda02c74bc62a107efa9de8e148fb6c941d79b3c1ba4c5f0bf4"><div class="ttname"><a href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107efa9de8e148fb6c941d79b3c1ba4c5f0bf4">oops::CostJo::NotScreened</a></div><div class="ttdeci">@ NotScreened</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00237">CostJo.h:237</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_aa8fb94902226d4cf52ffb5b1f147ac8f"><div class="ttname"><a href="classoops_1_1CostJo.html#aa8fb94902226d4cf52ffb5b1f147ac8f">oops::CostJo::~CostJo</a></div><div class="ttdeci">virtual ~CostJo()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00245">CostJo.h:245</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_ae9d99cb14f33f1647bd137ea7d26f2b9"><div class="ttname"><a href="classoops_1_1CostJo.html#ae9d99cb14f33f1647bd137ea7d26f2b9">oops::CostJo::CtrlInc_</a></div><div class="ttdeci">ControlIncrement&lt; MODEL &gt; CtrlInc_</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00220">CostJo.h:220</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_ac15e252f153e54195f1e19b9cda107a9"><div class="ttname"><a href="classoops_1_1CostJo.html#ac15e252f153e54195f1e19b9cda107a9">oops::CostJo::printJo</a></div><div class="ttdeci">double printJo(const Departures_ &amp;, const Departures_ &amp;, const size_t &amp;type) const</div><div class="ttdoc">Print Jo table.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00757">CostJo.h:757</a></div></div>
<div class="ttc" id="aObsAuxControls_8h_html"><div class="ttname"><a href="ObsAuxControls_8h.html">ObsAuxControls.h</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a53da9090b91e37f0b5f5856266747ac2"><div class="ttname"><a href="classoops_1_1CostJo.html#a53da9090b91e37f0b5f5856266747ac2">oops::CostJo::hop_</a></div><div class="ttdeci">std::unique_ptr&lt; ObsOperators_ &gt; hop_</div><div class="ttdoc">Non-linear observation operators.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00332">CostJo.h:332</a></div></div>
<div class="ttc" id="aObsOperators_8h_html"><div class="ttname"><a href="ObsOperators_8h.html">ObsOperators.h</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_ab47c8c6a779927467e7a9e7827cb994e"><div class="ttname"><a href="classoops_1_1CostJo.html#ab47c8c6a779927467e7a9e7827cb994e">oops::CostJo::fg_</a></div><div class="ttdeci">const CtrlVar_ * fg_</div><div class="ttdoc">Pointer to first guess.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00327">CostJo.h:327</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a84b83f064efca2b6fad70ad26836b7b3"><div class="ttname"><a href="classoops_1_1CostJo.html#a84b83f064efca2b6fad70ad26836b7b3">oops::CostJo::ydep_</a></div><div class="ttdeci">std::unique_ptr&lt; Departures_ &gt; ydep_</div><div class="ttdoc">Departures : .</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00340">CostJo.h:340</a></div></div>
<div class="ttc" id="aclassoops_1_1ControlVariable_html"><div class="ttname"><a href="classoops_1_1ControlVariable.html">oops::ControlVariable</a></div><div class="ttdoc">Control Variable.</div><div class="ttdef"><b>Definition:</b> <a href="ControlVariable_8h_source.html#l00095">ControlVariable.h:95</a></div></div>
<div class="ttc" id="aLogger_8h_html"><div class="ttname"><a href="Logger_8h.html">Logger.h</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a3218544321e2a4f616eb52f6e877e80d"><div class="ttname"><a href="classoops_1_1CostJo.html#a3218544321e2a4f616eb52f6e877e80d">oops::CostJo::ObsSpaces_</a></div><div class="ttdeci">ObservationSpaces&lt; MODEL &gt; ObsSpaces_</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00230">CostJo.h:230</a></div></div>
<div class="ttc" id="aclassoops_1_1ObservationSpaces_html"><div class="ttname"><a href="classoops_1_1ObservationSpaces.html">oops::ObservationSpaces</a></div><div class="ttdoc">Wrapper around a vector of observation spaces.</div><div class="ttdef"><b>Definition:</b> <a href="ObservationSpaces_8h_source.html#l00044">ObservationSpaces.h:44</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_ad8084c2ea97f4a18df48fb1a90e3c570"><div class="ttname"><a href="classoops_1_1CostJo.html#ad8084c2ea97f4a18df48fb1a90e3c570">oops::CostJo::subwindows_</a></div><div class="ttdeci">const bool subwindows_</div><div class="ttdoc">Logical controlling if sub-windows are enabled.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00321">CostJo.h:321</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a6824fb0431774ae8583f6cd28975d458"><div class="ttname"><a href="classoops_1_1CostJo.html#a6824fb0431774ae8583f6cd28975d458">oops::CostJo::winend_</a></div><div class="ttdeci">const util::DateTime winend_</div><div class="ttdoc">End of the window.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00318">CostJo.h:318</a></div></div>
<div class="ttc" id="aControlVariable_8h_html"><div class="ttname"><a href="ControlVariable_8h.html">ControlVariable.h</a></div></div>
<div class="ttc" id="aclassoops_1_1ObserverTL_html"><div class="ttname"><a href="classoops_1_1ObserverTL.html">oops::ObserverTL</a></div><div class="ttdoc">Computes .</div><div class="ttdef"><b>Definition:</b> <a href="ObserverTL_8h_source.html#l00042">ObserverTL.h:42</a></div></div>
<div class="ttc" id="aclassoops_1_1Observer_html"><div class="ttname"><a href="classoops_1_1Observer.html">oops::Observer</a></div><div class="ttdoc">Computes .</div><div class="ttdef"><b>Definition:</b> <a href="Observer_8h_source.html#l00041">Observer.h:41</a></div></div>
<div class="ttc" id="aclassoops_1_1ObsAuxControls_html_a90dff2500a64e642ee2440c3e05d1982"><div class="ttname"><a href="classoops_1_1ObsAuxControls.html#a90dff2500a64e642ee2440c3e05d1982">oops::ObsAuxControls::reset</a></div><div class="ttdeci">void reset(const ObsSpaces_ &amp;, const std::string &amp;, const eckit::Configuration &amp;)</div><div class="ttdoc">Reset.</div><div class="ttdef"><b>Definition:</b> <a href="ObsAuxControls_8h_source.html#l00129">ObsAuxControls.h:129</a></div></div>
<div class="ttc" id="aObserverTL_8h_html"><div class="ttname"><a href="ObserverTL_8h.html">ObserverTL.h</a></div></div>
<div class="ttc" id="aGeoVaLs_8h_html"><div class="ttname"><a href="GeoVaLs_8h.html">GeoVaLs.h</a></div></div>
<div class="ttc" id="aclassoops_1_1Departures_html"><div class="ttname"><a href="classoops_1_1Departures.html">oops::Departures</a></div><div class="ttdoc">Difference between two observation vectors.</div><div class="ttdef"><b>Definition:</b> <a href="Departures_8h_source.html#l00095">Departures.h:95</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_aba5fff9b3bb7f9c4aa4a10fd591b1859"><div class="ttname"><a href="classoops_1_1CostJo.html#aba5fff9b3bb7f9c4aa4a10fd591b1859">oops::CostJo::tslot_</a></div><div class="ttdeci">const util::Duration tslot_</div><div class="ttdoc">Time slot duration.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00319">CostJo.h:319</a></div></div>
<div class="ttc" id="aoops_2interface_2Geometry_8h_html"><div class="ttname"><a href="oops_2interface_2Geometry_8h.html">Geometry.h</a></div></div>
<div class="ttc" id="aclassoops_1_1Departures_html_aba68d2dc189acd6deb60d1695d0b7c1a"><div class="ttname"><a href="classoops_1_1Departures.html#aba68d2dc189acd6deb60d1695d0b7c1a">oops::Departures::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdef"><b>Definition:</b> <a href="Departures_8h_source.html#l00240">Departures.h:240</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a02ce1c86c4295907bb78beb895883333"><div class="ttname"><a href="classoops_1_1CostJo.html#a02ce1c86c4295907bb78beb895883333">oops::CostJo::resetLinearization</a></div><div class="ttdeci">void resetLinearization() override</div><div class="ttdoc">Reset obs operator trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00744">CostJo.h:744</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a7eaaa6a4605bc90b3ec1e72d6802e717"><div class="ttname"><a href="classoops_1_1CostJo.html#a7eaaa6a4605bc90b3ec1e72d6802e717">oops::CostJo::classname</a></div><div class="ttdeci">const std::string classname() const override</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00234">CostJo.h:234</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a1a4e233b0db9abb55780b2dfdf56ccf0"><div class="ttname"><a href="classoops_1_1CostJo.html#a1a4e233b0db9abb55780b2dfdf56ccf0">oops::CostJo::conf_</a></div><div class="ttdeci">const eckit::LocalConfiguration conf_</div><div class="ttdoc">Configuration.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00313">CostJo.h:313</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_ac35d897c2d0a1a9b1959a2b0f5e76df8"><div class="ttname"><a href="classoops_1_1CostJo.html#ac35d897c2d0a1a9b1959a2b0f5e76df8">oops::CostJo::xb_</a></div><div class="ttdeci">const CtrlVar_ * xb_</div><div class="ttdoc">Pointer to background.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00326">CostJo.h:326</a></div></div>
<div class="ttc" id="aObservationSpaces_8h_html"><div class="ttname"><a href="ObservationSpaces_8h.html">ObservationSpaces.h</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a31bd4e4e5f9a73381a3c6bc4bcc32fc4"><div class="ttname"><a href="classoops_1_1CostJo.html#a31bd4e4e5f9a73381a3c6bc4bcc32fc4">oops::CostJo::CostJo</a></div><div class="ttdeci">CostJo(const eckit::Configuration &amp;, const Geometry_ &amp;geom, const util::DateTime &amp;, const util::DateTime &amp;, const util::Duration &amp;, const bool subwindows=false)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00362">CostJo.h:362</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_aaf6eb952736c6f7fc2a3750392c94d7c"><div class="ttname"><a href="classoops_1_1CostJo.html#aaf6eb952736c6f7fc2a3750392c94d7c">oops::CostJo::pobsad_</a></div><div class="ttdeci">std::shared_ptr&lt; ObserverAD&lt; MODEL, Increment_ &gt; &gt; pobsad_</div><div class="ttdoc">ObserverAD attached by  to the adjoint model integration.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00356">CostJo.h:356</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a029ee4c09a37bc9255ca5d003beb67e8"><div class="ttname"><a href="classoops_1_1CostJo.html#a029ee4c09a37bc9255ca5d003beb67e8">oops::CostJo::checkpoint</a></div><div class="ttdeci">void checkpoint(eckit::LocalConfiguration &amp;) const</div><div class="ttdoc">Checkpoint Jo.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00813">CostJo.h:813</a></div></div>
<div class="ttc" id="aclassoops_1_1Increment_html"><div class="ttname"><a href="classoops_1_1Increment.html">oops::Increment</a></div><div class="ttdoc">Encapsulates model increment.</div><div class="ttdef"><b>Definition:</b> <a href="GeoVaLs_8h_source.html#l00032">GeoVaLs.h:32</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a932e5bf21ccc48c7d7db2fbeccdcf1ba"><div class="ttname"><a href="classoops_1_1CostJo.html#a932e5bf21ccc48c7d7db2fbeccdcf1ba">oops::CostJo::pobs_</a></div><div class="ttdeci">std::shared_ptr&lt; Observer&lt; MODEL, State_ &gt; &gt; pobs_</div><div class="ttdoc">Observer attached by  to the model integration.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00346">CostJo.h:346</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a4d01a26bc17921eda02c74bc62a107efaf5c164e62b8b1ee0d59f4f93b77d447b"><div class="ttname"><a href="classoops_1_1CostJo.html#a4d01a26bc17921eda02c74bc62a107efaf5c164e62b8b1ee0d59f4f93b77d447b">oops::CostJo::Quadratic</a></div><div class="ttdeci">@ Quadratic</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00237">CostJo.h:237</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a20b55adeffebbe92dc643a0ba6a312af"><div class="ttname"><a href="classoops_1_1CostJo.html#a20b55adeffebbe92dc643a0ba6a312af">oops::CostJo::Departures_</a></div><div class="ttdeci">Departures&lt; MODEL &gt; Departures_</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00221">CostJo.h:221</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a6d8ef544f60faf1c4d722c43d3c5f365"><div class="ttname"><a href="classoops_1_1CostJo.html#a6d8ef544f60faf1c4d722c43d3c5f365">oops::CostJo::initialize</a></div><div class="ttdeci">std::shared_ptr&lt; PostBase&lt; State_ &gt; &gt; initialize(const CtrlVar_ &amp;, const eckit::Configuration &amp;) const override</div><div class="ttdoc">Various set ups prior to the integration of the model.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00416">CostJo.h:416</a></div></div>
<div class="ttc" id="aclassoops_1_1State_html"><div class="ttname"><a href="classoops_1_1State.html">oops::State</a></div><div class="ttdoc">Encapsulates model state.</div><div class="ttdef"><b>Definition:</b> <a href="GeoVaLs_8h_source.html#l00034">GeoVaLs.h:34</a></div></div>
<div class="ttc" id="aclassoops_1_1GeoVaLs_html"><div class="ttname"><a href="classoops_1_1GeoVaLs.html">oops::GeoVaLs</a></div><div class="ttdoc">Wrapper for geophysical values at observation locations.</div><div class="ttdef"><b>Definition:</b> <a href="ObservationSpaces_8h_source.html#l00036">ObservationSpaces.h:36</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a201df549be43dc054f07b8a05615633b"><div class="ttname"><a href="classoops_1_1CostJo.html#a201df549be43dc054f07b8a05615633b">oops::CostJo::restart</a></div><div class="ttdeci">void restart(const eckit::Configuration &amp;)</div><div class="ttdoc">Restart Jo.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00824">CostJo.h:824</a></div></div>
<div class="ttc" id="aclassoops_1_1ObsErrors_html"><div class="ttname"><a href="classoops_1_1ObsErrors.html">oops::ObsErrors</a></div><div class="ttdoc">Encapsulates a vector of ObsErrorCovariance objects.</div><div class="ttdef"><b>Definition:</b> <a href="ObsErrors_8h_source.html#l00044">ObsErrors.h:44</a></div></div>
<div class="ttc" id="aPostBaseAD_8h_html"><div class="ttname"><a href="PostBaseAD_8h.html">PostBaseAD.h</a></div></div>
<div class="ttc" id="adot__product_8h_html_af0275315d135f0b993246c2ff4b1f40a"><div class="ttname"><a href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a></div><div class="ttdeci">double dot_product(const T &amp;x, const T &amp;y)</div><div class="ttdoc">Syntactic sugar to let us use a more mathematical notation for dot products.</div><div class="ttdef"><b>Definition:</b> <a href="dot__product_8h_source.html#l00017">dot_product.h:17</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a8017c8c12b30ca89f297219a6140970b"><div class="ttname"><a href="classoops_1_1CostJo.html#a8017c8c12b30ca89f297219a6140970b">oops::CostJo::pobstl_</a></div><div class="ttdeci">std::shared_ptr&lt; ObserverTL&lt; MODEL, Increment_ &gt; &gt; pobstl_</div><div class="ttdoc">ObserverTL attached by  to the linear model integration.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00353">CostJo.h:353</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a50a27b3a207dd7bb5aecbd695a090b0b"><div class="ttname"><a href="classoops_1_1CostJo.html#a50a27b3a207dd7bb5aecbd695a090b0b">oops::CostJo::Geometry_</a></div><div class="ttdeci">Geometry&lt; MODEL &gt; Geometry_</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00223">CostJo.h:223</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_abdb995be9e71096f1a34d27864d96833"><div class="ttname"><a href="classoops_1_1CostJo.html#abdb995be9e71096f1a34d27864d96833">oops::CostJo::newDepartures</a></div><div class="ttdeci">Departures_ * newDepartures() const override</div><div class="ttdoc">Return departures ie .</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00284">CostJo.h:284</a></div></div>
<div class="ttc" id="aoops_2interface_2Increment_8h_html"><div class="ttname"><a href="oops_2interface_2Increment_8h.html">Increment.h</a></div></div>
<div class="ttc" id="aclassoops_1_1ControlIncrement_html"><div class="ttname"><a href="classoops_1_1ControlIncrement.html">oops::ControlIncrement</a></div><div class="ttdoc">Control Increment.</div><div class="ttdef"><b>Definition:</b> <a href="ControlIncrement_8h_source.html#l00097">ControlIncrement.h:97</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_aa1e1f31a57edc0023460aa0ecd8a3c25"><div class="ttname"><a href="classoops_1_1CostJo.html#aa1e1f31a57edc0023460aa0ecd8a3c25">oops::CostJo::lsetupOnce_</a></div><div class="ttdeci">bool lsetupOnce_</div><div class="ttdoc">Logical controlling various set ups.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00322">CostJo.h:322</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a6fc72d99578f3d4ce6244e520c25c905"><div class="ttname"><a href="classoops_1_1CostJo.html#a6fc72d99578f3d4ce6244e520c25c905">oops::CostJo::obspaces</a></div><div class="ttdeci">const ObsSpaces_ &amp; obspaces() const</div><div class="ttdoc">Access observation spaces.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00301">CostJo.h:301</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a9a0eab45d0a0cf121c4b835d2222bab8"><div class="ttname"><a href="classoops_1_1CostJo.html#a9a0eab45d0a0cf121c4b835d2222bab8">oops::CostJo::multiplyCovar</a></div><div class="ttdeci">Departures_ * multiplyCovar(const GeneralizedDepartures &amp;) const override</div><div class="ttdoc">Multiply by .</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00717">CostJo.h:717</a></div></div>
<div class="ttc" id="aclassoops_1_1Departures_html_aca706597582ffcabafeb6e8ea52a23f6"><div class="ttname"><a href="classoops_1_1Departures.html#aca706597582ffcabafeb6e8ea52a23f6">oops::Departures::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdoc">Return the number of components.</div><div class="ttdef"><b>Definition:</b> <a href="Departures_8h_source.html#l00111">Departures.h:111</a></div></div>
<div class="ttc" id="aclassoops_1_1ObsAuxControls_html"><div class="ttname"><a href="classoops_1_1ObsAuxControls.html">oops::ObsAuxControls</a></div><div class="ttdoc">Encapsulates a vector of ObsAuxControl objects.</div><div class="ttdef"><b>Definition:</b> <a href="ObsAuxControls_8h_source.html#l00037">ObsAuxControls.h:37</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_a26d3de1fa0f729df243d3d87e363b5ae"><div class="ttname"><a href="classoops_1_1CostJo.html#a26d3de1fa0f729df243d3d87e363b5ae">oops::CostJo::CtrlVar_</a></div><div class="ttdeci">ControlVariable&lt; MODEL &gt; CtrlVar_</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00219">CostJo.h:219</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_af211a5d2f4b5a04315865d4fc5cfca13"><div class="ttname"><a href="classoops_1_1CostJo.html#af211a5d2f4b5a04315865d4fc5cfca13">oops::CostJo::obsSpaces_</a></div><div class="ttdeci">std::unique_ptr&lt; ObsSpaces_ &gt; obsSpaces_</div><div class="ttdoc">Observation spaces.</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00329">CostJo.h:329</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJo_html_aa4e3165d1ec4bb5ebb98e820c8245991"><div class="ttname"><a href="classoops_1_1CostJo.html#aa4e3165d1ec4bb5ebb98e820c8245991">oops::CostJo::newGradientFG</a></div><div class="ttdeci">Departures_ * newGradientFG() const override</div><div class="ttdoc">Return gradient at first guess ie .</div><div class="ttdef"><b>Definition:</b> <a href="CostJo_8h_source.html#l00289">CostJo.h:289</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
