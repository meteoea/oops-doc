<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OOPS Documentation: oops::CostFunction&lt; MODEL &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OOPS Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceoops.html">oops</a></li><li class="navelem"><a class="el" href="classoops_1_1CostFunction.html">CostFunction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classoops_1_1CostFunction-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oops::CostFunction&lt; MODEL &gt; Class Template Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Abstract base class for a cost function.  
 <a href="classoops_1_1CostFunction.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for oops::CostFunction&lt; MODEL &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction__inherit__graph.png" border="0" usemap="#oops_1_1CostFunction_3_01MODEL_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="oops_1_1CostFunction_3_01MODEL_01_4_inherit__map" id="oops_1_1CostFunction_3_01MODEL_01_4_inherit__map">
<area shape="rect" title="Abstract base class for a cost function." alt="" coords="427,131,602,677"/>
<area shape="rect" href="classoops_1_1CostFct3DVar.html" title="3D&#45;Var Cost Function" alt="" coords="5,799,144,1111"/>
<area shape="rect" href="classoops_1_1CostFct4DEnsVar.html" title="4D&#45;Ens&#45;Var Cost Function" alt="" coords="168,791,328,1118"/>
<area shape="rect" href="classoops_1_1CostFct4DEnVar.html" title="4D&#45;Ens&#45;Var Cost Function" alt="" coords="353,791,506,1118"/>
<area shape="rect" href="classoops_1_1CostFct4DVar.html" title="Strong Constraint 4D&#45;Var Cost Function." alt="" coords="531,813,669,1096"/>
<area shape="rect" href="classoops_1_1CostFct4DVarMFTemplate.html" title="4D&#45;Var Cost Function in the ARPEGE" alt="" coords="693,725,904,1184"/>
<area shape="rect" href="classoops_1_1CostFctWeak.html" title="Weak Constraint 4D&#45;Var Cost Function." alt="" coords="927,777,1070,1133"/>
<area shape="rect" title=" " alt="" coords="465,5,564,83"/>
<area shape="rect" href="classoops_1_1CostFct4DVarHyb4D.html" title="4DVarHyb4D Cost Function in the ARPEGE" alt="" coords="518,1239,695,1478"/>
<area shape="rect" href="classoops_1_1CostFct4DVarMF.html" title="Strong Constraint 4D&#45;Var Cost Function." alt="" coords="720,1298,877,1419"/>
<area shape="rect" href="classoops_1_1CostFct4DVarTrajHR.html" title="4D&#45;Var Cost Function in the ARPEGE" alt="" coords="901,1232,1080,1485"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0bcfda435fb7dd9cd18f94aa10ce60fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a0bcfda435fb7dd9cd18f94aa10ce60fb">CostFunction</a> (const eckit::Configuration &amp;, const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> &amp;, const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> &amp;)</td></tr>
<tr class="memdesc:a0bcfda435fb7dd9cd18f94aa10ce60fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a cost function.  <a href="classoops_1_1CostFunction.html#a0bcfda435fb7dd9cd18f94aa10ce60fb">More...</a><br /></td></tr>
<tr class="separator:a0bcfda435fb7dd9cd18f94aa10ce60fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3b5e70c15c97457d3d0ae6bc8f6332"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a5e3b5e70c15c97457d3d0ae6bc8f6332">~CostFunction</a> ()</td></tr>
<tr class="memdesc:a5e3b5e70c15c97457d3d0ae6bc8f6332"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a cost function.  <a href="classoops_1_1CostFunction.html#a5e3b5e70c15c97457d3d0ae6bc8f6332">More...</a><br /></td></tr>
<tr class="separator:a5e3b5e70c15c97457d3d0ae6bc8f6332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfe7e1cc401e3206e0a0db086f43c72"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a7dfe7e1cc401e3206e0a0db086f43c72">evaluate</a> (const <a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;, const eckit::Configuration &amp;config=eckit::LocalConfiguration(), <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt; post=<a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt;()) const</td></tr>
<tr class="memdesc:a7dfe7e1cc401e3206e0a0db086f43c72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the non-linear cost function.  <a href="classoops_1_1CostFunction.html#a7dfe7e1cc401e3206e0a0db086f43c72">More...</a><br /></td></tr>
<tr class="separator:a7dfe7e1cc401e3206e0a0db086f43c72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f5436014c826918c0593d55f07df3be"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be">linearize</a> (const <a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;, const eckit::Configuration &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt; post=<a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt;())</td></tr>
<tr class="memdesc:a9f5436014c826918c0593d55f07df3be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linearise the cost function: set up the quadratic cost function.  <a href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be">More...</a><br /></td></tr>
<tr class="separator:a9f5436014c826918c0593d55f07df3be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad83281587aa637c33be0f28fc30373be"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ad83281587aa637c33be0f28fc30373be">runTL</a> (<a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;, <a class="el" href="classoops_1_1PostProcessorTL.html">PostProcessorTL</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; post=<a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt;(), const bool idModel=false) const =0</td></tr>
<tr class="memdesc:ad83281587aa637c33be0f28fc30373be"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoops_1_1Run.html">Run</a> the tangent linear model (virtual method)  <a href="classoops_1_1CostFunction.html#ad83281587aa637c33be0f28fc30373be">More...</a><br /></td></tr>
<tr class="separator:ad83281587aa637c33be0f28fc30373be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e40a4b04c5c45124eb166fb5406cb32"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a3e40a4b04c5c45124eb166fb5406cb32">runAD</a> (<a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;, <a class="el" href="classoops_1_1PostProcessorAD.html">PostProcessorAD</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; post=<a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt;(), const bool idModel=false) const =0</td></tr>
<tr class="memdesc:a3e40a4b04c5c45124eb166fb5406cb32"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoops_1_1Run.html">Run</a> the adjoint model (virtual method)  <a href="classoops_1_1CostFunction.html#a3e40a4b04c5c45124eb166fb5406cb32">More...</a><br /></td></tr>
<tr class="separator:a3e40a4b04c5c45124eb166fb5406cb32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e734ad4bf35fec87331ba5bddf4cb0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a04e734ad4bf35fec87331ba5bddf4cb0">zeroAD</a> (<a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;) const =0</td></tr>
<tr class="memdesc:a04e734ad4bf35fec87331ba5bddf4cb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nullify the increment prior to running the adjoint model (virtual method)  <a href="classoops_1_1CostFunction.html#a04e734ad4bf35fec87331ba5bddf4cb0">More...</a><br /></td></tr>
<tr class="separator:a04e734ad4bf35fec87331ba5bddf4cb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a153033622acd13037540d9fed73d4924"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a153033622acd13037540d9fed73d4924">runNL</a> (<a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt; &amp;) const =0</td></tr>
<tr class="memdesc:a153033622acd13037540d9fed73d4924"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model (virtual method)  <a href="classoops_1_1CostFunction.html#a153033622acd13037540d9fed73d4924">More...</a><br /></td></tr>
<tr class="separator:a153033622acd13037540d9fed73d4924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad378d566ae9c105bef1ab7c9206369ba"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ad378d566ae9c105bef1ab7c9206369ba">runNL</a> (<a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;xx, const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt; &amp;pp)</td></tr>
<tr class="memdesc:ad378d566ae9c105bef1ab7c9206369ba"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model (virtual method)  <a href="classoops_1_1CostFunction.html#ad378d566ae9c105bef1ab7c9206369ba">More...</a><br /></td></tr>
<tr class="separator:ad378d566ae9c105bef1ab7c9206369ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e13195b3ae645295dd42ce48424da56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a3e13195b3ae645295dd42ce48424da56">addIncrement</a> (<a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;, const <a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; post=<a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt;()) const</td></tr>
<tr class="memdesc:a3e13195b3ae645295dd42ce48424da56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add increment to the first guess.  <a href="classoops_1_1CostFunction.html#a3e13195b3ae645295dd42ce48424da56">More...</a><br /></td></tr>
<tr class="separator:a3e13195b3ae645295dd42ce48424da56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae129b06da634ee7e791d55199400d933"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ae129b06da634ee7e791d55199400d933">resetLinearization</a> ()</td></tr>
<tr class="memdesc:ae129b06da634ee7e791d55199400d933"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rest the quadratic cost function.  <a href="classoops_1_1CostFunction.html#ae129b06da634ee7e791d55199400d933">More...</a><br /></td></tr>
<tr class="separator:ae129b06da634ee7e791d55199400d933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ded191b42bf43d092a067752a97b47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#af4ded191b42bf43d092a067752a97b47">computeGradientFG</a> (<a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;) const</td></tr>
<tr class="memdesc:af4ded191b42bf43d092a067752a97b47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the cost function gradient at first guess (without Jb)  <a href="classoops_1_1CostFunction.html#af4ded191b42bf43d092a067752a97b47">More...</a><br /></td></tr>
<tr class="separator:af4ded191b42bf43d092a067752a97b47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e479579b5c025bd684223bfc4aed6fb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a8e479579b5c025bd684223bfc4aed6fb">computeGradientFG</a> (const <a class="el" href="classoops_1_1CostFunction.html#a12923054863fe54fd144876b944de3ce">CtrlVec_</a> &amp;, <a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;) const</td></tr>
<tr class="memdesc:a8e479579b5c025bd684223bfc4aed6fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the cost function gradient at first guess (without Jb)  <a href="classoops_1_1CostFunction.html#a8e479579b5c025bd684223bfc4aed6fb">More...</a><br /></td></tr>
<tr class="separator:a8e479579b5c025bd684223bfc4aed6fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9048264d1b4e666d9f992910b02e5f80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a9048264d1b4e666d9f992910b02e5f80">checkpoint</a> (eckit::LocalConfiguration &amp;) const</td></tr>
<tr class="memdesc:a9048264d1b4e666d9f992910b02e5f80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checkpoint.  <a href="classoops_1_1CostFunction.html#a9048264d1b4e666d9f992910b02e5f80">More...</a><br /></td></tr>
<tr class="separator:a9048264d1b4e666d9f992910b02e5f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d91975ee9b053fc7d69a376e3c2aa29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a3d91975ee9b053fc7d69a376e3c2aa29">restart</a> (const eckit::Configuration &amp;)</td></tr>
<tr class="memdesc:a3d91975ee9b053fc7d69a376e3c2aa29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart.  <a href="classoops_1_1CostFunction.html#a3d91975ee9b053fc7d69a376e3c2aa29">More...</a><br /></td></tr>
<tr class="separator:a3d91975ee9b053fc7d69a376e3c2aa29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31214b40b102ae7965c54354ec6cce45"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a31214b40b102ae7965c54354ec6cce45">jb</a> () const</td></tr>
<tr class="memdesc:a31214b40b102ae7965c54354ec6cce45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access \( J_b\).  <a href="classoops_1_1CostFunction.html#a31214b40b102ae7965c54354ec6cce45">More...</a><br /></td></tr>
<tr class="separator:a31214b40b102ae7965c54354ec6cce45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dee360528ce876c3d1e4b7f217b802a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> (const unsigned ii) const</td></tr>
<tr class="memdesc:a4dee360528ce876c3d1e4b7f217b802a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access terms of the cost function other than \(J_b\).  <a href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">More...</a><br /></td></tr>
<tr class="separator:a4dee360528ce876c3d1e4b7f217b802a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acfb71d2502722de8f248bcbe1cf13f"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a> () const</td></tr>
<tr class="memdesc:a3acfb71d2502722de8f248bcbe1cf13f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the numer of other cost function terms \(J_o, J_c, ..\).  <a href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">More...</a><br /></td></tr>
<tr class="separator:a3acfb71d2502722de8f248bcbe1cf13f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76653e44e1af57818b2086f32e15b262"><td class="memItemLeft" align="right" valign="top">virtual const double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a76653e44e1af57818b2086f32e15b262">getCostJb</a> () const</td></tr>
<tr class="memdesc:a76653e44e1af57818b2086f32e15b262"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Jb cost function value.  <a href="classoops_1_1CostFunction.html#a76653e44e1af57818b2086f32e15b262">More...</a><br /></td></tr>
<tr class="separator:a76653e44e1af57818b2086f32e15b262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fd72c73930710b8b354ff36124555e5"><td class="memItemLeft" align="right" valign="top">virtual const double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a2fd72c73930710b8b354ff36124555e5">getCostJoJc</a> () const</td></tr>
<tr class="memdesc:a2fd72c73930710b8b354ff36124555e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the JoJc cost function value.  <a href="classoops_1_1CostFunction.html#a2fd72c73930710b8b354ff36124555e5">More...</a><br /></td></tr>
<tr class="separator:a2fd72c73930710b8b354ff36124555e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:acf056c68294bc35901fd5eaec230adcf"><td class="memItemLeft" align="right" valign="top">static const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#acf056c68294bc35901fd5eaec230adcf">classname</a> ()</td></tr>
<tr class="separator:acf056c68294bc35901fd5eaec230adcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a56903c9685b92ca9ca3fe86fef575b75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a56903c9685b92ca9ca3fe86fef575b75">setupTerms</a> (const eckit::Configuration &amp;)</td></tr>
<tr class="memdesc:a56903c9685b92ca9ca3fe86fef575b75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up terms of the cost function \(J_b, J_q, J_o, J_c, ..\).  <a href="classoops_1_1CostFunction.html#a56903c9685b92ca9ca3fe86fef575b75">More...</a><br /></td></tr>
<tr class="separator:a56903c9685b92ca9ca3fe86fef575b75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f4f68fcccc83a0bba4809bf8c3f627"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ab7f4f68fcccc83a0bba4809bf8c3f627">getModel</a> () const</td></tr>
<tr class="memdesc:ab7f4f68fcccc83a0bba4809bf8c3f627"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access the non-linear model.  <a href="classoops_1_1CostFunction.html#ab7f4f68fcccc83a0bba4809bf8c3f627">More...</a><br /></td></tr>
<tr class="separator:ab7f4f68fcccc83a0bba4809bf8c3f627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae32f3ea0616c66080e198dff2b0038af"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ae32f3ea0616c66080e198dff2b0038af">getTLM</a> (const unsigned isub=0) const</td></tr>
<tr class="memdesc:ae32f3ea0616c66080e198dff2b0038af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access the linear model.  <a href="classoops_1_1CostFunction.html#ae32f3ea0616c66080e198dff2b0038af">More...</a><br /></td></tr>
<tr class="separator:ae32f3ea0616c66080e198dff2b0038af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab990f92a2ee09606884854e35ca67024"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ab990f92a2ee09606884854e35ca67024">recentreBackground</a> (const eckit::Configuration &amp;)</td></tr>
<tr class="memdesc:ab990f92a2ee09606884854e35ca67024"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-centre the background.  <a href="classoops_1_1CostFunction.html#ab990f92a2ee09606884854e35ca67024">More...</a><br /></td></tr>
<tr class="separator:ab990f92a2ee09606884854e35ca67024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7462cc85a443a23ba769995acc5d5bc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">getJterm</a> (const unsigned ii) const</td></tr>
<tr class="memdesc:a7462cc85a443a23ba769995acc5d5bc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non const access to JTerms for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions.  <a href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">More...</a><br /></td></tr>
<tr class="separator:a7462cc85a443a23ba769995acc5d5bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8de01ffb54d775a6a7e1630c341d7ab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ac8de01ffb54d775a6a7e1630c341d7ab">getJb</a> () const</td></tr>
<tr class="memdesc:ac8de01ffb54d775a6a7e1630c341d7ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non const access to Jb for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions <br  />
  <a href="classoops_1_1CostFunction.html#ac8de01ffb54d775a6a7e1630c341d7ab">More...</a><br /></td></tr>
<tr class="separator:ac8de01ffb54d775a6a7e1630c341d7ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3daac3ea30f0a1145118234a85bb6e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a> &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a7f3daac3ea30f0a1145118234a85bb6e">getTLMs</a> ()</td></tr>
<tr class="memdesc:a7f3daac3ea30f0a1145118234a85bb6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non const access to TL <a class="el" href="classoops_1_1Model.html" title="Encapsulates the nonlinear forecast model.">Model</a> for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions <br  />
  <a href="classoops_1_1CostFunction.html#a7f3daac3ea30f0a1145118234a85bb6e">More...</a><br /></td></tr>
<tr class="separator:a7f3daac3ea30f0a1145118234a85bb6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:ad912c40552a91737b416a030955a6adb"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a> = <a class="el" href="classoops_1_1CostTermBase.html">CostTermBase</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:ad912c40552a91737b416a030955a6adb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ea88f1ea9ca655822d51aeb3b69162f"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> = <a class="el" href="classoops_1_1ControlIncrement.html">ControlIncrement</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a8ea88f1ea9ca655822d51aeb3b69162f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ee05b114f16bf79b51044fd6e5cc8f0"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> = <a class="el" href="classoops_1_1ControlVariable.html">ControlVariable</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a9ee05b114f16bf79b51044fd6e5cc8f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12923054863fe54fd144876b944de3ce"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a12923054863fe54fd144876b944de3ce">CtrlVec_</a> = <a class="el" href="classoops_1_1ControlVector.html">ControlVector</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a12923054863fe54fd144876b944de3ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1784037bdc70348117f81b08913e8168"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> = <a class="el" href="classoops_1_1Geometry.html">Geometry</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a1784037bdc70348117f81b08913e8168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1c5896acf77139e7185946114d26511"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> = <a class="el" href="classoops_1_1Increment.html">Increment</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:aa1c5896acf77139e7185946114d26511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c3eed43284eb0c7f12af9ecb738eba3"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a> = <a class="el" href="classoops_1_1CostJbTotal.html">CostJbTotal</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a0c3eed43284eb0c7f12af9ecb738eba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa1dda0ecd2e77753c2a3ffb0a4f0fa3"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#aaa1dda0ecd2e77753c2a3ffb0a4f0fa3">JqTerm_</a> = <a class="el" href="classoops_1_1JqTerm.html">JqTerm</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:aaa1dda0ecd2e77753c2a3ffb0a4f0fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640206ef3ebb11edbfc1ae92c4a726c5"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a> = <a class="el" href="classoops_1_1LinearModel.html">LinearModel</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a640206ef3ebb11edbfc1ae92c4a726c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c79bedb948f2b6ad9866d7fd9c6b73"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> = <a class="el" href="classoops_1_1Model.html">Model</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:af2c79bedb948f2b6ad9866d7fd9c6b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11d9d0debd0a09669bff809d6516babc"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> = <a class="el" href="classoops_1_1State.html">State</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a11d9d0debd0a09669bff809d6516babc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c01c1ef5e61f796ebb794da4854e678"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a2c01c1ef5e61f796ebb794da4854e678">Variables_</a> = <a class="el" href="classoops_1_1Variables.html">Variables</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a2c01c1ef5e61f796ebb794da4854e678"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ac09a7ac7491959d035da33317c994c4e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ac09a7ac7491959d035da33317c994c4e">addIncr</a> (<a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;, const <a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; &amp;) const =0</td></tr>
<tr class="memdesc:ac09a7ac7491959d035da33317c994c4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual method to add the increment to the state.  <a href="classoops_1_1CostFunction.html#ac09a7ac7491959d035da33317c994c4e">More...</a><br /></td></tr>
<tr class="separator:ac09a7ac7491959d035da33317c994c4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77d9df27308e186f507bcffba3d55c13"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classoops_1_1CostJbState.html">CostJbState</a>&lt; MODEL &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a77d9df27308e186f507bcffba3d55c13">newJb</a> (const eckit::Configuration &amp;, const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> &amp;, const <a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;) const =0</td></tr>
<tr class="memdesc:a77d9df27308e186f507bcffba3d55c13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the \(J_b, J_q\) term of the cost function (virtual method)  <a href="classoops_1_1CostFunction.html#a77d9df27308e186f507bcffba3d55c13">More...</a><br /></td></tr>
<tr class="separator:a77d9df27308e186f507bcffba3d55c13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c9c1bf8905241260af5738cfc278e4"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classoops_1_1CostJo.html">CostJo</a>&lt; MODEL &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ad2c9c1bf8905241260af5738cfc278e4">newJo</a> (const eckit::Configuration &amp;) const =0</td></tr>
<tr class="memdesc:ad2c9c1bf8905241260af5738cfc278e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the \(J_o\) term of the cost function (virtual method)  <a href="classoops_1_1CostFunction.html#ad2c9c1bf8905241260af5738cfc278e4">More...</a><br /></td></tr>
<tr class="separator:ad2c9c1bf8905241260af5738cfc278e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed46ad6149d43bbb7f9f1e4e1c5677b5"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classoops_1_1CostTermBase.html">CostTermBase</a>&lt; MODEL &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#aed46ad6149d43bbb7f9f1e4e1c5677b5">newJc</a> (const eckit::Configuration &amp;, const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> &amp;) const =0</td></tr>
<tr class="memdesc:aed46ad6149d43bbb7f9f1e4e1c5677b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create other terms of the cost function \(J_c, ..\) (virtual method)  <a href="classoops_1_1CostFunction.html#aed46ad6149d43bbb7f9f1e4e1c5677b5">More...</a><br /></td></tr>
<tr class="separator:aed46ad6149d43bbb7f9f1e4e1c5677b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a07f5c960d0817c5ca8e7a79177fe64"><td class="memItemLeft" align="right" valign="top">const bool &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a0a07f5c960d0817c5ca8e7a79177fe64">reduceMemoryFootprint</a> () const</td></tr>
<tr class="memdesc:a0a07f5c960d0817c5ca8e7a79177fe64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduce memory footprit (for multi-executable mode only)  <a href="classoops_1_1CostFunction.html#a0a07f5c960d0817c5ca8e7a79177fe64">More...</a><br /></td></tr>
<tr class="separator:a0a07f5c960d0817c5ca8e7a79177fe64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aaddfbe90cc0f32e1754f744c254da9e7"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#aaddfbe90cc0f32e1754f744c254da9e7">resol_</a></td></tr>
<tr class="memdesc:aaddfbe90cc0f32e1754f744c254da9e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Outer-loop geometry.  <a href="classoops_1_1CostFunction.html#aaddfbe90cc0f32e1754f744c254da9e7">More...</a><br /></td></tr>
<tr class="separator:aaddfbe90cc0f32e1754f744c254da9e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec874cb9c52b7bcd3c608b37cf59ee2b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#aec874cb9c52b7bcd3c608b37cf59ee2b">model_</a></td></tr>
<tr class="memdesc:aec874cb9c52b7bcd3c608b37cf59ee2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non-linear model.  <a href="classoops_1_1CostFunction.html#aec874cb9c52b7bcd3c608b37cf59ee2b">More...</a><br /></td></tr>
<tr class="separator:aec874cb9c52b7bcd3c608b37cf59ee2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a565b1faee3abb359e4d4932a105e03a4"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a></td></tr>
<tr class="memdesc:a565b1faee3abb359e4d4932a105e03a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terms of the cost function.  <a href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">More...</a><br /></td></tr>
<tr class="separator:a565b1faee3abb359e4d4932a105e03a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a63c4c712517bc7ecac58fcab96506c"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a></td></tr>
<tr class="memdesc:a4a63c4c712517bc7ecac58fcab96506c"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(J_b, J_q\) term of the cost function  <a href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">More...</a><br /></td></tr>
<tr class="separator:a4a63c4c712517bc7ecac58fcab96506c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0596bc90edb45c461df3aedd6785b85"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a></td></tr>
<tr class="memdesc:ab0596bc90edb45c461df3aedd6785b85"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(J_o, J_c, ..\) terms of the cost function  <a href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">More...</a><br /></td></tr>
<tr class="separator:ab0596bc90edb45c461df3aedd6785b85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38fbe386f4b433a386032c1a1fcabd87"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a38fbe386f4b433a386032c1a1fcabd87">tlm_</a></td></tr>
<tr class="memdesc:a38fbe386f4b433a386032c1a1fcabd87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear model (includes trajectory)  <a href="classoops_1_1CostFunction.html#a38fbe386f4b433a386032c1a1fcabd87">More...</a><br /></td></tr>
<tr class="separator:a38fbe386f4b433a386032c1a1fcabd87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15724d3056157931dcd2cb70b4a6b209"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a15724d3056157931dcd2cb70b4a6b209">lreduceMemoryFootprint_</a></td></tr>
<tr class="memdesc:a15724d3056157931dcd2cb70b4a6b209"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduce memory footprint (only in multi-executable mode)  <a href="classoops_1_1CostFunction.html#a15724d3056157931dcd2cb70b4a6b209">More...</a><br /></td></tr>
<tr class="separator:a15724d3056157931dcd2cb70b4a6b209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae581e1982c3a9f74b883e44061db62dc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ae581e1982c3a9f74b883e44061db62dc">costJb_</a></td></tr>
<tr class="separator:ae581e1982c3a9f74b883e44061db62dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6bdd6279edd267221f07bb03c81537"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a7c6bdd6279edd267221f07bb03c81537">costJoJc_</a></td></tr>
<tr class="separator:a7c6bdd6279edd267221f07bb03c81537"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename MODEL&gt;<br />
class oops::CostFunction&lt; MODEL &gt;</h3>

<p>Abstract base class for a cost function. </p>
<p><a class="el" href="classoops_1_1CostFunction.html" title="Abstract base class for a cost function.">CostFunction</a> defines and manages the computation of all the terms of the variational data assimilation cost function. It is a base class for cost functions specific to 3D-Var, 4D-Var, 4DEns-Var and weak constraint 4D-Var implemented by oops::CostFct3DVar&lt;MODEL&gt;, oops::CostFct4DVar&lt;MODEL&gt;, oops::CostFct4DEnsVar&lt;MODEL&gt; and oops::CostFctWeak&lt;MODEL&gt;, respectively.</p>
<p>Concrete cost functions are produced by <a class="el" href="classoops_1_1CostFactory.html" title="Cost Function Factory.">CostFactory</a>.</p>
<p>IFS: 4D-Var (<a class="el" href="classoops_1_1CostFct4DVar.html" title="Strong Constraint 4D-Var Cost Function.">CostFct4DVar</a>) is set up by default. </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00071">71</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ad912c40552a91737b416a030955a6adb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad912c40552a91737b416a030955a6adb">&#9670;&nbsp;</a></span>CostBase_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a> =  <a class="el" href="classoops_1_1CostTermBase.html">CostTermBase</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00072">72</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a8ea88f1ea9ca655822d51aeb3b69162f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ea88f1ea9ca655822d51aeb3b69162f">&#9670;&nbsp;</a></span>CtrlInc_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> =  <a class="el" href="classoops_1_1ControlIncrement.html">ControlIncrement</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00073">73</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a9ee05b114f16bf79b51044fd6e5cc8f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ee05b114f16bf79b51044fd6e5cc8f0">&#9670;&nbsp;</a></span>CtrlVar_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> =  <a class="el" href="classoops_1_1ControlVariable.html">ControlVariable</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00074">74</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a12923054863fe54fd144876b944de3ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12923054863fe54fd144876b944de3ce">&#9670;&nbsp;</a></span>CtrlVec_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#a12923054863fe54fd144876b944de3ce">CtrlVec_</a> =  <a class="el" href="classoops_1_1ControlVector.html">ControlVector</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00075">75</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a1784037bdc70348117f81b08913e8168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1784037bdc70348117f81b08913e8168">&#9670;&nbsp;</a></span>Geometry_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> =  <a class="el" href="classoops_1_1Geometry.html">Geometry</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00076">76</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="aa1c5896acf77139e7185946114d26511"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1c5896acf77139e7185946114d26511">&#9670;&nbsp;</a></span>Increment_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> =  <a class="el" href="classoops_1_1Increment.html">Increment</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00077">77</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a0c3eed43284eb0c7f12af9ecb738eba3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c3eed43284eb0c7f12af9ecb738eba3">&#9670;&nbsp;</a></span>JbTotal_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a> =  <a class="el" href="classoops_1_1CostJbTotal.html">CostJbTotal</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00078">78</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="aaa1dda0ecd2e77753c2a3ffb0a4f0fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa1dda0ecd2e77753c2a3ffb0a4f0fa3">&#9670;&nbsp;</a></span>JqTerm_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#aaa1dda0ecd2e77753c2a3ffb0a4f0fa3">JqTerm_</a> =  <a class="el" href="classoops_1_1JqTerm.html">JqTerm</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00079">79</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a640206ef3ebb11edbfc1ae92c4a726c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a640206ef3ebb11edbfc1ae92c4a726c5">&#9670;&nbsp;</a></span>LinearModel_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a> =  <a class="el" href="classoops_1_1LinearModel.html">LinearModel</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00080">80</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="af2c79bedb948f2b6ad9866d7fd9c6b73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2c79bedb948f2b6ad9866d7fd9c6b73">&#9670;&nbsp;</a></span>Model_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> =  <a class="el" href="classoops_1_1Model.html">Model</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00081">81</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a11d9d0debd0a09669bff809d6516babc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11d9d0debd0a09669bff809d6516babc">&#9670;&nbsp;</a></span>State_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> =  <a class="el" href="classoops_1_1State.html">State</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00082">82</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a2c01c1ef5e61f796ebb794da4854e678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c01c1ef5e61f796ebb794da4854e678">&#9670;&nbsp;</a></span>Variables_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html#a2c01c1ef5e61f796ebb794da4854e678">Variables_</a> =  <a class="el" href="classoops_1_1Variables.html">Variables</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00083">83</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0bcfda435fb7dd9cd18f94aa10ce60fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bcfda435fb7dd9cd18f94aa10ce60fb">&#9670;&nbsp;</a></span>CostFunction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFunction.html">CostFunction</a> </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> &amp;&#160;</td>
          <td class="paramname"><em>resol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a cost function. </p>
<p>The constructor sets the geomery and model objects</p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00299">299</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    : <a class="code" href="classoops_1_1CostFunction.html#aaddfbe90cc0f32e1754f744c254da9e7">resol_</a>(resol),</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="classoops_1_1CostFunction.html#aec874cb9c52b7bcd3c608b37cf59ee2b">model_</a>(model),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>(),</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>(),</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>(),</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="classoops_1_1CostFunction.html#a38fbe386f4b433a386032c1a1fcabd87">tlm_</a>(),</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="classoops_1_1CostFunction.html#a15724d3056157931dcd2cb70b4a6b209">lreduceMemoryFootprint_</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="classoops_1_1CostFunction.html#ae581e1982c3a9f74b883e44061db62dc">costJb_</a>(0.0),</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="classoops_1_1CostFunction.html#a7c6bdd6279edd267221f07bb03c81537">costJoJc_</a>(0.0) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction:created&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e3b5e70c15c97457d3d0ae6bc8f6332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3b5e70c15c97457d3d0ae6bc8f6332">&#9670;&nbsp;</a></span>~CostFunction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::~<a class="el" href="classoops_1_1CostFunction.html">CostFunction</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy a cost function. </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00092">92</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac09a7ac7491959d035da33317c994c4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac09a7ac7491959d035da33317c994c4e">&#9670;&nbsp;</a></span>addIncr()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::addIncr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual method to add the increment to the state. </p>

<p>Implemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#ad45a7e63349c36995ecf6be81c551057">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a22c1ae6b8c0ca291fbc468567d126b90">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnVar.html#a7d12ebcfbba3b0b6c3b684f89696294b">oops::CostFct4DEnVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnsVar.html#abece163eadf95af9d039e41e9d3761e5">oops::CostFct4DEnsVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFctWeak.html#a1ef2a0fdada46b9a5d67842608c6d7e9">oops::CostFctWeak&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVar.html#abe651b750c1dc4824d437e82961a5a1b">oops::CostFct4DVar&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct3DVar.html#a643d30d6657323dd4d0f3662053daa3a">oops::CostFct3DVar&lt; MODEL &gt;</a>.</p>

</div>
</div>
<a id="a3e13195b3ae645295dd42ce48424da56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e13195b3ae645295dd42ce48424da56">&#9670;&nbsp;</a></span>addIncrement()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::addIncrement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em> = <code><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt;<a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a>&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add increment to the first guess. </p>
<p>This methods adds an increment to the first guess</p>
<ol type="1">
<li>Add the auxiliary observation space components (e.g. VarBC, TOVSCV, ..)</li>
<li>Add the auxiliary model space components (e.g. model bias)</li>
<li>Add the increment to the state</li>
</ol>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00604">604</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                                                             {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::addIncrement start&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  Log::info() &lt;&lt; <span class="stringliteral">&quot;CostFunction::addIncrement: First guess:&quot;</span> &lt;&lt; xx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  Log::info() &lt;&lt; <span class="stringliteral">&quot;CostFunction::addIncrement: Increment:&quot;</span> &lt;&lt; dx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  xx.obsVar() += dx.obsVar();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  xx.modVar() += dx.modVar();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#ac09a7ac7491959d035da33317c994c4e">addIncr</a>(xx, dx, post);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  Log::test() &lt;&lt; <span class="stringliteral">&quot;CostFunction::addIncrement: Analysis norm: &quot;</span> &lt;&lt; xx.norm()</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::addIncrement done&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ControlVariable_8h_source.html#l00138">oops::ControlVariable&lt; MODEL &gt;::modVar()</a>, <a class="el" href="ControlIncrement_8h_source.html#l00150">oops::ControlIncrement&lt; MODEL &gt;::modVar()</a>, <a class="el" href="ControlVariable_8h_source.html#l00280">oops::ControlVariable&lt; MODEL &gt;::norm()</a>, <a class="el" href="ControlVariable_8h_source.html#l00145">oops::ControlVariable&lt; MODEL &gt;::obsVar()</a>, and <a class="el" href="ControlIncrement_8h_source.html#l00155">oops::ControlIncrement&lt; MODEL &gt;::obsVar()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a3e13195b3ae645295dd42ce48424da56_cgraph.png" border="0" usemap="#classoops_1_1CostFunction_a3e13195b3ae645295dd42ce48424da56_cgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a3e13195b3ae645295dd42ce48424da56_cgraph" id="classoops_1_1CostFunction_a3e13195b3ae645295dd42ce48424da56_cgraph">
<area shape="rect" title="Add increment to the first guess." alt="" coords="5,136,139,177"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#a08f7e7049122bfabb08770b9724bf094" title="Returns the auxiliary model space component of the control variable." alt="" coords="192,5,336,47"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a45b19fa6afbc1d393f30368705c5264c" title="Get augmented model control increment." alt="" coords="187,71,341,112"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#aca18e00dd76f9b337c457efffd16fd8c" title="Compute the L&#45;2 norm of the control variable." alt="" coords="192,136,336,177"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#aa37049addedf7f5a0904813ec56d7618" title="Returns the auxiliary observation space component of the control variable." alt="" coords="192,201,336,243"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a8ca2b37a736bca34976b032468669b81" title="Get augmented observation control increment." alt="" coords="187,267,341,308"/>
</map>
</div>

</div>
</div>
<a id="a9048264d1b4e666d9f992910b02e5f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9048264d1b4e666d9f992910b02e5f80">&#9670;&nbsp;</a></span>checkpoint()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::checkpoint </td>
          <td>(</td>
          <td class="paramtype">eckit::LocalConfiguration &amp;&#160;</td>
          <td class="paramname"><em>conf</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checkpoint. </p>
<p>This method is checkpointing the terms of the cost function required for restarting</p>
<ol type="1">
<li>Call the checkpoint method of \(J_o, J_c, ..\)</li>
</ol>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00669">669</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                                                        {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a7095b96873ca6a28738b2b25f5dae299">checkpoint</a>(conf);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acf056c68294bc35901fd5eaec230adcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf056c68294bc35901fd5eaec230adcf">&#9670;&nbsp;</a></span>classname()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const std::string <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::classname </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00086">86</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;oops::CostFunction&quot;</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e479579b5c025bd684223bfc4aed6fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e479579b5c025bd684223bfc4aed6fb">&#9670;&nbsp;</a></span>computeGradientFG() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::computeGradientFG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a12923054863fe54fd144876b944de3ce">CtrlVec_</a> &amp;&#160;</td>
          <td class="paramname"><em>dv0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname"><em>grad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the cost function gradient at first guess (without Jb) </p>
<p>This method computes and returns the first guess gradient in control space: \(H^T R^{-1} [d + H (dx_{fg} - U dv_0) ]\)</p>
<ol type="1">
<li>Compute \(dx_{fg} - U dv_0\)</li>
<li>Compute \(H (dx_{fg} - U dv_0)\)</li>
<li>Compute \(R^{-1} [d + H (dx_{fg} - U dv_0) ]\)</li>
<li><a class="el" href="classoops_1_1Run.html">Run</a> ADJ: \( H^T R^{-1} [d + H (dx_{fg} - U dv_0) ] \)</li>
<li>Return: \( 1/2 [d + H (dx_{fg} - U dv_0) ]^T R^{-1} [d + H (dx_{fg} - U dv_0) ] \)</li>
</ol>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00547">547</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                                                    {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> dxfg(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a31214b40b102ae7965c54354ec6cce45">jb</a>().getFirstGuessIncrement(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> dx(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a31214b40b102ae7965c54354ec6cce45">jb</a>().getFirstGuessIncrement(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a31214b40b102ae7965c54354ec6cce45">jb</a>().<a class="code" href="classoops_1_1CostJbTotal.html#a469c194404e7346e95b9147bda3a5600">multiplyBsqrt</a>(dv0, dx);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  dxfg -= dx;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  PostProcessorTL&lt;Increment_&gt; costtl;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = 0; jj &lt; this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a>(); ++jj) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    costtl.enrollProcessor(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>(jj).<a class="code" href="classoops_1_1CostTermBase.html#a653aa78ac4ec1b64f33840e07f0f14ac">setupTL</a>(dxfg));</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> mdxfg(dxfg);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#ad83281587aa637c33be0f28fc30373be">runTL</a>(mdxfg, costtl);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  PostProcessorAD&lt;Increment_&gt; costad;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a04e734ad4bf35fec87331ba5bddf4cb0">zeroAD</a>(grad);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  DualVector&lt;MODEL&gt; yy;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  DualVector&lt;MODEL&gt; ww;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  DualVector&lt;MODEL&gt; zz;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">// \f$ d + H (dx_{fg} - U dv_0) \f$</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = 0; jj &lt; this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a>(); ++jj) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    yy.append(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>(jj).<a class="code" href="classoops_1_1CostTermBase.html#a8ad6ac0fa63b6a48f6d1e8a1196f3337">newDepartures</a>());</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    ww.append(costtl.releaseOutputFromTL(jj));</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  yy += ww;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">// \f$ R^{-1} [d + H (dx_{fg} - U dv_0) ] \f$</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = 0; jj &lt; this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a>(); ++jj) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    zz.append(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>(jj).<a class="code" href="classoops_1_1CostTermBase.html#a0e7d83cef3fb9932a98736aad9e78a7d">multiplyCoInv</a>(*yy.getv(jj)));</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = 0; jj &lt; this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a>(); ++jj) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    costad.enrollProcessor(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>(jj).<a class="code" href="classoops_1_1CostTermBase.html#a7de1981a3da6b9c391406999d6c4ef36">setupAD</a>(zz.getv(jj), grad));</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3e40a4b04c5c45124eb166fb5406cb32">runAD</a>(grad, costad);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">double</span> costJ0JoJc = 0.5 * <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(yy, zz);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">return</span> costJ0JoJc;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="DualVector_8h_source.html#l00110">oops::DualVector&lt; MODEL &gt;::append()</a>, <a class="el" href="dot__product_8h_source.html#l00017">dot_product()</a>, <a class="el" href="PostProcessorAD_8h_source.html#l00038">oops::PostProcessorAD&lt; INCR &gt;::enrollProcessor()</a>, <a class="el" href="PostProcessorTL_8h_source.html#l00055">oops::PostProcessorTL&lt; INCR &gt;::enrollProcessor()</a>, <a class="el" href="DualVector_8h_source.html#l00129">oops::DualVector&lt; MODEL &gt;::getv()</a>, and <a class="el" href="PostProcessorTL_8h_source.html#l00068">oops::PostProcessorTL&lt; INCR &gt;::releaseOutputFromTL()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a8e479579b5c025bd684223bfc4aed6fb_cgraph.png" border="0" usemap="#classoops_1_1CostFunction_a8e479579b5c025bd684223bfc4aed6fb_cgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a8e479579b5c025bd684223bfc4aed6fb_cgraph" id="classoops_1_1CostFunction_a8e479579b5c025bd684223bfc4aed6fb_cgraph">
<area shape="rect" title="Compute the cost function gradient at first guess (without Jb)" alt="" coords="5,141,151,182"/>
<area shape="rect" href="classoops_1_1DualVector.html#a71176330c74c3b7a5098f773f3aae978" title=" " alt="" coords="199,5,367,32"/>
<area shape="rect" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a" title="Syntactic sugar to let us use a more mathematical notation for dot products." alt="" coords="237,56,328,83"/>
<area shape="rect" href="classoops_1_1PostProcessorAD.html#a7c1e57a09fbec28669ee2c3114cf5b29" title=" " alt="" coords="203,107,363,149"/>
<area shape="rect" href="classoops_1_1PostProcessorTL.html#adb26af4d78ec46f4db6b9d8f8715e8e6" title="Adds a post processor to the vector of post&#45;processors." alt="" coords="203,173,362,214"/>
<area shape="rect" href="classoops_1_1DualVector.html#a82a56dc33d3cebd2e079e2b3e3e6a33d" title=" " alt="" coords="207,239,358,265"/>
<area shape="rect" href="classoops_1_1PostProcessorTL.html#a371f5df998e2512ece511565e521aac3" title="Release the dual space output of the post&#45;processor." alt="" coords="203,290,362,331"/>
</map>
</div>

</div>
</div>
<a id="af4ded191b42bf43d092a067752a97b47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4ded191b42bf43d092a067752a97b47">&#9670;&nbsp;</a></span>computeGradientFG() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::computeGradientFG </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname"><em>grad</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the cost function gradient at first guess (without Jb) </p>
<p>This method computes and returns the first guess gradient in model space: \(H^T R^{-1} d\)</p>
<ol type="1">
<li>Set up post-processors for computation of the first guess gradient for \(J_o\) and \(J_c\)</li>
<li><a class="el" href="classoops_1_1Run.html">Run</a> the adjoint model with attached post-processors to compute the gradient</li>
</ol>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00524">524</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                                                {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  PostProcessor&lt;Increment_&gt; pp;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  PostProcessorAD&lt;Increment_&gt; costad;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a04e734ad4bf35fec87331ba5bddf4cb0">zeroAD</a>(grad);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    std::shared_ptr&lt;const GeneralizedDepartures&gt; tmp(<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#aa5c45447869fb5399c7b58db121281dc">newGradientFG</a>());</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    costad.enrollProcessor(<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a7de1981a3da6b9c391406999d6c4ef36">setupAD</a>(tmp, grad));</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3e40a4b04c5c45124eb166fb5406cb32">runAD</a>(grad, costad, pp);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="PostProcessorAD_8h_source.html#l00038">oops::PostProcessorAD&lt; INCR &gt;::enrollProcessor()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_af4ded191b42bf43d092a067752a97b47_cgraph.png" border="0" usemap="#classoops_1_1CostFunction_af4ded191b42bf43d092a067752a97b47_cgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_af4ded191b42bf43d092a067752a97b47_cgraph" id="classoops_1_1CostFunction_af4ded191b42bf43d092a067752a97b47_cgraph">
<area shape="rect" title="Compute the cost function gradient at first guess (without Jb)" alt="" coords="5,5,151,47"/>
<area shape="rect" href="classoops_1_1PostProcessorAD.html#a7c1e57a09fbec28669ee2c3114cf5b29" title=" " alt="" coords="199,5,359,47"/>
</map>
</div>

</div>
</div>
<a id="a7dfe7e1cc401e3206e0a0db086f43c72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfe7e1cc401e3206e0a0db086f43c72">&#9670;&nbsp;</a></span>evaluate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::evaluate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>fguess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>config</em> = <code>eckit::LocalConfiguration()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em> = <code><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt;<a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a>&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate the non-linear cost function. </p>
<p>This method evaluates the final non-linear cost function and returns the cost function value</p>
<ol type="1">
<li>Setup terms of cost function: \(J_b, J_q, J_o, J_c\)</li>
<li><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model</li>
<li>Compute the non-linear cost function value</li>
</ol>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#a711bbe94ab0bc1e1c4f0fcf19ba4b337">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a112fb52065fabbc128a608246f6fb245">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00353">353</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                                                       {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  util::LogbookWriter&lt;bool&gt; log(<span class="stringliteral">&quot;LastNonlinearIntegration&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::evaluate start&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  PostProcessor&lt;State_&gt; pp(post);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#aaa1dda0ecd2e77753c2a3ffb0a4f0fa3">JqTerm_</a> *jq = <a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>-&gt;initialize(fguess);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  pp.enrollProcessor(jq);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    pp.enrollProcessor(<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a624eb63b5a3f81a75f392b7f15f8c9de">initialize</a>(fguess, config));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> mfguess(fguess);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a153033622acd13037540d9fed73d4924">runNL</a>(mfguess, pp);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">double</span> zzz = 0.0;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    zzz += <a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a57e653ebb4c983b00a50c6b7fa50b8aa">finalize</a>(config);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  zzz += <a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>-&gt;finalize(jq, config);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  Log::test() &lt;&lt; <span class="stringliteral">&quot;CostFunction: Nonlinear J = &quot;</span> &lt;&lt; zzz &lt;&lt; std::endl;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::evaluate done&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">return</span> zzz;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="PostProcessor_8h_source.html#l00055">oops::PostProcessor&lt; FLDS &gt;::enrollProcessor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFct4DVarTrajHR_8h_source.html#l00116">oops::CostFct4DVarTrajHR&lt; MODEL &gt;::evaluate()</a>, and <a class="el" href="CostFct4DVarMFTemplate_8h_source.html#l00168">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;::evaluate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a7dfe7e1cc401e3206e0a0db086f43c72_cgraph.png" border="0" usemap="#classoops_1_1CostFunction_a7dfe7e1cc401e3206e0a0db086f43c72_cgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a7dfe7e1cc401e3206e0a0db086f43c72_cgraph" id="classoops_1_1CostFunction_a7dfe7e1cc401e3206e0a0db086f43c72_cgraph">
<area shape="rect" title="Evaluate the non&#45;linear cost function." alt="" coords="5,5,139,47"/>
<area shape="rect" href="classoops_1_1PostProcessor.html#a2e1e3cbf40ede8e32a372d8b5b2c270d" title="Adds a post processor to the vector of post&#45;processors." alt="" coords="187,5,329,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a7dfe7e1cc401e3206e0a0db086f43c72_icgraph.png" border="0" usemap="#classoops_1_1CostFunction_a7dfe7e1cc401e3206e0a0db086f43c72_icgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a7dfe7e1cc401e3206e0a0db086f43c72_icgraph" id="classoops_1_1CostFunction_a7dfe7e1cc401e3206e0a0db086f43c72_icgraph">
<area shape="rect" title="Evaluate the non&#45;linear cost function." alt="" coords="264,39,397,80"/>
<area shape="rect" href="classoops_1_1CostFct4DVarTrajHR.html#a112fb52065fabbc128a608246f6fb245" title="Evaluate the non&#45;linear cost function." alt="" coords="21,5,200,47"/>
<area shape="rect" href="classoops_1_1CostFct4DVarMFTemplate.html#a711bbe94ab0bc1e1c4f0fcf19ba4b337" title="Evaluate the non&#45;linear cost function." alt="" coords="5,71,216,112"/>
</map>
</div>

</div>
</div>
<a id="a76653e44e1af57818b2086f32e15b262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76653e44e1af57818b2086f32e15b262">&#9670;&nbsp;</a></span>getCostJb()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const double&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::getCostJb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the Jb cost function value. </p>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#ae788d0aeb5269799e88f035463a1ab0a">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a46ca065ed8dea4b536d5297201686e07">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00156">156</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classoops_1_1CostFunction.html#ae581e1982c3a9f74b883e44061db62dc">costJb_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00216">oops::CostFunction&lt; MODEL &gt;::costJb_</a>.</p>

</div>
</div>
<a id="a2fd72c73930710b8b354ff36124555e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fd72c73930710b8b354ff36124555e5">&#9670;&nbsp;</a></span>getCostJoJc()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const double&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::getCostJoJc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the JoJc cost function value. </p>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#a841192b2dcbc2ac326859aa3150563b0">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a96f6cd884d8a7d7de0ceff8faef9be58">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00159">159</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classoops_1_1CostFunction.html#a7c6bdd6279edd267221f07bb03c81537">costJoJc_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00217">oops::CostFunction&lt; MODEL &gt;::costJoJc_</a>.</p>

</div>
</div>
<a id="ac8de01ffb54d775a6a7e1630c341d7ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8de01ffb54d775a6a7e1630c341d7ab">&#9670;&nbsp;</a></span>getJb()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a>&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::getJb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Non const access to Jb for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00177">177</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{<span class="keywordflow">return</span> *<a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00206">oops::CostFunction&lt; MODEL &gt;::jb_</a>.</p>

</div>
</div>
<a id="a7462cc85a443a23ba769995acc5d5bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7462cc85a443a23ba769995acc5d5bc0">&#9670;&nbsp;</a></span>getJterm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a>&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::getJterm </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>ii</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Non const access to JTerms for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions. </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00174">174</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{<span class="keywordflow">return</span> *<a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>[ii];}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00208">oops::CostFunction&lt; MODEL &gt;::jterms_</a>.</p>

</div>
</div>
<a id="ab7f4f68fcccc83a0bba4809bf8c3f627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7f4f68fcccc83a0bba4809bf8c3f627">&#9670;&nbsp;</a></span>getModel()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a>&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::getModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access the non-linear model. </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00165">165</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classoops_1_1CostFunction.html#aec874cb9c52b7bcd3c608b37cf59ee2b">model_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00202">oops::CostFunction&lt; MODEL &gt;::model_</a>.</p>

</div>
</div>
<a id="ae32f3ea0616c66080e198dff2b0038af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae32f3ea0616c66080e198dff2b0038af">&#9670;&nbsp;</a></span>getTLM()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a>&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::getTLM </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>isub</em> = <code>0</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access the linear model. </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00167">167</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                                            {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">return</span> *<a class="code" href="classoops_1_1CostFunction.html#a38fbe386f4b433a386032c1a1fcabd87">tlm_</a>[isub];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00211">oops::CostFunction&lt; MODEL &gt;::tlm_</a>.</p>

</div>
</div>
<a id="a7f3daac3ea30f0a1145118234a85bb6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f3daac3ea30f0a1145118234a85bb6e">&#9670;&nbsp;</a></span>getTLMs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a>&gt; &gt;&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::getTLMs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Non const access to TL <a class="el" href="classoops_1_1Model.html" title="Encapsulates the nonlinear forecast model.">Model</a> for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00180">180</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classoops_1_1CostFunction.html#a38fbe386f4b433a386032c1a1fcabd87">tlm_</a>;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00211">oops::CostFunction&lt; MODEL &gt;::tlm_</a>.</p>

</div>
</div>
<a id="a31214b40b102ae7965c54354ec6cce45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31214b40b102ae7965c54354ec6cce45">&#9670;&nbsp;</a></span>jb()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a>&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::jb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access \( J_b\). </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00147">147</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{ <span class="keywordflow">return</span> *<a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00206">oops::CostFunction&lt; MODEL &gt;::jb_</a>.</p>

<p class="reference">Referenced by <a class="el" href="BMatrix_8h_source.html#l00041">oops::BMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="LBHessianMatrix_8h_source.html#l00049">oops::LBHessianMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="JbMatrix_8h_source.html#l00050">oops::JbMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="BMatrix_8h_source.html#l00074">oops::BMatrix&lt; MODEL &gt;::multiplyB()</a>, <a class="el" href="BMatrix_8h_source.html#l00050">oops::BMatrix&lt; MODEL &gt;::multiplyId()</a>, <a class="el" href="BMatrix_8h_source.html#l00044">oops::BMatrix&lt; MODEL &gt;::multiplySqrt()</a>, and <a class="el" href="BMatrix_8h_source.html#l00047">oops::BMatrix&lt; MODEL &gt;::multiplySqrtTrans()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a31214b40b102ae7965c54354ec6cce45_icgraph.png" border="0" usemap="#classoops_1_1CostFunction_a31214b40b102ae7965c54354ec6cce45_icgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a31214b40b102ae7965c54354ec6cce45_icgraph" id="classoops_1_1CostFunction_a31214b40b102ae7965c54354ec6cce45_icgraph">
<area shape="rect" title="Access ." alt="" coords="491,470,640,497"/>
<area shape="rect" href="classoops_1_1BMatrix.html#ac7a169bdc944d77ed65cccd584ebca7e" title=" " alt="" coords="280,209,431,235"/>
<area shape="rect" href="classoops_1_1LBHessianMatrix.html#ab1306ed7701729b87c281ea542a45591" title=" " alt="" coords="277,345,433,387"/>
<area shape="rect" href="classoops_1_1JbMatrix.html#aeb7fe19da2f7de2b346a77681b30e29e" title=" " alt="" coords="278,535,433,562"/>
<area shape="rect" href="classoops_1_1BMatrix.html#af326a336f1f969e5ee11e865ee1b1141" title=" " alt="" coords="276,626,435,653"/>
<area shape="rect" href="classoops_1_1BMatrix.html#a8e4d81520d880d75b38c5ea2f67438a2" title=" " alt="" coords="275,757,436,783"/>
<area shape="rect" href="classoops_1_1BMatrix.html#a4a4210b366136e546a52e2c788e1e9f2" title=" " alt="" coords="268,411,443,438"/>
<area shape="rect" href="classoops_1_1BMatrix.html#aeec47e205511554b7f82f8a8320447d6" title=" " alt="" coords="268,463,443,504"/>
<area shape="rect" href="classoops_1_1DualMinimizer.html#a3cf6d56e66d48c5aa41d9c1f7d5a4237" title="Minimizer the quadratic cost function (virtual method)" alt="" coords="44,5,181,47"/>
<area shape="rect" href="classoops_1_1DRMinimizer.html#a9cc6fd429955da531a87e2bf2bbc3018" title="Minimizer the quadratic cost function (virtual method)" alt="" coords="45,71,180,112"/>
<area shape="rect" href="classoops_1_1DRPFOMMinimizer.html#ac8337c8e8a5c8dd6785b523a60cea5a5" title=" " alt="" coords="29,136,196,177"/>
<area shape="rect" href="classoops_1_1DRIPCGMinimizer.html#a0d088584924bc71a82b7663e1f2484f5" title=" " alt="" coords="32,201,193,243"/>
<area shape="rect" href="classoops_1_1DRGMRESRMinimizer.html#a180f104bc09e9cfe53c3ea02bd79816f" title=" " alt="" coords="20,267,205,308"/>
<area shape="rect" href="classoops_1_1DRPCGMinimizer.html#a88381ab3f9aec86ed27431bc33a34fec" title=" " alt="" coords="34,332,191,373"/>
<area shape="rect" href="classoops_1_1SQRTMinimizer.html#aedbcd7115ddd82c902ae81a59be2466e" title="Solver (virtual method) &#45; implemented by concrete minimizers." alt="" coords="39,397,186,439"/>
<area shape="rect" href="classoops_1_1SQRTBPFOMMinimizer.html#a30df2854652f47eeabfc80308c05867c" title=" " alt="" coords="15,463,210,504"/>
<area shape="rect" href="classoops_1_1SQRTBPLanczosMinimizer.html#a0f88a8f7eeb9c4878b6a6c64638de3d0" title=" " alt="" coords="5,528,220,569"/>
<area shape="rect" href="classoops_1_1SQRTPCGMinimizer.html#a734525acf909e942b6ad7c3e4d75afbc" title=" " alt="" coords="25,593,200,635"/>
<area shape="rect" href="classoops_1_1SQRTBPCGMinimizer.html#abe268c2e6a4748f232ede83e95e833f1" title=" " alt="" coords="21,659,205,700"/>
<area shape="rect" href="classoops_1_1SQRTPLanczosMinimizer.html#ac25eea7136ca3924319cc506013473c8" title=" " alt="" coords="10,724,215,765"/>
<area shape="rect" href="classoops_1_1DRPLanczosMinimizer.html#a6339485da6ba7f0309db9b004427cffc" title=" " alt="" coords="19,789,206,831"/>
</map>
</div>

</div>
</div>
<a id="a4dee360528ce876c3d1e4b7f217b802a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dee360528ce876c3d1e4b7f217b802a">&#9670;&nbsp;</a></span>jterm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a>&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::jterm </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>ii</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access terms of the cost function other than \(J_b\). </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00150">150</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{ <span class="keywordflow">return</span> *<a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>[ii]; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00208">oops::CostFunction&lt; MODEL &gt;::jterms_</a>.</p>

<p class="reference">Referenced by <a class="el" href="RinvMatrix_8h_source.html#l00037">oops::RinvMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="HtMatrix_8h_source.html#l00041">oops::HtMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="HMatrix_8h_source.html#l00042">oops::HMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="LBHessianMatrix_8h_source.html#l00049">oops::LBHessianMatrix&lt; MODEL &gt;::multiply()</a>, and <a class="el" href="RMatrix_8h_source.html#l00036">oops::RMatrix&lt; MODEL &gt;::multiplyInv()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a4dee360528ce876c3d1e4b7f217b802a_icgraph.png" border="0" usemap="#classoops_1_1CostFunction_a4dee360528ce876c3d1e4b7f217b802a_icgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a4dee360528ce876c3d1e4b7f217b802a_icgraph" id="classoops_1_1CostFunction_a4dee360528ce876c3d1e4b7f217b802a_icgraph">
<area shape="rect" title="Access terms of the cost function other than ." alt="" coords="453,180,587,221"/>
<area shape="rect" href="classoops_1_1RinvMatrix.html#a61e4a71018eb143d440784f17cf08fca" title=" " alt="" coords="238,78,405,105"/>
<area shape="rect" href="classoops_1_1HtMatrix.html#aed0d6981224f758c2b8db11ad5abdbff" title=" " alt="" coords="244,187,399,214"/>
<area shape="rect" href="classoops_1_1HMatrix.html#ac6c2bd6065dfd5fed26a62d22293a2b7" title=" " alt="" coords="246,137,397,163"/>
<area shape="rect" href="classoops_1_1LBHessianMatrix.html#ab1306ed7701729b87c281ea542a45591" title=" " alt="" coords="243,239,399,280"/>
<area shape="rect" href="classoops_1_1RMatrix.html#a1c28c930f287bead69c3d30590a8233f" title=" " alt="" coords="237,305,405,331"/>
<area shape="rect" href="classoops_1_1RPCGMinimizer.html#a64cb89d1a2f7b0946b3b727cae38f1ba" title=" " alt="" coords="23,5,171,47"/>
<area shape="rect" href="classoops_1_1RPLanczosMinimizer.html#a7fe11fbe0bfaec3af4212f5411610e18" title=" " alt="" coords="8,71,187,112"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a02f86245f08d74a4e09111ae2c8fc443" title="Perform observation operator adjoint tests." alt="" coords="5,137,189,163"/>
<area shape="rect" href="classoops_1_1DualMinimizer.html#a3cf6d56e66d48c5aa41d9c1f7d5a4237" title="Minimizer the quadratic cost function (virtual method)" alt="" coords="29,188,166,229"/>
</map>
</div>

</div>
</div>
<a id="a9f5436014c826918c0593d55f07df3be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f5436014c826918c0593d55f07df3be">&#9670;&nbsp;</a></span>linearize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::linearize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>fguess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>innerConf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em> = <code><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt;<a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a>&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Linearise the cost function: set up the quadratic cost function. </p>
<p>This method sets up the quadratic cost function by linearizing the non-linear cost function.</p>
<p>Jo, Jc, .. (jterms_) terms of the cost function call their 'initialize' methods which return post-processors. These are subsequently attached to the non-linear trajectory and do their post-processing prior/during/after the trajectory evaluation; once the non-linear trajectory is completed, the terms of the cost function call their 'finalize' method which makes further use of the output acquired by the post-processors during the trajectory.</p>
<p>E.g. the 'initialize' method of the Jo term of the cost functions returns an <a class="el" href="classoops_1_1Observer.html" title="Computes .">Observer</a> post-processor. Its task is to compute model equivalents at observation locations. Once the trajectory evaluation is completed, the 'finalize' method is called to compute departures, perform screening if requested, set up the observation error covariance and print diagnostics.</p>
<p>Along with with the post-processors set up by the terms of the cost function, the <a class="el" href="classoops_1_1TrajectorySaver.html">TrajectorySaver</a> post-processor is set up. Its role is to record the interpolated high resolution states at the linear model time steps during the non-linear trajectory run. These interpolated high resolution states are subsequently used to force the linearisation trajectory.</p>
<p>Prior to the computation of the linearisation trajectory by the TrajecotrySaver, the Jb, Jo, Jc, .. terms of the cost function call their 'initializeTraj' methods which return post-processors. These are subsequently enrolled into the TrajecotrySaver and attached to the linearisation trajectory computation. Once the linearisation trajectory computation is completed, the terms of the cost function call the 'finalizeTraj' method which makes further use of the output acquired by the post-processors during the computation of the linearisation trajectory.</p>
<p>E.g. the 'initializeTraj' method of the Jo term of the cost function sets up the linear observation operator and returns an <a class="el" href="classoops_1_1Observer.html" title="Computes .">Observer</a> post-processor. Its task is to compute the linearisation for the linear observation operator. Once the linearisation trajectory computation is completed, the 'finailzeTraj' method is called to compute the departures and print diagnostics.</p>
<ol type="1">
<li>Enable the option to reduce the memory footprint in case late 4d start is enabled to make more memory available prior to writing out 4V/AN states</li>
<li>Read the inner loop configuration</li>
<li>Set up the inner loop geomerty</li>
<li>Set up the <a class="el" href="classoops_1_1TrajectorySaver.html">TrajectorySaver</a> post-processor</li>
<li>Set up \(J_o, J_c\) terms of cost function</li>
<li><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model with attached post-processors</li>
<li>Calculate the non-linear cost function value</li>
<li><p class="startli">Compute the linearisation trajectory</p>
<p class="startli">The TrajecotrySaver was attached to the non-linear model trajecotry in order to record the interpolated high resolution states at each linear model time step. Terms of the cost function (Jb, Jq, Jo, Jc) set up post processors which perform operations required to set up the quadratic cost function. These post-processors are enrolled into the <a class="el" href="classoops_1_1TrajectorySaver.html">TrajectorySaver</a>. They do their post processing during the forced (with store interpolated high resolution fields) linearisation trajectory computation.</p>
<p class="startli">Such a design was required for IFS as the linearisation of the observation operator needs to be performed with the screened ODB (CCMA rather than ECMA).</p>
</li>
<li>Finalize setting up the terms of the quadratic cost function</li>
<li>Print the cost function value</li>
<li>Reset xb</li>
</ol>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#ad0a521e1dd47fd401094faec25fc15c8">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a7c4ae909393cb470512d124e967ed585">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00388">388</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                                                  {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">if</span> (innerConf.has(<span class="stringliteral">&quot;late4d&quot;</span>)) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="classoops_1_1CostFunction.html#a15724d3056157931dcd2cb70b4a6b209">lreduceMemoryFootprint_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    Log::info() &lt;&lt; <span class="stringliteral">&quot;CostFunction::linearize reduced memory footprint enabled&quot;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keyword">const</span> eckit::LocalConfiguration resConf(innerConf, <span class="stringliteral">&quot;resolution&quot;</span>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keyword">const</span> eckit::LocalConfiguration tlmConf(innerConf, <span class="stringliteral">&quot;linearmodel&quot;</span>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  eckit::LocalConfiguration diagnostic;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">if</span> (innerConf.has(<span class="stringliteral">&quot;diagnostics&quot;</span>)) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    diagnostic = eckit::LocalConfiguration(innerConf, <span class="stringliteral">&quot;diagnostics&quot;</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> lowres(resConf);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  PostProcessor&lt;State_&gt; pp(post);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  std::shared_ptr&lt;TrajectorySaver&lt;MODEL&gt; &gt; trajectorySaver(</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keyword">new</span> TrajectorySaver&lt;MODEL&gt;(fguess.state()[0], fguess.modVar(), lowres,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                 <a class="code" href="classoops_1_1CostFunction.html#a38fbe386f4b433a386032c1a1fcabd87">tlm_</a>, tlmConf));</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  pp.enrollProcessor(trajectorySaver);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    pp.enrollProcessor(<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a624eb63b5a3f81a75f392b7f15f8c9de">initialize</a>(fguess, innerConf));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  std::unique_ptr&lt;CtrlVar_&gt; mfguess(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a>(fguess));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a153033622acd13037540d9fed73d4924">runNL</a>(*mfguess, pp);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  mfguess.reset();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a7c6bdd6279edd267221f07bb03c81537">costJoJc_</a> = 0.0;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="classoops_1_1CostFunction.html#a7c6bdd6279edd267221f07bb03c81537">costJoJc_</a> += <a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a57e653ebb4c983b00a50c6b7fa50b8aa">finalize</a>(innerConf);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// JbJq trajectory</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  std::shared_ptr&lt;JqTerm_&gt; jq(<a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>-&gt;initializeTraj(fguess, lowres, innerConf));</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  trajectorySaver-&gt;enrollProcessor(jq);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// JoJc trajectory</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    trajectorySaver-&gt;enrollProcessor(</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a0179c6c57603aaf9b2d193ed189c2a52">initializeTraj</a>(fguess, lowres, innerConf));</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  trajectorySaver-&gt;recordTrajectory();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#ae581e1982c3a9f74b883e44061db62dc">costJb_</a> = <a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>-&gt;finalizeTraj(jq.get(), innerConf);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordtype">double</span> costJoJcTraj = 0.0;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    costJoJcTraj += <a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a9978e5ad0a907e52ab609f26fc3b89e6">finalizeTraj</a>(diagnostic);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordtype">double</span> costJ = <a class="code" href="classoops_1_1CostFunction.html#ae581e1982c3a9f74b883e44061db62dc">costJb_</a> + <a class="code" href="classoops_1_1CostFunction.html#a7c6bdd6279edd267221f07bb03c81537">costJoJc_</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">double</span> costJtraj = <a class="code" href="classoops_1_1CostFunction.html#ae581e1982c3a9f74b883e44061db62dc">costJb_</a> + costJoJcTraj;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  Log::test() &lt;&lt; <span class="stringliteral">&quot;CostFunction: Nonlinear J = &quot;</span> &lt;&lt; costJ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  Log::info() &lt;&lt; <span class="stringliteral">&quot;CostFunction: Nonlinear J (traj) = &quot;</span> &lt;&lt; costJtraj</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classoops_1_1CostFunction.html#a0a07f5c960d0817c5ca8e7a79177fe64">reduceMemoryFootprint</a>()) <a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>.reset();</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">return</span> costJ;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="PostProcessor_8h_source.html#l00055">oops::PostProcessor&lt; FLDS &gt;::enrollProcessor()</a>, <a class="el" href="ControlVariable_8h_source.html#l00138">oops::ControlVariable&lt; MODEL &gt;::modVar()</a>, and <a class="el" href="ControlVariable_8h_source.html#l00132">oops::ControlVariable&lt; MODEL &gt;::state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a9f5436014c826918c0593d55f07df3be_cgraph.png" border="0" usemap="#classoops_1_1CostFunction_a9f5436014c826918c0593d55f07df3be_cgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a9f5436014c826918c0593d55f07df3be_cgraph" id="classoops_1_1CostFunction_a9f5436014c826918c0593d55f07df3be_cgraph">
<area shape="rect" title="Linearise the cost function: set up the quadratic cost function." alt="" coords="5,71,139,112"/>
<area shape="rect" href="classoops_1_1PostProcessor.html#a2e1e3cbf40ede8e32a372d8b5b2c270d" title="Adds a post processor to the vector of post&#45;processors." alt="" coords="187,5,330,47"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#a08f7e7049122bfabb08770b9724bf094" title="Returns the auxiliary model space component of the control variable." alt="" coords="187,71,331,112"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#ae32877503a550f7d6d59b307e9da310a" title="Returns a 4D state component of the control variable." alt="" coords="187,136,331,177"/>
</map>
</div>

</div>
</div>
<a id="a77d9df27308e186f507bcffba3d55c13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77d9df27308e186f507bcffba3d55c13">&#9670;&nbsp;</a></span>newJb()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classoops_1_1CostJbState.html">CostJbState</a>&lt;MODEL&gt;* <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::newJb </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create the \(J_b, J_q\) term of the cost function (virtual method) </p>

<p>Implemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#a04f6bd072f3ef8c7343b7f37fa160a92">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnVar.html#a0631bcf8b795ac4a2df36a0c0533970a">oops::CostFct4DEnVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnsVar.html#ac7e3d9297296664e8ed7147ae96e74c9">oops::CostFct4DEnsVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFctWeak.html#a192a2620791d05a7a331286e280a065f">oops::CostFctWeak&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVarHyb4D.html#a3fca76d0745f75868e4655d257b0480d">oops::CostFct4DVarHyb4D&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVar.html#ae3787592a57ec9dc8b68254f01dac3d2">oops::CostFct4DVar&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct3DVar.html#a8abfb0cc035135ca712a2652a8d61f9d">oops::CostFct3DVar&lt; MODEL &gt;</a>.</p>

</div>
</div>
<a id="aed46ad6149d43bbb7f9f1e4e1c5677b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed46ad6149d43bbb7f9f1e4e1c5677b5">&#9670;&nbsp;</a></span>newJc()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classoops_1_1CostTermBase.html">CostTermBase</a>&lt;MODEL&gt;* <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::newJc </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create other terms of the cost function \(J_c, ..\) (virtual method) </p>

<p>Implemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#a9ca018efacd9937691aeb3c0ef11437b">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnVar.html#aad99bd26693b60cc6965e88013ccb0cb">oops::CostFct4DEnVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnsVar.html#a2e8254b44a1882541df2dbabbab75b83">oops::CostFct4DEnsVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFctWeak.html#a5a10cb6cd4f1b1d17d6538a43cc7ae0f">oops::CostFctWeak&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVar.html#af7d80cce188c6f141e73b835bae8ad0f">oops::CostFct4DVar&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct3DVar.html#ab42f283037e9e856da29138814bf865a">oops::CostFct3DVar&lt; MODEL &gt;</a>.</p>

</div>
</div>
<a id="ad2c9c1bf8905241260af5738cfc278e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c9c1bf8905241260af5738cfc278e4">&#9670;&nbsp;</a></span>newJo()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classoops_1_1CostJo.html">CostJo</a>&lt;MODEL&gt;* <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::newJo </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create the \(J_o\) term of the cost function (virtual method) </p>

<p>Implemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#aaba80d0b3bc8a445baec940d341a9966">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnVar.html#a0df89d89aebfa3843ba7e91499d71710">oops::CostFct4DEnVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnsVar.html#ac80b272c1ddc253e9d8763eeedfd8455">oops::CostFct4DEnsVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFctWeak.html#ab9689871f9ccd2658dd47014e691ad99">oops::CostFctWeak&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVar.html#a97473dd1843d5f62a0f2a52375ada15a">oops::CostFct4DVar&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct3DVar.html#ae344f52d7e6b4d1fe2d252d6c82a0b7c">oops::CostFct3DVar&lt; MODEL &gt;</a>.</p>

</div>
</div>
<a id="a3acfb71d2502722de8f248bcbe1cf13f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acfb71d2502722de8f248bcbe1cf13f">&#9670;&nbsp;</a></span>nterms()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::nterms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the numer of other cost function terms \(J_o, J_c, ..\). </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00153">153</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>.size(); }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00208">oops::CostFunction&lt; MODEL &gt;::jterms_</a>.</p>

<p class="reference">Referenced by <a class="el" href="RinvMatrix_8h_source.html#l00037">oops::RinvMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="HtMatrix_8h_source.html#l00041">oops::HtMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="HMatrix_8h_source.html#l00042">oops::HMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="LBHessianMatrix_8h_source.html#l00049">oops::LBHessianMatrix&lt; MODEL &gt;::multiply()</a>, and <a class="el" href="RMatrix_8h_source.html#l00036">oops::RMatrix&lt; MODEL &gt;::multiplyInv()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a3acfb71d2502722de8f248bcbe1cf13f_icgraph.png" border="0" usemap="#classoops_1_1CostFunction_a3acfb71d2502722de8f248bcbe1cf13f_icgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a3acfb71d2502722de8f248bcbe1cf13f_icgraph" id="classoops_1_1CostFunction_a3acfb71d2502722de8f248bcbe1cf13f_icgraph">
<area shape="rect" title="Return the numer of other cost function terms ." alt="" coords="453,180,587,221"/>
<area shape="rect" href="classoops_1_1RinvMatrix.html#a61e4a71018eb143d440784f17cf08fca" title=" " alt="" coords="238,78,405,105"/>
<area shape="rect" href="classoops_1_1HtMatrix.html#aed0d6981224f758c2b8db11ad5abdbff" title=" " alt="" coords="244,187,399,214"/>
<area shape="rect" href="classoops_1_1HMatrix.html#ac6c2bd6065dfd5fed26a62d22293a2b7" title=" " alt="" coords="246,137,397,163"/>
<area shape="rect" href="classoops_1_1LBHessianMatrix.html#ab1306ed7701729b87c281ea542a45591" title=" " alt="" coords="243,239,399,280"/>
<area shape="rect" href="classoops_1_1RMatrix.html#a1c28c930f287bead69c3d30590a8233f" title=" " alt="" coords="237,305,405,331"/>
<area shape="rect" href="classoops_1_1RPCGMinimizer.html#a64cb89d1a2f7b0946b3b727cae38f1ba" title=" " alt="" coords="23,5,171,47"/>
<area shape="rect" href="classoops_1_1RPLanczosMinimizer.html#a7fe11fbe0bfaec3af4212f5411610e18" title=" " alt="" coords="8,71,187,112"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a02f86245f08d74a4e09111ae2c8fc443" title="Perform observation operator adjoint tests." alt="" coords="5,137,189,163"/>
<area shape="rect" href="classoops_1_1DualMinimizer.html#a3cf6d56e66d48c5aa41d9c1f7d5a4237" title="Minimizer the quadratic cost function (virtual method)" alt="" coords="29,188,166,229"/>
</map>
</div>

</div>
</div>
<a id="ab990f92a2ee09606884854e35ca67024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab990f92a2ee09606884854e35ca67024">&#9670;&nbsp;</a></span>recentreBackground()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::recentreBackground </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>conf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Re-centre the background. </p>
<p>This method is re-centres the background</p>
<p>Setup re-centring increment</p>
<p>Re-centre the background</p>
<p>Write out re-centred background (optional)</p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00626">626</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                                                           {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::recentreBackground start&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  Log::info() &lt;&lt; <span class="stringliteral">&quot;CostFunction::recentreBackground enabled&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> bkgRecResol(conf.getSubConfiguration(<span class="stringliteral">&quot;resolution&quot;</span>));</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a2c01c1ef5e61f796ebb794da4854e678">Variables_</a> bkgRecVars(conf);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  util::DateTime bkgRecValidTime(<a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>-&gt;state()[0].validTime());</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> bkgRecIncr(bkgRecResol, bkgRecVars, bkgRecValidTime);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  bkgRecIncr.read(conf.getSubConfiguration(<span class="stringliteral">&quot;increment&quot;</span>));</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>-&gt;state()[0] += bkgRecIncr;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordflow">if</span> (conf.has(<span class="stringliteral">&quot;writeOutRecentredBackground&quot;</span>)) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>-&gt;state().write(conf.getSubConfiguration(<span class="stringliteral">&quot;writeOutRecentredBackground&quot;</span>));</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::recentreBackground done&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="oops_2interface_2Increment_8h_source.html#l00374">oops::Increment&lt; MODEL &gt;::read()</a>, and <a class="el" href="oops_2interface_2Increment_8h_source.html#l00384">oops::Increment&lt; MODEL &gt;::write()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_ab990f92a2ee09606884854e35ca67024_cgraph.png" border="0" usemap="#classoops_1_1CostFunction_ab990f92a2ee09606884854e35ca67024_cgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_ab990f92a2ee09606884854e35ca67024_cgraph" id="classoops_1_1CostFunction_ab990f92a2ee09606884854e35ca67024_cgraph">
<area shape="rect" title="Re&#45;centre the background." alt="" coords="5,23,149,65"/>
<area shape="rect" href="classoops_1_1Increment.html#a06adc333289ac7abcc118fc42bbb64b8" title="Read increment." alt="" coords="199,5,344,32"/>
<area shape="rect" href="classoops_1_1Increment.html#abf4010d338c2e9a81c799a412ab5d858" title="Write increment." alt="" coords="197,56,345,83"/>
</map>
</div>

</div>
</div>
<a id="a0a07f5c960d0817c5ca8e7a79177fe64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a07f5c960d0817c5ca8e7a79177fe64">&#9670;&nbsp;</a></span>reduceMemoryFootprint()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const bool&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::reduceMemoryFootprint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reduce memory footprit (for multi-executable mode only) </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00198">198</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classoops_1_1CostFunction.html#a15724d3056157931dcd2cb70b4a6b209">lreduceMemoryFootprint_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00214">oops::CostFunction&lt; MODEL &gt;::lreduceMemoryFootprint_</a>.</p>

</div>
</div>
<a id="ae129b06da634ee7e791d55199400d933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae129b06da634ee7e791d55199400d933">&#9670;&nbsp;</a></span>resetLinearization()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::resetLinearization</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rest the quadratic cost function. </p>
<p>This method resets the linearization of the non-linear cost function Reset Jb</p>
<p>Reset Jo, Jc</p>
<p>Reset linearization trajectory</p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00653">653</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                             {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classoops_1_1CostFunction.html#a0a07f5c960d0817c5ca8e7a79177fe64">reduceMemoryFootprint</a>()) <a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>.reset();</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a489d579a9a8e9d9c7a45dc4c00e79984">resetLinearization</a>();</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classoops_1_1CostFunction.html#a0a07f5c960d0817c5ca8e7a79177fe64">reduceMemoryFootprint</a>()) <a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>.reset();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a38fbe386f4b433a386032c1a1fcabd87">tlm_</a>.clear();</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d91975ee9b053fc7d69a376e3c2aa29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d91975ee9b053fc7d69a376e3c2aa29">&#9670;&nbsp;</a></span>restart()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::restart </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>conf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restart. </p>
<p>This method is restarting the terms of the cost function</p>
<ol type="1">
<li>Call the restart method of \(J_o, J_c , .. \)</li>
</ol>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00682">682</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                                                {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> : <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a>-&gt;<a class="code" href="classoops_1_1CostTermBase.html#a51b6ad3c71d01a486b58bd50b8403550">restart</a>(conf);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e40a4b04c5c45124eb166fb5406cb32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e40a4b04c5c45124eb166fb5406cb32">&#9670;&nbsp;</a></span>runAD()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::runAD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessorAD.html">PostProcessorAD</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em> = <code><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt;&#160;<a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a>&#160;&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>idModel</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classoops_1_1Run.html">Run</a> the adjoint model (virtual method) </p>

<p>Implemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#a7c01adda989aca82e5c50fc6e82f6f5b">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnVar.html#a07778f7062813960eb0861504f49f941">oops::CostFct4DEnVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnsVar.html#a2d19d9c4ef6309ee95b51f3602e80e32">oops::CostFct4DEnsVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVarHyb4D.html#a1d0fd0cc40459ffbaa786428ec93707e">oops::CostFct4DVarHyb4D&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVar.html#a86be57274afa9df9edeb76281ce62cc9">oops::CostFct4DVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFctWeak.html#aad51ce281b40be8c5feef2c34e816230">oops::CostFctWeak&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct3DVar.html#a25c9fcc0140f32c467abf75183832d44">oops::CostFct3DVar&lt; MODEL &gt;</a>.</p>

<p class="reference">Referenced by <a class="el" href="HtMatrix_8h_source.html#l00041">oops::HtMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="MtMatrix_8h_source.html#l00041">oops::MtMatrix&lt; MODEL &gt;::multiply()</a>, and <a class="el" href="LBHessianMatrix_8h_source.html#l00049">oops::LBHessianMatrix&lt; MODEL &gt;::multiply()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a3e40a4b04c5c45124eb166fb5406cb32_icgraph.png" border="0" usemap="#classoops_1_1CostFunction_a3e40a4b04c5c45124eb166fb5406cb32_icgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a3e40a4b04c5c45124eb166fb5406cb32_icgraph" id="classoops_1_1CostFunction_a3e40a4b04c5c45124eb166fb5406cb32_icgraph">
<area shape="rect" title="Run the adjoint model (virtual method)" alt="" coords="452,111,585,153"/>
<area shape="rect" href="classoops_1_1HtMatrix.html#aed0d6981224f758c2b8db11ad5abdbff" title=" " alt="" coords="249,64,403,91"/>
<area shape="rect" href="classoops_1_1MtMatrix.html#ac0325ff39f9eaeba5ed10eef946af2b9" title=" " alt="" coords="248,119,404,145"/>
<area shape="rect" href="classoops_1_1LBHessianMatrix.html#ab1306ed7701729b87c281ea542a45591" title=" " alt="" coords="248,170,404,211"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a02f86245f08d74a4e09111ae2c8fc443" title="Perform observation operator adjoint tests." alt="" coords="11,5,195,32"/>
<area shape="rect" href="classoops_1_1DualMinimizer.html#a3cf6d56e66d48c5aa41d9c1f7d5a4237" title="Minimizer the quadratic cost function (virtual method)" alt="" coords="34,57,171,98"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a81f3d301ce34beba4a23bdb57a3f497e" title="Perform model adjoint tests." alt="" coords="5,123,200,149"/>
</map>
</div>

</div>
</div>
<a id="a153033622acd13037540d9fed73d4924"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a153033622acd13037540d9fed73d4924">&#9670;&nbsp;</a></span>runNL() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::runNL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt; &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model (virtual method) </p>

<p>Implemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#a0a055420c35897c7454be260b8050d9c">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnVar.html#a499bc216ee13afecab0bfcf92223e0bf">oops::CostFct4DEnVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnsVar.html#a9f9ac24e0e56fac9ad2e961e5340a73f">oops::CostFct4DEnsVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFctWeak.html#ae52f9b20b1e54ccf28e7c0e3dcfe7d51">oops::CostFctWeak&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVar.html#a11cc4b2eda793d2c5c087533413dfe72">oops::CostFct4DVar&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct3DVar.html#adb9783822b134c0812682c01cfe90119">oops::CostFct3DVar&lt; MODEL &gt;</a>.</p>

</div>
</div>
<a id="ad378d566ae9c105bef1ab7c9206369ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad378d566ae9c105bef1ab7c9206369ba">&#9670;&nbsp;</a></span>runNL() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::runNL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#a11d9d0debd0a09669bff809d6516babc">State_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>pp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model (virtual method) </p>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#a726c80052c3e5de960985b7fa9989564">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00122">122</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                                                              {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    ASSERT(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad83281587aa637c33be0f28fc30373be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83281587aa637c33be0f28fc30373be">&#9670;&nbsp;</a></span>runTL()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::runTL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessorTL.html">PostProcessorTL</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em> = <code><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt;&#160;<a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a>&#160;&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>idModel</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classoops_1_1Run.html">Run</a> the tangent linear model (virtual method) </p>

<p>Implemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#a53f0d794bda3d9004e4efcbddf8d3b40">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnVar.html#a64ca0ad240fd595a8ff2c21c38a0178f">oops::CostFct4DEnVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnsVar.html#a558d17bdd57a5446891e008550b859ad">oops::CostFct4DEnsVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVar.html#a255956426f19a9efbd7d397fd25ced65">oops::CostFct4DVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVarHyb4D.html#a8ee0b65a7052b5b5f55e41ed8a3736c1">oops::CostFct4DVarHyb4D&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFctWeak.html#a5f1f96a40ba1fa777a7c800fa90d32d8">oops::CostFctWeak&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct3DVar.html#af14ee890e1cf09dab1f60c5eba00c47c">oops::CostFct3DVar&lt; MODEL &gt;</a>.</p>

<p class="reference">Referenced by <a class="el" href="MMatrix_8h_source.html#l00041">oops::MMatrix&lt; MODEL &gt;::multiply()</a>, <a class="el" href="HMatrix_8h_source.html#l00042">oops::HMatrix&lt; MODEL &gt;::multiply()</a>, and <a class="el" href="LBHessianMatrix_8h_source.html#l00049">oops::LBHessianMatrix&lt; MODEL &gt;::multiply()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_ad83281587aa637c33be0f28fc30373be_icgraph.png" border="0" usemap="#classoops_1_1CostFunction_ad83281587aa637c33be0f28fc30373be_icgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_ad83281587aa637c33be0f28fc30373be_icgraph" id="classoops_1_1CostFunction_ad83281587aa637c33be0f28fc30373be_icgraph">
<area shape="rect" title="Run the tangent linear model (virtual method)" alt="" coords="460,201,593,242"/>
<area shape="rect" href="classoops_1_1MMatrix.html#ac2f50ca3a7254d320fba6eae315b292a" title=" " alt="" coords="258,107,410,133"/>
<area shape="rect" href="classoops_1_1HMatrix.html#ac6c2bd6065dfd5fed26a62d22293a2b7" title=" " alt="" coords="259,208,409,235"/>
<area shape="rect" href="classoops_1_1LBHessianMatrix.html#ab1306ed7701729b87c281ea542a45591" title=" " alt="" coords="256,259,412,301"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a81f3d301ce34beba4a23bdb57a3f497e" title="Perform model adjoint tests." alt="" coords="9,5,204,32"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a9085af3b9da16b8aa96d38dae8c3ccb8" title="Perform tangent linear model approximation test." alt="" coords="6,56,207,83"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a79eb945247f2f60cf8b2c9ca4b298357" title="Peroform the tangent linear propagation test." alt="" coords="5,107,208,133"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a8aa8f4456592a53498288825809bfda9" title="Perform the Tayolor test." alt="" coords="9,157,205,184"/>
<area shape="rect" href="classoops_1_1Minimizer.html#a02f86245f08d74a4e09111ae2c8fc443" title="Perform observation operator adjoint tests." alt="" coords="15,208,199,235"/>
<area shape="rect" href="classoops_1_1DualMinimizer.html#a3cf6d56e66d48c5aa41d9c1f7d5a4237" title="Minimizer the quadratic cost function (virtual method)" alt="" coords="38,259,175,301"/>
</map>
</div>

</div>
</div>
<a id="a56903c9685b92ca9ca3fe86fef575b75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56903c9685b92ca9ca3fe86fef575b75">&#9670;&nbsp;</a></span>setupTerms()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::setupTerms </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set up terms of the cost function \(J_b, J_q, J_o, J_c, ..\). </p>
<p>This method sets up the terms of the non-linear cost function</p><ol type="1">
<li>\(J_o\)</li>
<li>\(J_b\)</li>
<li>Set the background in the \(J_o\) term MC: \(J_b\) requires the \(J_o\) term to setup the observation space first in order to initialize observation space components</li>
<li>Other constraints: \(J_c, ..\)</li>
</ol>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00317">317</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                                                     {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::setupTerms starting&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  eckit::LocalConfiguration joConf(config, <span class="stringliteral">&quot;Jo&quot;</span>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  CostJo&lt;MODEL&gt; *jo = this-&gt;<a class="code" href="classoops_1_1CostFunction.html#ad2c9c1bf8905241260af5738cfc278e4">newJo</a>(joConf);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>.emplace_back(jo);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction: setupTerms Jo added&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keyword">const</span> eckit::LocalConfiguration jbConf(config, <span class="stringliteral">&quot;Jb&quot;</span>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a>(config, <a class="code" href="classoops_1_1CostFunction.html#aaddfbe90cc0f32e1754f744c254da9e7">resol_</a>, <a class="code" href="classoops_1_1CostFunction.html#aec874cb9c52b7bcd3c608b37cf59ee2b">model_</a>, jo-&gt;obspaces()));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">if</span> (jbConf.has(<span class="stringliteral">&quot;RecentreBackground&quot;</span>))</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    this-&gt;<a class="code" href="classoops_1_1CostFunction.html#ab990f92a2ee09606884854e35ca67024">recentreBackground</a>(jbConf.getSubConfiguration(<span class="stringliteral">&quot;RecentreBackground&quot;</span>));</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">jb_</a>.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a>(*<a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>, this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a77d9df27308e186f507bcffba3d55c13">newJb</a>(jbConf, <a class="code" href="classoops_1_1CostFunction.html#aaddfbe90cc0f32e1754f744c254da9e7">resol_</a>, *<a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>), config,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                         <a class="code" href="classoops_1_1CostFunction.html#aaddfbe90cc0f32e1754f744c254da9e7">resol_</a>, jo-&gt;obspaces()));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::setupTerms Jb added&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  jo-&gt;setBackground(*<a class="code" href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">xb_</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  std::vector&lt;eckit::LocalConfiguration&gt; jcs;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  config.get(<span class="stringliteral">&quot;Jc&quot;</span>, jcs);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jj = 0; jj &lt; jcs.size(); ++jj) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    CostTermBase&lt;MODEL&gt; *jc = this-&gt;<a class="code" href="classoops_1_1CostFunction.html#aed46ad6149d43bbb7f9f1e4e1c5677b5">newJc</a>(jcs[jj], <a class="code" href="classoops_1_1CostFunction.html#aaddfbe90cc0f32e1754f744c254da9e7">resol_</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">jterms_</a>.emplace_back(jc);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFunction::setupTerms done&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostJo_8h_source.html#l00301">oops::CostJo&lt; MODEL &gt;::obspaces()</a>, and <a class="el" href="CostJo_8h_source.html#l00310">oops::CostJo&lt; MODEL &gt;::setBackground()</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFct3DVar_8h_source.html#l00091">oops::CostFct3DVar&lt; MODEL &gt;::CostFct3DVar()</a>, <a class="el" href="CostFct4DEnsVar_8h_source.html#l00099">oops::CostFct4DEnsVar&lt; MODEL &gt;::CostFct4DEnsVar()</a>, <a class="el" href="CostFct4DEnVar_8h_source.html#l00100">oops::CostFct4DEnVar&lt; MODEL &gt;::CostFct4DEnVar()</a>, <a class="el" href="CostFct4DVar_8h_source.html#l00091">oops::CostFct4DVar&lt; MODEL &gt;::CostFct4DVar()</a>, <a class="el" href="CostFct4DVarHyb4D_8h_source.html#l00091">oops::CostFct4DVarHyb4D&lt; MODEL &gt;::CostFct4DVarHyb4D()</a>, <a class="el" href="CostFct4DVarMF_8h_source.html#l00047">oops::CostFct4DVarMF&lt; MODEL &gt;::CostFct4DVarMF()</a>, <a class="el" href="CostFct4DVarTrajHR_8h_source.html#l00105">oops::CostFct4DVarTrajHR&lt; MODEL &gt;::CostFct4DVarTrajHR()</a>, and <a class="el" href="CostFctWeak_8h_source.html#l00096">oops::CostFctWeak&lt; MODEL &gt;::CostFctWeak()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a56903c9685b92ca9ca3fe86fef575b75_cgraph.png" border="0" usemap="#classoops_1_1CostFunction_a56903c9685b92ca9ca3fe86fef575b75_cgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a56903c9685b92ca9ca3fe86fef575b75_cgraph" id="classoops_1_1CostFunction_a56903c9685b92ca9ca3fe86fef575b75_cgraph">
<area shape="rect" title="Set up terms of the cost function ." alt="" coords="5,23,139,65"/>
<area shape="rect" href="classoops_1_1CostJo.html#a6fc72d99578f3d4ce6244e520c25c905" title="Access observation spaces." alt="" coords="203,5,361,32"/>
<area shape="rect" href="classoops_1_1CostJo.html#a3e8ca24a08b0dfc2e3ff9c280036d701" title="Set xb." alt="" coords="187,56,377,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a56903c9685b92ca9ca3fe86fef575b75_icgraph.png" border="0" usemap="#classoops_1_1CostFunction_a56903c9685b92ca9ca3fe86fef575b75_icgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a56903c9685b92ca9ca3fe86fef575b75_icgraph" id="classoops_1_1CostFunction_a56903c9685b92ca9ca3fe86fef575b75_icgraph">
<area shape="rect" title="Set up terms of the cost function ." alt="" coords="232,235,365,276"/>
<area shape="rect" href="classoops_1_1CostFct3DVar.html#add718edb36dcbfe49bd53ee7978fec01" title=" " alt="" coords="25,5,164,47"/>
<area shape="rect" href="classoops_1_1CostFct4DEnsVar.html#a3b71cf4237b3bf184c12c90ed1e6dc19" title=" " alt="" coords="15,71,175,112"/>
<area shape="rect" href="classoops_1_1CostFct4DEnVar.html#af8b24926b76bf40cdd2bf55609d56865" title=" " alt="" coords="18,136,171,177"/>
<area shape="rect" href="classoops_1_1CostFct4DVar.html#a341f247d7dec1f1b9fcc8c84be0d3848" title=" " alt="" coords="25,201,164,243"/>
<area shape="rect" href="classoops_1_1CostFct4DVarHyb4D.html#a4105bbbf37cf52c90bdd633c6393bcde" title=" " alt="" coords="6,267,183,308"/>
<area shape="rect" href="classoops_1_1CostFct4DVarMF.html#ab4f24724380c63316f0762991693dc9c" title=" " alt="" coords="16,332,173,373"/>
<area shape="rect" href="classoops_1_1CostFct4DVarTrajHR.html#ac792fc9372e84a55787ccb4a633c151a" title=" " alt="" coords="5,397,184,439"/>
<area shape="rect" href="classoops_1_1CostFctWeak.html#a79784acbe7e9b26ee319ad9450bd1a66" title=" " alt="" coords="24,463,165,504"/>
</map>
</div>

</div>
</div>
<a id="a04e734ad4bf35fec87331ba5bddf4cb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04e734ad4bf35fec87331ba5bddf4cb0">&#9670;&nbsp;</a></span>zeroAD()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::zeroAD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Nullify the increment prior to running the adjoint model (virtual method) </p>

<p>Implemented in <a class="el" href="classoops_1_1CostFct4DVarMFTemplate.html#af3d820f542c7e7efcf9077c0cd51bc40">oops::CostFct4DVarMFTemplate&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnVar.html#ab8ab3c4c17548d58e9bc1c019cb9c8ca">oops::CostFct4DEnVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DEnsVar.html#a05dc3bd773eea41c9020516969ae1521">oops::CostFct4DEnsVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVarHyb4D.html#a8b82cdff88fad46270770e48b0b93bbc">oops::CostFct4DVarHyb4D&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFct4DVar.html#af5d49e520c1f209c11ad72f71d77ab70">oops::CostFct4DVar&lt; MODEL &gt;</a>, <a class="el" href="classoops_1_1CostFctWeak.html#af2528021a32daa75c8d530a33022dc07">oops::CostFctWeak&lt; MODEL &gt;</a>, and <a class="el" href="classoops_1_1CostFct3DVar.html#a8297e39b7b9d8b8be837612ae8d350f3">oops::CostFct3DVar&lt; MODEL &gt;</a>.</p>

<p class="reference">Referenced by <a class="el" href="LBHessianMatrix_8h_source.html#l00049">oops::LBHessianMatrix&lt; MODEL &gt;::multiply()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFunction_a04e734ad4bf35fec87331ba5bddf4cb0_icgraph.png" border="0" usemap="#classoops_1_1CostFunction_a04e734ad4bf35fec87331ba5bddf4cb0_icgraph" alt=""/></div>
<map name="classoops_1_1CostFunction_a04e734ad4bf35fec87331ba5bddf4cb0_icgraph" id="classoops_1_1CostFunction_a04e734ad4bf35fec87331ba5bddf4cb0_icgraph">
<area shape="rect" title="Nullify the increment prior to running the adjoint model (virtual method)" alt="" coords="209,5,343,47"/>
<area shape="rect" href="classoops_1_1LBHessianMatrix.html#ab1306ed7701729b87c281ea542a45591" title=" " alt="" coords="5,5,161,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae581e1982c3a9f74b883e44061db62dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae581e1982c3a9f74b883e44061db62dc">&#9670;&nbsp;</a></span>costJb_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::costJb_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00216">216</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFunction_8h_source.html#l00156">oops::CostFunction&lt; MODEL &gt;::getCostJb()</a>.</p>

</div>
</div>
<a id="a7c6bdd6279edd267221f07bb03c81537"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6bdd6279edd267221f07bb03c81537">&#9670;&nbsp;</a></span>costJoJc_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::costJoJc_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00217">217</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFunction_8h_source.html#l00159">oops::CostFunction&lt; MODEL &gt;::getCostJoJc()</a>.</p>

</div>
</div>
<a id="a4a63c4c712517bc7ecac58fcab96506c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a63c4c712517bc7ecac58fcab96506c">&#9670;&nbsp;</a></span>jb_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a>&gt; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::jb_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>\(J_b, J_q\) term of the cost function </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00206">206</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFunction_8h_source.html#l00177">oops::CostFunction&lt; MODEL &gt;::getJb()</a>, and <a class="el" href="CostFunction_8h_source.html#l00147">oops::CostFunction&lt; MODEL &gt;::jb()</a>.</p>

</div>
</div>
<a id="ab0596bc90edb45c461df3aedd6785b85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0596bc90edb45c461df3aedd6785b85">&#9670;&nbsp;</a></span>jterms_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a>&gt; &gt; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::jterms_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>\(J_o, J_c, ..\) terms of the cost function </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00208">208</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFunction_8h_source.html#l00174">oops::CostFunction&lt; MODEL &gt;::getJterm()</a>, <a class="el" href="CostFunction_8h_source.html#l00150">oops::CostFunction&lt; MODEL &gt;::jterm()</a>, and <a class="el" href="CostFunction_8h_source.html#l00153">oops::CostFunction&lt; MODEL &gt;::nterms()</a>.</p>

</div>
</div>
<a id="a15724d3056157931dcd2cb70b4a6b209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15724d3056157931dcd2cb70b4a6b209">&#9670;&nbsp;</a></span>lreduceMemoryFootprint_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::lreduceMemoryFootprint_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reduce memory footprint (only in multi-executable mode) </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00214">214</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFunction_8h_source.html#l00198">oops::CostFunction&lt; MODEL &gt;::reduceMemoryFootprint()</a>.</p>

</div>
</div>
<a id="aec874cb9c52b7bcd3c608b37cf59ee2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec874cb9c52b7bcd3c608b37cf59ee2b">&#9670;&nbsp;</a></span>model_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a>&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::model_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Non-linear model. </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00202">202</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFunction_8h_source.html#l00165">oops::CostFunction&lt; MODEL &gt;::getModel()</a>.</p>

</div>
</div>
<a id="aaddfbe90cc0f32e1754f744c254da9e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaddfbe90cc0f32e1754f744c254da9e7">&#9670;&nbsp;</a></span>resol_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a>&amp; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::resol_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Outer-loop geometry. </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00201">201</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<a id="a38fbe386f4b433a386032c1a1fcabd87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38fbe386f4b433a386032c1a1fcabd87">&#9670;&nbsp;</a></span>tlm_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a>&gt; &gt; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::tlm_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Linear model (includes trajectory) </p>
<p>Tangent-linear model </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00211">211</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFunction_8h_source.html#l00167">oops::CostFunction&lt; MODEL &gt;::getTLM()</a>, and <a class="el" href="CostFunction_8h_source.html#l00180">oops::CostFunction&lt; MODEL &gt;::getTLMs()</a>.</p>

</div>
</div>
<a id="a565b1faee3abb359e4d4932a105e03a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a565b1faee3abb359e4d4932a105e03a4">&#9670;&nbsp;</a></span>xb_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a>&gt; <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction</a>&lt; MODEL &gt;::xb_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Terms of the cost function. </p>
<p>Background control variable </p>

<p class="definition">Definition at line <a class="el" href="CostFunction_8h_source.html#l00205">205</a> of file <a class="el" href="CostFunction_8h_source.html">CostFunction.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/oops/assimilation/<a class="el" href="CostFunction_8h_source.html">CostFunction.h</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclassoops_1_1CostFunction_html_ae581e1982c3a9f74b883e44061db62dc"><div class="ttname"><a href="classoops_1_1CostFunction.html#ae581e1982c3a9f74b883e44061db62dc">oops::CostFunction::costJb_</a></div><div class="ttdeci">double costJb_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00216">CostFunction.h:216</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_aed46ad6149d43bbb7f9f1e4e1c5677b5"><div class="ttname"><a href="classoops_1_1CostFunction.html#aed46ad6149d43bbb7f9f1e4e1c5677b5">oops::CostFunction::newJc</a></div><div class="ttdeci">virtual CostTermBase&lt; MODEL &gt; * newJc(const eckit::Configuration &amp;, const Geometry_ &amp;) const =0</div><div class="ttdoc">Create other terms of the cost function  (virtual method)</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a4dee360528ce876c3d1e4b7f217b802a"><div class="ttname"><a href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">oops::CostFunction::jterm</a></div><div class="ttdeci">const CostBase_ &amp; jterm(const unsigned ii) const</div><div class="ttdoc">Access terms of the cost function other than .</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00150">CostFunction.h:150</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_aaddfbe90cc0f32e1754f744c254da9e7"><div class="ttname"><a href="classoops_1_1CostFunction.html#aaddfbe90cc0f32e1754f744c254da9e7">oops::CostFunction::resol_</a></div><div class="ttdeci">const Geometry_ &amp; resol_</div><div class="ttdoc">Outer-loop geometry.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00201">CostFunction.h:201</a></div></div>
<div class="ttc" id="aclassoops_1_1CostJbTotal_html_a469c194404e7346e95b9147bda3a5600"><div class="ttname"><a href="classoops_1_1CostJbTotal.html#a469c194404e7346e95b9147bda3a5600">oops::CostJbTotal::multiplyBsqrt</a></div><div class="ttdeci">void multiplyBsqrt(const CtrlVec_ &amp;, CtrlInc_ &amp;) const</div><div class="ttdoc">Multiply by the square root of the covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="CostJbTotal_8h_source.html#l00498">CostJbTotal.h:498</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a0179c6c57603aaf9b2d193ed189c2a52"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a0179c6c57603aaf9b2d193ed189c2a52">oops::CostTermBase::initializeTraj</a></div><div class="ttdeci">virtual PostPtr_ initializeTraj(const ControlVariable&lt; MODEL &gt; &amp;, const Geometry_ &amp;, const eckit::Configuration &amp;)=0</div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a0e7d83cef3fb9932a98736aad9e78a7d"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a0e7d83cef3fb9932a98736aad9e78a7d">oops::CostTermBase::multiplyCoInv</a></div><div class="ttdeci">virtual GeneralizedDepartures * multiplyCoInv(const GeneralizedDepartures &amp;) const =0</div><div class="ttdoc">Multiply by inverse covariance (or weight) matrix.</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_ab0596bc90edb45c461df3aedd6785b85"><div class="ttname"><a href="classoops_1_1CostFunction.html#ab0596bc90edb45c461df3aedd6785b85">oops::CostFunction::jterms_</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; CostBase_ &gt; &gt; jterms_</div><div class="ttdoc">terms of the cost function</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00208">CostFunction.h:208</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a1784037bdc70348117f81b08913e8168"><div class="ttname"><a href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">oops::CostFunction::Geometry_</a></div><div class="ttdeci">Geometry&lt; MODEL &gt; Geometry_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00076">CostFunction.h:76</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a3e40a4b04c5c45124eb166fb5406cb32"><div class="ttname"><a href="classoops_1_1CostFunction.html#a3e40a4b04c5c45124eb166fb5406cb32">oops::CostFunction::runAD</a></div><div class="ttdeci">virtual void runAD(CtrlInc_ &amp;, PostProcessorAD&lt; Increment_ &gt; &amp;, PostProcessor&lt; Increment_ &gt; post=PostProcessor&lt; Increment_ &gt;(), const bool idModel=false) const =0</div><div class="ttdoc">Run the adjoint model (virtual method)</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a31214b40b102ae7965c54354ec6cce45"><div class="ttname"><a href="classoops_1_1CostFunction.html#a31214b40b102ae7965c54354ec6cce45">oops::CostFunction::jb</a></div><div class="ttdeci">const JbTotal_ &amp; jb() const</div><div class="ttdoc">Access .</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00147">CostFunction.h:147</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a7de1981a3da6b9c391406999d6c4ef36"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a7de1981a3da6b9c391406999d6c4ef36">oops::CostTermBase::setupAD</a></div><div class="ttdeci">virtual PostADPtr_ setupAD(std::shared_ptr&lt; const GeneralizedDepartures &gt;, ControlIncrement&lt; MODEL &gt; &amp;) const =0</div><div class="ttdoc">Return a post-processor-ad to be attached to the AD run.</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a153033622acd13037540d9fed73d4924"><div class="ttname"><a href="classoops_1_1CostFunction.html#a153033622acd13037540d9fed73d4924">oops::CostFunction::runNL</a></div><div class="ttdeci">virtual void runNL(CtrlVar_ &amp;, PostProcessor&lt; State_ &gt; &amp;) const =0</div><div class="ttdoc">Run the non-linear model (virtual method)</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a7c6bdd6279edd267221f07bb03c81537"><div class="ttname"><a href="classoops_1_1CostFunction.html#a7c6bdd6279edd267221f07bb03c81537">oops::CostFunction::costJoJc_</a></div><div class="ttdeci">double costJoJc_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00217">CostFunction.h:217</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a77d9df27308e186f507bcffba3d55c13"><div class="ttname"><a href="classoops_1_1CostFunction.html#a77d9df27308e186f507bcffba3d55c13">oops::CostFunction::newJb</a></div><div class="ttdeci">virtual CostJbState&lt; MODEL &gt; * newJb(const eckit::Configuration &amp;, const Geometry_ &amp;, const CtrlVar_ &amp;) const =0</div><div class="ttdoc">Create the  term of the cost function (virtual method)</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a0a07f5c960d0817c5ca8e7a79177fe64"><div class="ttname"><a href="classoops_1_1CostFunction.html#a0a07f5c960d0817c5ca8e7a79177fe64">oops::CostFunction::reduceMemoryFootprint</a></div><div class="ttdeci">const bool &amp; reduceMemoryFootprint() const</div><div class="ttdoc">Reduce memory footprit (for multi-executable mode only)</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00198">CostFunction.h:198</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_ab990f92a2ee09606884854e35ca67024"><div class="ttname"><a href="classoops_1_1CostFunction.html#ab990f92a2ee09606884854e35ca67024">oops::CostFunction::recentreBackground</a></div><div class="ttdeci">void recentreBackground(const eckit::Configuration &amp;)</div><div class="ttdoc">Re-centre the background.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00626">CostFunction.h:626</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_aa1c5896acf77139e7185946114d26511"><div class="ttname"><a href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">oops::CostFunction::Increment_</a></div><div class="ttdeci">Increment&lt; MODEL &gt; Increment_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00077">CostFunction.h:77</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a04e734ad4bf35fec87331ba5bddf4cb0"><div class="ttname"><a href="classoops_1_1CostFunction.html#a04e734ad4bf35fec87331ba5bddf4cb0">oops::CostFunction::zeroAD</a></div><div class="ttdeci">virtual void zeroAD(CtrlInc_ &amp;) const =0</div><div class="ttdoc">Nullify the increment prior to running the adjoint model (virtual method)</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_ad2c9c1bf8905241260af5738cfc278e4"><div class="ttname"><a href="classoops_1_1CostFunction.html#ad2c9c1bf8905241260af5738cfc278e4">oops::CostFunction::newJo</a></div><div class="ttdeci">virtual CostJo&lt; MODEL &gt; * newJo(const eckit::Configuration &amp;) const =0</div><div class="ttdoc">Create the  term of the cost function (virtual method)</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a3acfb71d2502722de8f248bcbe1cf13f"><div class="ttname"><a href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">oops::CostFunction::nterms</a></div><div class="ttdeci">unsigned nterms() const</div><div class="ttdoc">Return the numer of other cost function terms .</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00153">CostFunction.h:153</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a38fbe386f4b433a386032c1a1fcabd87"><div class="ttname"><a href="classoops_1_1CostFunction.html#a38fbe386f4b433a386032c1a1fcabd87">oops::CostFunction::tlm_</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; LinearModel_ &gt; &gt; tlm_</div><div class="ttdoc">Linear model (includes trajectory)</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00211">CostFunction.h:211</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a8ad6ac0fa63b6a48f6d1e8a1196f3337"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a8ad6ac0fa63b6a48f6d1e8a1196f3337">oops::CostTermBase::newDepartures</a></div><div class="ttdeci">virtual GeneralizedDepartures * newDepartures() const =0</div><div class="ttdoc">Provide departures (for example a Departure for Jo).</div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a489d579a9a8e9d9c7a45dc4c00e79984"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a489d579a9a8e9d9c7a45dc4c00e79984">oops::CostTermBase::resetLinearization</a></div><div class="ttdeci">virtual void resetLinearization()=0</div><div class="ttdoc">Reset trajectory.</div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_aa5c45447869fb5399c7b58db121281dc"><div class="ttname"><a href="classoops_1_1CostTermBase.html#aa5c45447869fb5399c7b58db121281dc">oops::CostTermBase::newGradientFG</a></div><div class="ttdeci">virtual GeneralizedDepartures * newGradientFG() const =0</div><div class="ttdoc">Return gradient at first guess.</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_aaa1dda0ecd2e77753c2a3ffb0a4f0fa3"><div class="ttname"><a href="classoops_1_1CostFunction.html#aaa1dda0ecd2e77753c2a3ffb0a4f0fa3">oops::CostFunction::JqTerm_</a></div><div class="ttdeci">JqTerm&lt; MODEL &gt; JqTerm_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00079">CostFunction.h:79</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a9ee05b114f16bf79b51044fd6e5cc8f0"><div class="ttname"><a href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">oops::CostFunction::CtrlVar_</a></div><div class="ttdeci">ControlVariable&lt; MODEL &gt; CtrlVar_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00074">CostFunction.h:74</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a653aa78ac4ec1b64f33840e07f0f14ac"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a653aa78ac4ec1b64f33840e07f0f14ac">oops::CostTermBase::setupTL</a></div><div class="ttdeci">virtual PostTLPtr_ setupTL(const ControlIncrement&lt; MODEL &gt; &amp;) const =0</div><div class="ttdoc">Return a post-processor-tl to be attached to the TL run.</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a15724d3056157931dcd2cb70b4a6b209"><div class="ttname"><a href="classoops_1_1CostFunction.html#a15724d3056157931dcd2cb70b4a6b209">oops::CostFunction::lreduceMemoryFootprint_</a></div><div class="ttdeci">bool lreduceMemoryFootprint_</div><div class="ttdoc">Reduce memory footprint (only in multi-executable mode)</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00214">CostFunction.h:214</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a8ea88f1ea9ca655822d51aeb3b69162f"><div class="ttname"><a href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">oops::CostFunction::CtrlInc_</a></div><div class="ttdeci">ControlIncrement&lt; MODEL &gt; CtrlInc_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00073">CostFunction.h:73</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_aec874cb9c52b7bcd3c608b37cf59ee2b"><div class="ttname"><a href="classoops_1_1CostFunction.html#aec874cb9c52b7bcd3c608b37cf59ee2b">oops::CostFunction::model_</a></div><div class="ttdeci">const Model_ &amp; model_</div><div class="ttdoc">Non-linear model.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00202">CostFunction.h:202</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a4a63c4c712517bc7ecac58fcab96506c"><div class="ttname"><a href="classoops_1_1CostFunction.html#a4a63c4c712517bc7ecac58fcab96506c">oops::CostFunction::jb_</a></div><div class="ttdeci">std::unique_ptr&lt; JbTotal_ &gt; jb_</div><div class="ttdoc">term of the cost function</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00206">CostFunction.h:206</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a565b1faee3abb359e4d4932a105e03a4"><div class="ttname"><a href="classoops_1_1CostFunction.html#a565b1faee3abb359e4d4932a105e03a4">oops::CostFunction::xb_</a></div><div class="ttdeci">std::unique_ptr&lt; CtrlVar_ &gt; xb_</div><div class="ttdoc">Terms of the cost function.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00205">CostFunction.h:205</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a624eb63b5a3f81a75f392b7f15f8c9de"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a624eb63b5a3f81a75f392b7f15f8c9de">oops::CostTermBase::initialize</a></div><div class="ttdeci">virtual PostPtr_ initialize(const ControlVariable&lt; MODEL &gt; &amp;, const eckit::Configuration &amp;) const =0</div><div class="ttdoc">Return a post-processor to be attached to the non-linear model integration.</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a2c01c1ef5e61f796ebb794da4854e678"><div class="ttname"><a href="classoops_1_1CostFunction.html#a2c01c1ef5e61f796ebb794da4854e678">oops::CostFunction::Variables_</a></div><div class="ttdeci">Variables&lt; MODEL &gt; Variables_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00083">CostFunction.h:83</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a51b6ad3c71d01a486b58bd50b8403550"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a51b6ad3c71d01a486b58bd50b8403550">oops::CostTermBase::restart</a></div><div class="ttdeci">virtual void restart(const eckit::Configuration &amp;)=0</div><div class="ttdoc">Restart.</div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a7095b96873ca6a28738b2b25f5dae299"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a7095b96873ca6a28738b2b25f5dae299">oops::CostTermBase::checkpoint</a></div><div class="ttdeci">virtual void checkpoint(eckit::LocalConfiguration &amp;) const =0</div><div class="ttdoc">Checkpoint.</div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_ad83281587aa637c33be0f28fc30373be"><div class="ttname"><a href="classoops_1_1CostFunction.html#ad83281587aa637c33be0f28fc30373be">oops::CostFunction::runTL</a></div><div class="ttdeci">virtual void runTL(CtrlInc_ &amp;, PostProcessorTL&lt; Increment_ &gt; &amp;, PostProcessor&lt; Increment_ &gt; post=PostProcessor&lt; Increment_ &gt;(), const bool idModel=false) const =0</div><div class="ttdoc">Run the tangent linear model (virtual method)</div></div>
<div class="ttc" id="adot__product_8h_html_af0275315d135f0b993246c2ff4b1f40a"><div class="ttname"><a href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a></div><div class="ttdeci">double dot_product(const T &amp;x, const T &amp;y)</div><div class="ttdoc">Syntactic sugar to let us use a more mathematical notation for dot products.</div><div class="ttdef"><b>Definition:</b> <a href="dot__product_8h_source.html#l00017">dot_product.h:17</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a0c3eed43284eb0c7f12af9ecb738eba3"><div class="ttname"><a href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">oops::CostFunction::JbTotal_</a></div><div class="ttdeci">CostJbTotal&lt; MODEL &gt; JbTotal_</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00078">CostFunction.h:78</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_ac09a7ac7491959d035da33317c994c4e"><div class="ttname"><a href="classoops_1_1CostFunction.html#ac09a7ac7491959d035da33317c994c4e">oops::CostFunction::addIncr</a></div><div class="ttdeci">virtual void addIncr(CtrlVar_ &amp;, const CtrlInc_ &amp;, PostProcessor&lt; Increment_ &gt; &amp;) const =0</div><div class="ttdoc">Virtual method to add the increment to the state.</div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a57e653ebb4c983b00a50c6b7fa50b8aa"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a57e653ebb4c983b00a50c6b7fa50b8aa">oops::CostTermBase::finalize</a></div><div class="ttdeci">virtual double finalize(const eckit::Configuration &amp;) const =0</div><div class="ttdoc">Perform computations after nonlinear model integration.</div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a9978e5ad0a907e52ab609f26fc3b89e6"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a9978e5ad0a907e52ab609f26fc3b89e6">oops::CostTermBase::finalizeTraj</a></div><div class="ttdeci">virtual double finalizeTraj(const eckit::Configuration &amp;)=0</div><div class="ttdoc">Perform computation after the linearisation trajectory computation.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
