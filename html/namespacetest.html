<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OOPS Documentation: test Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OOPS Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">test Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ErrorCovariance</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ErrorCovarianceFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>Geometry</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>GeometryFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>GomTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>Increment</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>IncrementFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>IncrementTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>LinearModel</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>LinearModelFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>Localization</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>LocalizationFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>LocalizationMatrixFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>Locations</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>LocationsFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>LocsTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModBiasCovTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModBiasTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>Model</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModelAuxControl</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModelAuxControlFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModelAuxCovariance</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModelAuxCovarianceFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModelAuxIncrement</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModelAuxIncrementFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModelFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ModelTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsAuxControl</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsAuxControlFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsAuxCovariance</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsAuxCovarianceFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsAuxIncrement</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsAuxIncrementFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsBiasTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsErrorCovariance</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsErrorCovarianceFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObservationSpace</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObservationSpaceFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsTableTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsVecTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsVector</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ObsVectorFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>ResolutionTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>State</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>StateFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>StateTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>TestConfig</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>TestEnvironment</b></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">TestEnvironment is a singleton that defines the unit testing enviroment. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>TestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>TlmTestFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>Variables</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><b>VariablesFixture</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adfb577b9c0284083b93dc63def9e411c"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:adfb577b9c0284083b93dc63def9e411c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#adfb577b9c0284083b93dc63def9e411c">testErrorCovarianceZero</a> ()</td></tr>
<tr class="separator:adfb577b9c0284083b93dc63def9e411c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194d99e938e0d7b626319787003b8871"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a194d99e938e0d7b626319787003b8871"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a194d99e938e0d7b626319787003b8871">testErrorCovarianceInverse</a> ()</td></tr>
<tr class="separator:a194d99e938e0d7b626319787003b8871"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b80a6d456d44d7df67b9749aad0235e"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a5b80a6d456d44d7df67b9749aad0235e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a5b80a6d456d44d7df67b9749aad0235e">testErrorCovarianceSym</a> ()</td></tr>
<tr class="separator:a5b80a6d456d44d7df67b9749aad0235e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe93d1d3b3b467f2cccd8b1c11484a2e"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:afe93d1d3b3b467f2cccd8b1c11484a2e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#afe93d1d3b3b467f2cccd8b1c11484a2e">testConstructor</a> ()</td></tr>
<tr class="separator:afe93d1d3b3b467f2cccd8b1c11484a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a947678f81f6139e1abbf436739e0fde4"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a947678f81f6139e1abbf436739e0fde4"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a947678f81f6139e1abbf436739e0fde4">testCopyConstructor</a> ()</td></tr>
<tr class="separator:a947678f81f6139e1abbf436739e0fde4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6c109da2ad2df0e707fafdfb3468bd6"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:ae6c109da2ad2df0e707fafdfb3468bd6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#ae6c109da2ad2df0e707fafdfb3468bd6">testIncrementConstructor</a> ()</td></tr>
<tr class="separator:ae6c109da2ad2df0e707fafdfb3468bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64527c7c93e0849358a4704857846703"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a64527c7c93e0849358a4704857846703"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a64527c7c93e0849358a4704857846703">testIncrementCopyConstructor</a> ()</td></tr>
<tr class="separator:a64527c7c93e0849358a4704857846703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7930ebd5aab1012896e560091c6e46a7"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a7930ebd5aab1012896e560091c6e46a7"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a7930ebd5aab1012896e560091c6e46a7">testIncrementTriangle</a> ()</td></tr>
<tr class="separator:a7930ebd5aab1012896e560091c6e46a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc79fc6211048a8c413c5e488cac2946"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:abc79fc6211048a8c413c5e488cac2946"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#abc79fc6211048a8c413c5e488cac2946">testIncrementOpPlusEq</a> ()</td></tr>
<tr class="separator:abc79fc6211048a8c413c5e488cac2946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add45a80cab20890c279f3558cbf496b9"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:add45a80cab20890c279f3558cbf496b9"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#add45a80cab20890c279f3558cbf496b9">testIncrementDotProduct</a> ()</td></tr>
<tr class="separator:add45a80cab20890c279f3558cbf496b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd8ad9182e87bc3f64c8041ea5c79bd"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a6bd8ad9182e87bc3f64c8041ea5c79bd"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a6bd8ad9182e87bc3f64c8041ea5c79bd">testIncrementZero</a> ()</td></tr>
<tr class="separator:a6bd8ad9182e87bc3f64c8041ea5c79bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71da8a6a816cb575c85340db5754ea4a"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a71da8a6a816cb575c85340db5754ea4a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a71da8a6a816cb575c85340db5754ea4a">testIncrementAxpy</a> ()</td></tr>
<tr class="separator:a71da8a6a816cb575c85340db5754ea4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0055834957557dc43e9082ef9a093491"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a0055834957557dc43e9082ef9a093491"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a0055834957557dc43e9082ef9a093491">testLinearModelConstructor</a> ()</td></tr>
<tr class="separator:a0055834957557dc43e9082ef9a093491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ac75fecb3badb35d35b10ec07e0d669"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a3ac75fecb3badb35d35b10ec07e0d669"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a3ac75fecb3badb35d35b10ec07e0d669">testLinearModelZeroLength</a> ()</td></tr>
<tr class="separator:a3ac75fecb3badb35d35b10ec07e0d669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe803ae36153ee74bc49ce00c07fe897"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:abe803ae36153ee74bc49ce00c07fe897"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#abe803ae36153ee74bc49ce00c07fe897">testLinearModelZeroPert</a> ()</td></tr>
<tr class="separator:abe803ae36153ee74bc49ce00c07fe897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4de23df7e1f7cb3e2bfa6b6cbe8939"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:afa4de23df7e1f7cb3e2bfa6b6cbe8939"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#afa4de23df7e1f7cb3e2bfa6b6cbe8939">testLinearModelLinearity</a> ()</td></tr>
<tr class="separator:afa4de23df7e1f7cb3e2bfa6b6cbe8939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2914132b68f54cc37ac15f5b4ac94bc"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:ae2914132b68f54cc37ac15f5b4ac94bc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#ae2914132b68f54cc37ac15f5b4ac94bc">testLinearApproximation</a> ()</td></tr>
<tr class="separator:ae2914132b68f54cc37ac15f5b4ac94bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aa681e807fc771d75b69799a30fb8a0"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a0aa681e807fc771d75b69799a30fb8a0"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a0aa681e807fc771d75b69799a30fb8a0">testLinearModelAdjoint</a> ()</td></tr>
<tr class="separator:a0aa681e807fc771d75b69799a30fb8a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac0727efdeb021cb1e677e2df21e6edd"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:aac0727efdeb021cb1e677e2df21e6edd"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#aac0727efdeb021cb1e677e2df21e6edd">testLocalizationZero</a> ()</td></tr>
<tr class="separator:aac0727efdeb021cb1e677e2df21e6edd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fdb15750de87b96f3cd9c08aa445e05"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a9fdb15750de87b96f3cd9c08aa445e05"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a9fdb15750de87b96f3cd9c08aa445e05">testLocalizationMultiply</a> ()</td></tr>
<tr class="separator:a9fdb15750de87b96f3cd9c08aa445e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982f56aedee487345fbfdb30b5ca886e"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a982f56aedee487345fbfdb30b5ca886e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a982f56aedee487345fbfdb30b5ca886e">testConstructors</a> ()</td></tr>
<tr class="separator:a982f56aedee487345fbfdb30b5ca886e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3616bd5816927eec881a61b21af2476e"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a3616bd5816927eec881a61b21af2476e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a3616bd5816927eec881a61b21af2476e">testModelConstructor</a> ()</td></tr>
<tr class="separator:a3616bd5816927eec881a61b21af2476e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5328bdf515d96904ecec34ce11dd7daa"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a5328bdf515d96904ecec34ce11dd7daa"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a5328bdf515d96904ecec34ce11dd7daa">testModelNoForecast</a> ()</td></tr>
<tr class="separator:a5328bdf515d96904ecec34ce11dd7daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9acb0a929c48ae1ca8fb04704b0fd75a"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a9acb0a929c48ae1ca8fb04704b0fd75a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a9acb0a929c48ae1ca8fb04704b0fd75a">testModelForecast</a> ()</td></tr>
<tr class="separator:a9acb0a929c48ae1ca8fb04704b0fd75a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc082c130e67563751c45ba53e9dd1c6"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:adc082c130e67563751c45ba53e9dd1c6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#adc082c130e67563751c45ba53e9dd1c6">testChangeRes</a> ()</td></tr>
<tr class="separator:adc082c130e67563751c45ba53e9dd1c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e9f1da1d3e0105f5dc7cec9e786a943"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a5e9f1da1d3e0105f5dc7cec9e786a943"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a5e9f1da1d3e0105f5dc7cec9e786a943">testModelAuxIncrementConstructor</a> ()</td></tr>
<tr class="separator:a5e9f1da1d3e0105f5dc7cec9e786a943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d2001722603103a0bf4ddbc3649b896"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a4d2001722603103a0bf4ddbc3649b896"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a4d2001722603103a0bf4ddbc3649b896">testModelAuxIncrementCopyConstructor</a> ()</td></tr>
<tr class="separator:a4d2001722603103a0bf4ddbc3649b896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f79b3283d2403f2588033b342dc8b47"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a3f79b3283d2403f2588033b342dc8b47"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a3f79b3283d2403f2588033b342dc8b47">testModelAuxIncrementChangeRes</a> ()</td></tr>
<tr class="separator:a3f79b3283d2403f2588033b342dc8b47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81307c4cc01741f1ee742fadf19efa6b"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a81307c4cc01741f1ee742fadf19efa6b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a81307c4cc01741f1ee742fadf19efa6b">testModelAuxIncrementTriangle</a> ()</td></tr>
<tr class="separator:a81307c4cc01741f1ee742fadf19efa6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd4e4ed3fb006162249bb746a5222eb"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a6cd4e4ed3fb006162249bb746a5222eb"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a6cd4e4ed3fb006162249bb746a5222eb">testModelAuxIncrementOpPlusEq</a> ()</td></tr>
<tr class="separator:a6cd4e4ed3fb006162249bb746a5222eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1bae4f6a7e42a154d45967d21471452"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:af1bae4f6a7e42a154d45967d21471452"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#af1bae4f6a7e42a154d45967d21471452">testModelAuxIncrementDotProduct</a> ()</td></tr>
<tr class="separator:af1bae4f6a7e42a154d45967d21471452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1738b7cec96e63175cf7a3dfa0bbe4b0"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a1738b7cec96e63175cf7a3dfa0bbe4b0"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a1738b7cec96e63175cf7a3dfa0bbe4b0">testModelAuxIncrementZero</a> ()</td></tr>
<tr class="separator:a1738b7cec96e63175cf7a3dfa0bbe4b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb59e68a4aeb7c66357982fb5df1d00"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a0bb59e68a4aeb7c66357982fb5df1d00"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a0bb59e68a4aeb7c66357982fb5df1d00">testModelAuxIncrementAxpy</a> ()</td></tr>
<tr class="separator:a0bb59e68a4aeb7c66357982fb5df1d00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d2595ff8046205c3b0bf736b91d442"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a20d2595ff8046205c3b0bf736b91d442"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a20d2595ff8046205c3b0bf736b91d442">testObsAuxIncrementConstructor</a> ()</td></tr>
<tr class="separator:a20d2595ff8046205c3b0bf736b91d442"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2af5ed0feab8257693851aec152835"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a0a2af5ed0feab8257693851aec152835"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a0a2af5ed0feab8257693851aec152835">testObsAuxIncrementCopyConstructor</a> ()</td></tr>
<tr class="separator:a0a2af5ed0feab8257693851aec152835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19de3f1e39e64524637af9ae4381a059"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a19de3f1e39e64524637af9ae4381a059"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a19de3f1e39e64524637af9ae4381a059">testObsAuxIncrementChangeRes</a> ()</td></tr>
<tr class="separator:a19de3f1e39e64524637af9ae4381a059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61d505e4470ec5fcbe450bd08d62976b"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a61d505e4470ec5fcbe450bd08d62976b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a61d505e4470ec5fcbe450bd08d62976b">testObsAuxIncrementTriangle</a> ()</td></tr>
<tr class="separator:a61d505e4470ec5fcbe450bd08d62976b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dc64ff48166fe98ebcba5702249c223"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a4dc64ff48166fe98ebcba5702249c223"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a4dc64ff48166fe98ebcba5702249c223">testObsAuxIncrementOpPlusEq</a> ()</td></tr>
<tr class="separator:a4dc64ff48166fe98ebcba5702249c223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24177f0b1871bebe95e01fe1ad6d243"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:ae24177f0b1871bebe95e01fe1ad6d243"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#ae24177f0b1871bebe95e01fe1ad6d243">testObsAuxIncrementDotProduct</a> ()</td></tr>
<tr class="separator:ae24177f0b1871bebe95e01fe1ad6d243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af240ec42281a9eaee5c2c223b4d48a68"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:af240ec42281a9eaee5c2c223b4d48a68"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#af240ec42281a9eaee5c2c223b4d48a68">testObsAuxIncrementZero</a> ()</td></tr>
<tr class="separator:af240ec42281a9eaee5c2c223b4d48a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abde5fd0881acfbe6919633710d1b341b"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:abde5fd0881acfbe6919633710d1b341b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#abde5fd0881acfbe6919633710d1b341b">testObsAuxIncrementAxpy</a> ()</td></tr>
<tr class="separator:abde5fd0881acfbe6919633710d1b341b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aedebe5fad02a9e8b3c6d711b1aeedc"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a0aedebe5fad02a9e8b3c6d711b1aeedc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a0aedebe5fad02a9e8b3c6d711b1aeedc">testStateConstructor</a> ()</td></tr>
<tr class="separator:a0aedebe5fad02a9e8b3c6d711b1aeedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0997509de3f015586301962cc995466f"><td class="memTemplParams" colspan="2">template&lt;typename MODEL &gt; </td></tr>
<tr class="memitem:a0997509de3f015586301962cc995466f"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a0997509de3f015586301962cc995466f">testStateCopyConstructor</a> ()</td></tr>
<tr class="separator:a0997509de3f015586301962cc995466f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98b248abc7fe65ce82ecf904fa7a8650"><td class="memItemLeft" align="right" valign="top">std::int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a98b248abc7fe65ce82ecf904fa7a8650">test_uniform_real_f</a> (const eckit::Configuration *const *)</td></tr>
<tr class="separator:a98b248abc7fe65ce82ecf904fa7a8650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad29d6580d50e94a470227e758ee85fe4"><td class="memItemLeft" align="right" valign="top">std::int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#ad29d6580d50e94a470227e758ee85fe4">test_uniform_int_f</a> (const eckit::Configuration *const *)</td></tr>
<tr class="separator:ad29d6580d50e94a470227e758ee85fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aada6b2f311113e191f7e0668f7bf792f"><td class="memItemLeft" align="right" valign="top">std::int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#aada6b2f311113e191f7e0668f7bf792f">test_normal_real_f</a> (const eckit::Configuration *const *)</td></tr>
<tr class="separator:aada6b2f311113e191f7e0668f7bf792f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c327ac49740eb72e7e6e361eeee3500"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a4c327ac49740eb72e7e6e361eeee3500">CASE</a> (&quot;test_GomL95&quot;)</td></tr>
<tr class="separator:a4c327ac49740eb72e7e6e361eeee3500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a100b00fbc1041e7324a96098fc85a394"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a100b00fbc1041e7324a96098fc85a394">CASE</a> (&quot;test_IncrementL95&quot;)</td></tr>
<tr class="separator:a100b00fbc1041e7324a96098fc85a394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cbd293058a567aa0451bd7f654ac0b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a0cbd293058a567aa0451bd7f654ac0b9">CASE</a> (&quot;test_localizationMatrixL95&quot;)</td></tr>
<tr class="separator:a0cbd293058a567aa0451bd7f654ac0b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fe4bf3b32b3e5027919312412010722"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a8fe4bf3b32b3e5027919312412010722">CASE</a> (&quot;test_LocsL95&quot;)</td></tr>
<tr class="separator:a8fe4bf3b32b3e5027919312412010722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386534acd8b8beeb2e30e141a5324cff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a386534acd8b8beeb2e30e141a5324cff">CASE</a> (&quot;test_modelBias&quot;)</td></tr>
<tr class="separator:a386534acd8b8beeb2e30e141a5324cff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c70c2b14cadc9af9d6b12544891e8e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a6c70c2b14cadc9af9d6b12544891e8e6">CASE</a> (&quot;test_modelBiasCorrection&quot;)</td></tr>
<tr class="separator:a6c70c2b14cadc9af9d6b12544891e8e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7993c2b28295f0786055e00797bb7d35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a7993c2b28295f0786055e00797bb7d35">CASE</a> (&quot;test_modelBiasCovariance&quot;)</td></tr>
<tr class="separator:a7993c2b28295f0786055e00797bb7d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef436f3369a0043282105a0bf0f8ee65"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#aef436f3369a0043282105a0bf0f8ee65">CASE</a> (&quot;test_modelL95&quot;)</td></tr>
<tr class="separator:aef436f3369a0043282105a0bf0f8ee65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99663e3bd4cd256de63291ae62197006"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a99663e3bd4cd256de63291ae62197006">CASE</a> (&quot;test_obsBias&quot;)</td></tr>
<tr class="separator:a99663e3bd4cd256de63291ae62197006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc3b6e9e4196a705b01fa054b9e28483"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#afc3b6e9e4196a705b01fa054b9e28483">CASE</a> (&quot;test_obsBiasCorrection&quot;)</td></tr>
<tr class="separator:afc3b6e9e4196a705b01fa054b9e28483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477fb0ed4be371d20d1b0f122a5d81d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a477fb0ed4be371d20d1b0f122a5d81d0">CASE</a> (&quot;test_obsBiasCovariance&quot;)</td></tr>
<tr class="separator:a477fb0ed4be371d20d1b0f122a5d81d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df81f38a936f3a9f697f966833edbdd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a7df81f38a936f3a9f697f966833edbdd">CASE</a> (&quot;test_ObsL95&quot;)</td></tr>
<tr class="separator:a7df81f38a936f3a9f697f966833edbdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33f2e5283ade82228ccce4b52af282b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#ad33f2e5283ade82228ccce4b52af282b">CASE</a> (&quot;test_ObsTable&quot;)</td></tr>
<tr class="separator:ad33f2e5283ade82228ccce4b52af282b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55819a0afd980b2e0a27143f9535abd8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a55819a0afd980b2e0a27143f9535abd8">CASE</a> (&quot;test_ObsVec1D&quot;)</td></tr>
<tr class="separator:a55819a0afd980b2e0a27143f9535abd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c9d87071f82b1eea1478990acf163ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a1c9d87071f82b1eea1478990acf163ae">CASE</a> (&quot;test_resolution&quot;)</td></tr>
<tr class="separator:a1c9d87071f82b1eea1478990acf163ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64f8f0694ad7b5d8ccf2fe78b9abf25e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a64f8f0694ad7b5d8ccf2fe78b9abf25e">CASE</a> (&quot;test_StateL95&quot;)</td></tr>
<tr class="separator:a64f8f0694ad7b5d8ccf2fe78b9abf25e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa51b7609b53d46d45da3b24e50c0011f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#aa51b7609b53d46d45da3b24e50c0011f">CASE</a> (&quot;test_tlmL95&quot;)</td></tr>
<tr class="separator:aa51b7609b53d46d45da3b24e50c0011f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4c327ac49740eb72e7e6e361eeee3500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c327ac49740eb72e7e6e361eeee3500">&#9670;&nbsp;</a></span>CASE() <span class="overload">[1/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_GomL95&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2GomL95_8cc_source.html#l00058">58</a> of file <a class="el" href="test_2lorenz95_2GomL95_8cc_source.html">GomL95.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                    {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  GomTestFixture f;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  SECTION(<span class="stringliteral">&quot;test_GomL95_constructor&quot;</span>) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    std::unique_ptr&lt;lorenz95::GomL95&gt; gom(<span class="keyword">new</span> lorenz95::GomL95(*f.ot_, *f.novar_, *f.incr_, *f.t1_, *f.t2_));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    EXPECT(gom.get() != NULL);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  SECTION(<span class="stringliteral">&quot;test_GomL95_nobs&quot;</span>) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    std::unique_ptr&lt;lorenz95::GomL95&gt; gom(<span class="keyword">new</span> lorenz95::GomL95(*f.ot_, *f.novar_, *f.incr_, *f.t1_, *f.t2_));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    EXPECT(gom-&gt;nobs() == 160);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  SECTION(<span class="stringliteral">&quot;test_gomL95_classname&quot;</span>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    std::unique_ptr&lt;lorenz95::GomL95&gt; gom(<span class="keyword">new</span> lorenz95::GomL95(*f.ot_, *f.novar_, *f.incr_, *f.t1_, *f.t2_));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    EXPECT(gom-&gt;classname() == <span class="stringliteral">&quot;lorenz95::GomL95&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  SECTION(<span class="stringliteral">&quot;test_gomL95_zero&quot;</span>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    std::unique_ptr&lt;lorenz95::GomL95&gt; gom(<span class="keyword">new</span> lorenz95::GomL95(*f.ot_, *f.novar_, *f.incr_, *f.t1_, *f.t2_));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    gom-&gt;zero();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gom-&gt;nobs(); ++i) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      EXPECT((*gom)[i] == 0.0);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  SECTION(<span class="stringliteral">&quot;test_gomL95_dot_product_with&quot;</span>) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    std::unique_ptr&lt;lorenz95::GomL95&gt; gom1(<span class="keyword">new</span> lorenz95::GomL95(*f.ot_, *f.novar_, *f.incr_, *f.t1_, *f.t2_));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    gom1-&gt;zero();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    std::unique_ptr&lt;lorenz95::GomL95&gt; gom2(<span class="keyword">new</span> lorenz95::GomL95(*f.ot_, *f.novar_, *f.incr_, *f.t1_, *f.t2_));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    gom2-&gt;zero();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">double</span> zz = gom1-&gt;dot_product_with(*gom2);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    EXPECT(zz == 0.0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  SECTION(<span class="stringliteral">&quot;test_gomL95_operator&quot;</span>) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    std::unique_ptr&lt;lorenz95::GomL95&gt; gom1(<span class="keyword">new</span> lorenz95::GomL95(*f.ot_, *f.novar_, *f.incr_, *f.t1_, *f.t2_));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    gom1-&gt;zero();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    std::unique_ptr&lt;lorenz95::GomL95&gt; gom2(<span class="keyword">new</span> lorenz95::GomL95(*f.ot_, *f.novar_, *f.incr_, *f.t1_, *f.t2_));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    gom2-&gt;zero();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    (*gom1)[1] = 1.0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    (*gom2)[3] = 1.0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">double</span> zz = gom1-&gt;dot_product_with(*gom2);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    EXPECT(zz == 0.0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    (*gom1)[3] = 1.0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    zz = gom1-&gt;dot_product_with(*gom2);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    EXPECT(zz == 1.0);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a100b00fbc1041e7324a96098fc85a394"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a100b00fbc1041e7324a96098fc85a394">&#9670;&nbsp;</a></span>CASE() <span class="overload">[2/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_IncrementL95&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2IncrementL95_8cc_source.html#l00057">57</a> of file <a class="el" href="test_2lorenz95_2IncrementL95_8cc_source.html">IncrementL95.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                          {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  IncrementTestFixture fix;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_constructor&quot;</span>) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    std::unique_ptr&lt;lorenz95::IncrementL95&gt;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      dx(<span class="keyword">new</span> lorenz95::IncrementL95(*fix.resol_, *fix.vars_, *fix.time_));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    EXPECT(dx.get() != NULL);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_interpolation_constructor&quot;</span>) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    std::unique_ptr&lt;lorenz95::IncrementL95&gt;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      dx1(<span class="keyword">new</span> lorenz95::IncrementL95(*fix.resol_, *fix.vars_, *fix.time_));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    std::unique_ptr&lt;lorenz95::IncrementL95&gt;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      dx2(<span class="keyword">new</span> lorenz95::IncrementL95(*fix.resol_, *dx1));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    EXPECT(dx2.get() != NULL);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_copy_constructor&quot;</span>) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    std::unique_ptr&lt;lorenz95::IncrementL95&gt;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      dx1(<span class="keyword">new</span> lorenz95::IncrementL95(*fix.resol_, *fix.vars_, *fix.time_));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    std::unique_ptr&lt;lorenz95::IncrementL95&gt; dx2(<span class="keyword">new</span> lorenz95::IncrementL95(*dx1));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    EXPECT(dx2.get() != NULL);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_diff&quot;</span>) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    dx.read(*fix.file_);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// construct the first stateL95 object</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    lorenz95::StateL95 xx1(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// read in the state config info</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    xx1.read(*fix.file_);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    lorenz95::StateL95 xx2(xx1);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// to vary the results a little, change the second StateL95 field values</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">double</span> fact = 0.75;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    dx *= fact;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    xx2 += dx;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    dx.diff(xx1, xx2);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// to verify the diff method has worked correctly, we need</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// to open and read the file containing the FieldL95</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    std::string filename(fix.file_-&gt;getString(<span class="stringliteral">&quot;filename&quot;</span>));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    std::ifstream inStream(filename.c_str());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (!inStream.is_open()) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;diff functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// we read in these two values but do not use them</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">int</span> resolInt;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    inStream &gt;&gt; resolInt;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    std::string time;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    inStream &gt;&gt; time;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    std::vector&lt;double&gt; doubleVec(resolInt);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; resolInt; ++i) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      inStream &gt;&gt; doubleVec[i];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    inStream.close();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fix.resol_-&gt;npoints(); ++i) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>((dx.getField())[i],</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                         doubleVec[i] - (doubleVec[i] + (doubleVec[i] * fact)),</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                         1.0e-6));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_zero&quot;</span>) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    dx.read(*fix.file_);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// first check that we have good data, ie, at least one element is non-zero</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">bool</span> goodData = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fix.resol_-&gt;npoints() &amp;&amp; goodData == <span class="keyword">false</span>; ++i) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">if</span> ((dx.getField())[i] != 0) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        goodData = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (!goodData) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      oops::Log::error() &lt;&lt;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="stringliteral">&quot;unable to test zero method, since test data is already all zero&quot;</span> &lt;&lt; std::endl;;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      dx.zero();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fix.resol_-&gt;npoints(); ++i) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        EXPECT(dx.getField()[i] == 0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_zero_set_datetime&quot;</span>) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    dx.read(*fix.file_);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// first check that we have good data, ie, at least one element is non-zero</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">bool</span> goodData = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fix.resol_-&gt;npoints() &amp;&amp; goodData == <span class="keyword">false</span>; ++i) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">if</span> (dx.getField()[i] != 0) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        goodData = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (!goodData) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      oops::Log::error() &lt;&lt;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="stringliteral">&quot;unable to test zero method, since test data is already all zero&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keyword">const</span> std::string modified_date_string(<span class="stringliteral">&quot;2010-01-01T10:35:00Z&quot;</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keyword">const</span> util::DateTime dtModified(modified_date_string);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      dx.zero(dtModified);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fix.resol_-&gt;npoints(); ++i) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        EXPECT(dx.getField()[i] == 0);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      EXPECT(dx.validTime().toString() != fix.date_str_);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_assignment&quot;</span>) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    lorenz95::IncrementL95 dx1(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    dx1.read(*fix.file_);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// construct the second dx object</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    lorenz95::IncrementL95 dx2(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">double</span> fact = 0.75;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    dx2.read(*fix.file_);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    dx2 *= fact;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    dx1 = dx2;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dx1.getField().resol(); ++i) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      EXPECT(dx1.getField()[i] == dx2.getField()[i]);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_compound_assignment_add&quot;</span>) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    lorenz95::IncrementL95 dx1(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    dx1.read(*fix.file_);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// copy construct the second stateL95 object</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    lorenz95::IncrementL95 dx2(dx1);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    dx1 += dx2;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// since the two IncrementL95 objects started off with the same data,</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// once they&#39;ve been added together incL591 will be double what incL952 is</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dx1.getField().resol(); ++i) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      EXPECT(dx1.getField()[i] == 2.0 * dx2.getField()[i]);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_compound_assignment_subtract&quot;</span>) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    lorenz95::IncrementL95 dx1(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    dx1.read(*fix.file_);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// copy construct the second stateL95 object</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    lorenz95::IncrementL95 dx2(dx1);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    dx1 -= dx2;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// since the two IncrementL95 objects started off with the same data,</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// once incL952 has been subtracted from incL951, the result is zero</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dx1.getField().resol(); ++i) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      EXPECT(dx1.getField()[i] == 0.0);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_compound_assignment_multiply&quot;</span>) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    dx.read(*fix.file_);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// create a copy of the original data for testing against</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    std::vector&lt;double&gt; testData(dx.getField().resol());</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; testData.size(); ++ii) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      testData.at(ii) = dx.getField()[ii];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">double</span> fact = 0.75;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    dx *= fact;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; dx.getField().resol(); ++ii) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      EXPECT(dx.getField()[ii] == testData.at(ii) * fact);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_axpy&quot;</span>) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    lorenz95::IncrementL95 dx1(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    dx1.read(*fix.file_);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// copy construct the second stateL95 object</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    lorenz95::IncrementL95 dx2(dx1);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">double</span> fact = 0.75;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    dx1.axpy(fact, dx2);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dx1.getField().resol(); ++i) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      EXPECT(dx1.getField()[i] == dx2.getField()[i] + fact * dx2.getField()[i]);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_dot_product_with&quot;</span>) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    lorenz95::IncrementL95 dx1(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    dx1.read(*fix.file_);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// copy construct the second stateL95 object</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    lorenz95::IncrementL95 dx2(dx1);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">double</span> dpwResult = dx1.dot_product_with(dx2);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// prepare a value to test against</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">double</span> testResult = 0.0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dx1.getField().resol(); ++i) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      testResult += (dx1.getField()[i] * dx2.getField()[i]);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    EXPECT(dpwResult == testResult);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_schur_product_with&quot;</span>) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    lorenz95::IncrementL95 dx1(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    dx1.read(*fix.file_);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// copy construct the second stateL95 object</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    lorenz95::IncrementL95 dx2(dx1);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    dx1.schur_product_with(dx2);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// both incL951 and incL952 started off with the same data in x_,</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// so to test incL951 against incL952xincL952 is a valid test</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dx1.getField().resol(); ++i) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      EXPECT(dx1.getField()[i] == dx2.getField()[i] * dx2.getField()[i]);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">  SECTION(&quot;test_incrementL95_interpolateTL&quot;) {</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    int maxVecSize = 5;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">    // construct the LocsL95 object</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">    std::vector&lt;double&gt; doubleVec(maxVecSize);</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">    // populate the vector with values from 0.1 to 0.5</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">    for (int i = 0; i &lt; maxVecSize; ++i) {</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">      doubleVec[i] = ((i + 1) * 0.1);</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">    lorenz95::LocsL95 locsL95(doubleVec);</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">    // construct the GomL95 object</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    std::vector&lt;int&gt; intVec(maxVecSize);</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">    lorenz95::GomL95 gomL95(intVec);</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">    // populate the locval_ vector with values from 1.1 to 0.5</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    for (int i = 0; i &lt; intVec.size(); ++i) {</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">      gomL95[i] = ((i + 1) * 0.1);</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">    int origCurrent = gomL95.current();</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">    dx.interpolateTL(locsL95, gomL95);</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">    for (int i = 0; i &lt; locsL95.nobs(); ++i) {</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">      EXPECT(gomL95[origCurrent + i] == dx.getField()[i]);</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">    EXPECT(gomL95.current() == (origCurrent + locsL95.nobs()));</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">  SECTION(&quot;test_incrementL95_interpolateAD&quot;) {</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">    int maxVecSize = 5;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    // construct the LocsL95 object</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">    std::vector&lt;double&gt; doubleVec(maxVecSize);</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">    // populate the vector with values from 0.1 to 0.5</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">    for (int i = 0; i &lt; maxVecSize; ++i) {</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">      doubleVec[i] = ((i + 1) * 0.1);</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">    lorenz95::LocsL95 locsL95(doubleVec);</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">    // construct the GomL95 object</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">    std::vector&lt;int&gt; intVec(maxVecSize);</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">    lorenz95::GomL95 gomL95(intVec);</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">    // populate the locval_ vector with values from 0.1 to 0.5</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">    for (int i = 0; i &lt; intVec.size(); ++i) {</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">      gomL95[i] = ((i + 1) * 0.1);</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">    int origCurrent = gomL95.current();</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">    dx.interpolateAD(locsL95, gomL95);</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">    const double dres = static_cast&lt;double&gt;(dx.getField().resol());</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">    if (gomL95.current() == 0) {</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">      gomL95.current() = gomL95.nobs();</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">    gomL95.current() -= locsL95.nobs();</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">    for (int i = 0; i &lt; locsL95-&gt;nobs(); ++i) {</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">      int idx = round(locsL95[i] * dres);</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">      EXPECT(dx.getField()[idx] == gomL95[gomL95.current() + i]);</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_read&quot;</span>) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    dx.read(*fix.file_);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// to verify the information has been read correctly, we need to open</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// and read the file using ifstream functionality</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keyword">const</span> std::string filename(fix.file_-&gt;getString(<span class="stringliteral">&quot;filename&quot;</span>));</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    std::ifstream inStream(filename.c_str());</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> (!inStream.is_open()) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;read functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordtype">int</span> resolInt;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    inStream &gt;&gt; resolInt;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    std::string time;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    inStream &gt;&gt; time;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    std::vector&lt;double&gt; doubleVec(resolInt);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; resolInt; ++i) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      inStream &gt;&gt; doubleVec[i];</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    inStream.close();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fix.resol_-&gt;npoints(); ++i) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      EXPECT(dx.getField()[i] == doubleVec[i]);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_write&quot;</span>) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    dx.read(*fix.file_);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    eckit::LocalConfiguration opFileCfg(TestConfig::config(), <span class="stringliteral">&quot;outputFile&quot;</span>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    dx.write(opFileCfg);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// Should read back in and compare values</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_validTime&quot;</span>) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    EXPECT(dx.validTime().toString() == fix.date_str_);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_timeUpdate&quot;</span>) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    util::Duration dur(<span class="stringliteral">&quot;PT1H30M10S&quot;</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    std::string updated_date_string(<span class="stringliteral">&quot;2010-01-01T10:30:10Z&quot;</span>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    dx.validTime() += dur;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    EXPECT(dx.validTime().toString() == updated_date_string);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">  SECTION(&quot;test_incrementL95_stream_output&quot;) {</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">    // use the operator&lt;&lt; method to write the value to a file</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">    std::filebuf fb;</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">    std::string filename(&quot;IncrementL95Test.txt&quot;);</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">    fb.open(filename.c_str(), std::ios::out);</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">    std::ostream os(&amp;fb);</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">    os &lt;&lt; dx;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">    fb.close();</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">    // then read the value that was written to the file</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">    std::string input;</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">    std::string inputTest(&quot; Valid time: &quot; + fix.date_str_);</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">    std::ifstream inputFile(filename.c_str());</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">    if (inputFile.is_open()) {</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">      getline(inputFile, input);  // ignore the first (blank) line</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">      getline(inputFile, input);</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">      EXPECT(input == inputTest);</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">    } else {</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">      // if we can&#39;t open the file then we can&#39;t</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">      // verify that the value was correctly written</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">      oops::Log::error() &lt;&lt; &quot;operator&lt;&lt; functionality cannot be determined&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">    inputFile.close();</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  SECTION(<span class="stringliteral">&quot;test_incrementL95_getField&quot;</span>) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// there are 2 values in FieldL95: the 1st is the *resol_ value,</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">// the 2nd is a vector of doubles initialised to 0.0, the size of the</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">// vector is the *resol_ value (we&#39;re just checking the final one)</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    EXPECT(dx.getField().resol() == fix.resol_-&gt;npoints());</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a100b00fbc1041e7324a96098fc85a394_cgraph.png" border="0" usemap="#namespacetest_a100b00fbc1041e7324a96098fc85a394_cgraph" alt=""/></div>
<map name="namespacetest_a100b00fbc1041e7324a96098fc85a394_cgraph" id="namespacetest_a100b00fbc1041e7324a96098fc85a394_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,91,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="139,5,243,32"/>
</map>
</div>

</div>
</div>
<a id="a0cbd293058a567aa0451bd7f654ac0b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cbd293058a567aa0451bd7f654ac0b9">&#9670;&nbsp;</a></span>CASE() <span class="overload">[3/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_localizationMatrixL95&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2LocalizationMatrixL95_8cc_source.html#l00040">40</a> of file <a class="el" href="test_2lorenz95_2LocalizationMatrixL95_8cc_source.html">LocalizationMatrixL95.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                   {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  LocalizationMatrixFixture fix;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  SECTION(<span class="stringliteral">&quot;test_localizationMatrixL95_constructor&quot;</span>) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    std::unique_ptr&lt;lorenz95::LocalizationMatrixL95&gt; locmat(</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keyword">new</span> lorenz95::LocalizationMatrixL95(*fix.resol_, *fix.cfg_));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    EXPECT(locmat.get() != NULL);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8fe4bf3b32b3e5027919312412010722"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fe4bf3b32b3e5027919312412010722">&#9670;&nbsp;</a></span>CASE() <span class="overload">[4/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_LocsL95&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2LocsL95_8cc_source.html#l00051">51</a> of file <a class="el" href="test_2lorenz95_2LocsL95_8cc_source.html">LocsL95.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                     {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  LocsTestFixture fix;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  SECTION(<span class="stringliteral">&quot;test_LocsL95_constructor&quot;</span>) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    std::unique_ptr&lt;lorenz95::LocsL95&gt; locs(<span class="keyword">new</span> lorenz95::LocsL95(*fix.ot_, *fix.t1_, *fix.t2_));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    EXPECT(locs.get() != NULL);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  SECTION(<span class="stringliteral">&quot;test_LocsL95_nobs&quot;</span>) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    std::unique_ptr&lt;lorenz95::LocsL95&gt; locs(<span class="keyword">new</span> lorenz95::LocsL95(*fix.ot_, *fix.t1_, *fix.t2_));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">size_t</span> ref = 80;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    EXPECT(locs-&gt;nobs() ==ref);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  SECTION(<span class="stringliteral">&quot;test_LocsL95_operator&quot;</span>) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    std::unique_ptr&lt;lorenz95::LocsL95&gt; locs(<span class="keyword">new</span> lorenz95::LocsL95(*fix.ot_, *fix.t1_, *fix.t2_));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">double</span> pos = 0.0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jj = 0; jj &lt; locs-&gt;nobs(); ++jj) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>((*locs)[jj], pos, 0.00000001));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      pos += 0.05;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">if</span> (pos &gt;= 1.0) pos=0.0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a8fe4bf3b32b3e5027919312412010722_cgraph.png" border="0" usemap="#namespacetest_a8fe4bf3b32b3e5027919312412010722_cgraph" alt=""/></div>
<map name="namespacetest_a8fe4bf3b32b3e5027919312412010722_cgraph" id="namespacetest_a8fe4bf3b32b3e5027919312412010722_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,91,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="139,5,243,32"/>
</map>
</div>

</div>
</div>
<a id="a386534acd8b8beeb2e30e141a5324cff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a386534acd8b8beeb2e30e141a5324cff">&#9670;&nbsp;</a></span>CASE() <span class="overload">[5/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_modelBias&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="l95_2test_2lorenz95_2ModelBias_8cc_source.html#l00058">58</a> of file <a class="el" href="l95_2test_2lorenz95_2ModelBias_8cc_source.html">ModelBias.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                       {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  ModBiasTestFixture fix;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_constructor_bias&quot;</span>) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    lorenz95::ModelBias mbias(*fix.resol_, *fix.biasconf_);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    EXPECT(mbias.bias() == fix.bias1_);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_constructor_nobias&quot;</span>) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    lorenz95::ModelBias mbias(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// because the biasconf_ is empty when used,</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// the active_ flag is false and the bias_ value is 0.0</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    EXPECT(mbias.bias() == 0.0);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_constructor_active&quot;</span>) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    lorenz95::ModelBias mbias1(*fix.resol_, *fix.biasconf_);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    lorenz95::ModelBias mbias2(*fix.resol_, mbias1);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    EXPECT(mbias2.bias() == fix.bias1_);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_constructor_inactive&quot;</span>) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    lorenz95::ModelBias mbias1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    lorenz95::ModelBias mbias2(*fix.resol_, mbias1);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// because the biasconf_ is empty when used,</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// the active_ flag is false and the bias_ value is 0.0</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    EXPECT(mbias2.bias() == 0.0);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_constructor_active_copy&quot;</span>) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    lorenz95::ModelBias mbias1(*fix.resol_, *fix.biasconf_);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    lorenz95::ModelBias mbias2(mbias1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    EXPECT(mbias2.bias() == fix.bias1_);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_constructor_active_nocopy&quot;</span>) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    lorenz95::ModelBias mbias1(*fix.resol_, *fix.biasconf_);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    lorenz95::ModelBias mbias2(mbias1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// because copy flag is set to false, bias is 0.0</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    EXPECT(mbias2.bias() == 0.0);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_constructor_inactive_copy&quot;</span>) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    lorenz95::ModelBias mbias1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    lorenz95::ModelBias mbias2(mbias1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// because the biasconf_ is empty when used,</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// the active_ flag is false and the bias_ value is 0.0</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    EXPECT(mbias2.bias() == 0.0);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_constructor_inactive_nocopy&quot;</span>) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    lorenz95::ModelBias mbias1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    lorenz95::ModelBias mbias2(mbias1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    EXPECT(mbias2.bias() == 0.0);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_destructor&quot;</span>) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_classname&quot;</span>) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    lorenz95::ModelBias mbias(*fix.resol_, *fix.biasconf_);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    EXPECT(mbias.classname() == <span class="stringliteral">&quot;lorenz95::ModelBias&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_compound_assignment_active&quot;</span>) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    lorenz95::ModelBias mbias(*fix.resol_, *fix.biasconf_);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    mbias += *fix.dbias_;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    EXPECT(mbias.bias() == fix.bias1_ + fix.bias2_);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_compound_assignment_inactive&quot;</span>) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    lorenz95::ModelBias mbias(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    mbias += *fix.dbias_;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// because the biasconf_ is empty,</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// mbias bias value is not modified from 0.0</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    EXPECT(mbias.bias() == 0.0);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_bias&quot;</span>) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    lorenz95::ModelBias mbias(*fix.resol_, *fix.biasconf_);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    EXPECT(mbias.bias() == fix.bias1_);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_read&quot;</span>) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_write&quot;</span>) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBias_stream_output&quot;</span>) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    lorenz95::ModelBias mbias(*fix.resol_, *fix.biasconf_);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// use the operator&lt;&lt; method to write the value to a file</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    std::filebuf fb;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    std::string filename(<span class="stringliteral">&quot;ModelBiasTest.txt&quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    fb.open(filename.c_str(), std::ios::out);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    std::ostream os(&amp;fb);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    os &lt;&lt; mbias;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    fb.close();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// then read the value that was written to the file</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::string inputString;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    std::string inputBias;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">double</span> testBias = fix.bias1_;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">double</span> bias = 0.0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">int</span> biasStartPos = 12;  <span class="comment">// length of &quot;ModelBias = &quot; is 12</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    std::ifstream inputFile(filename.c_str());</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (inputFile.is_open()) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      getline(inputFile, inputString);  <span class="comment">// ignore first (blank) line</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      getline(inputFile, inputString);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      inputBias = inputString.substr(biasStartPos);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        bias = eckit::Translator&lt;std::string, double&gt;()(inputBias);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">catch</span>(eckit::BadParameter <span class="keyword">const</span>&amp;) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; incorrectly output a non-double&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(testBias, bias, 0.0001));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// if we can&#39;t open the file then we can&#39;t</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">// verify that the value was correctly written</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    inputFile.close();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a386534acd8b8beeb2e30e141a5324cff_cgraph.png" border="0" usemap="#namespacetest_a386534acd8b8beeb2e30e141a5324cff_cgraph" alt=""/></div>
<map name="namespacetest_a386534acd8b8beeb2e30e141a5324cff_cgraph" id="namespacetest_a386534acd8b8beeb2e30e141a5324cff_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,91,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="139,5,243,32"/>
</map>
</div>

</div>
</div>
<a id="a6c70c2b14cadc9af9d6b12544891e8e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c70c2b14cadc9af9d6b12544891e8e6">&#9670;&nbsp;</a></span>CASE() <span class="overload">[6/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_modelBiasCorrection&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2ModelBiasCorrection_8cc_source.html#l00054">54</a> of file <a class="el" href="test_2lorenz95_2ModelBiasCorrection_8cc_source.html">ModelBiasCorrection.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                 {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  ModBiasTestFixture fix;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_constructor_config&quot;</span>) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    std::unique_ptr&lt;lorenz95::ModelBiasCorrection&gt; dx(</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keyword">new</span> lorenz95::ModelBiasCorrection(*fix.resol_, *fix.conf_));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    EXPECT(dx.get() != NULL);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_constructor_no_config&quot;</span>) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    std::unique_ptr&lt;lorenz95::ModelBiasCorrection&gt; dx(</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keyword">new</span> lorenz95::ModelBiasCorrection(*fix.resol_, *fix.nobias_));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    EXPECT(dx.get() != NULL);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_copy_ctor_active_copy&quot;</span>) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    lorenz95::ModelBiasCorrection dx2(dx1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    EXPECT(dx2.bias() == fix.bias1_);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_copy_ctor_active_no_copy&quot;</span>) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// construct a copy of it with the copy flag set to false</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    lorenz95::ModelBiasCorrection dx2(dx1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// because the copy is false,</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// the active_ flag is true and the bias_ value is 0.0</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    EXPECT(dx2.bias() == 0.0);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_copy_ctor_inactive_copy&quot;</span>) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// construct a copy of it with the copy flag set to true</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    lorenz95::ModelBiasCorrection dx2(dx1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// because the cfg is empty when used,</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// the active_ flag is false and the bias_ value is 0.0</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    EXPECT(dx2.bias() == 0.0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_copy_ctor_inactive_no_copy&quot;</span>) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// construct a copy of it with the copy flag set to false</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    lorenz95::ModelBiasCorrection dx2(dx1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// because the cfg is empty when used and the copy flag is false,</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// the active_ flag is false and the bias_ value is 0.0</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    EXPECT(dx2.bias() == 0.0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_copy_ctor_config_active&quot;</span>) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    lorenz95::ModelBiasCorrection dx2(dx1, *fix.conf_);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    EXPECT(dx2.bias() == fix.bias1_);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_copy_ctor_config_inactive&quot;</span>) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    lorenz95::ModelBiasCorrection dx2(dx1, *fix.conf_);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;     <span class="comment">// because the covarCfg is empty when used (regardless of the cfg),</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     <span class="comment">// the active_ flag is false and the bias_ value is 0.0</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     EXPECT(dx2.bias() == 0.0);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_diff_active&quot;</span>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    lorenz95::ModelBias xx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    xx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    lorenz95::ModelBias xx2(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    xx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    lorenz95::ModelBiasCorrection dx(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    dx.diff(xx1, xx2);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    EXPECT(dx.bias() == fix.bias1_ - fix.bias2_);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_diff_inactive&quot;</span>) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    lorenz95::ModelBias xx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    xx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    lorenz95::ModelBias xx2(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    xx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    lorenz95::ModelBiasCorrection dx(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    dx.diff(xx1, xx2);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// because the active_ flag is false, the bias cannot be updated</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    EXPECT(dx.bias() == 0.0);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_zero&quot;</span>) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    lorenz95::ModelBiasCorrection dx(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    dx.bias() = fix.bias1_;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    dx.zero();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    EXPECT(dx.bias() == 0.0);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_assignment_active&quot;</span>) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    dx1 = dx2;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// the original MBC should have the same bias value as the copy MBC</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    EXPECT(dx1.bias() == fix.bias2_);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_assignment_inactive&quot;</span>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    dx1 = dx2;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// the active_ value is zero, so the bias will be zero</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    EXPECT(dx1.bias() == 0.0);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_assignment_add_active&quot;</span>) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    dx1 += dx2;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    EXPECT(dx1.bias() == fix.bias1_ + fix.bias2_);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_assignment_add_inactive&quot;</span>) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    dx1 += dx2;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// the active_ value is zero, so the bias will be unchanged</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    EXPECT(dx1.bias() == fix.bias1_);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_assignment_subtract_active&quot;</span>) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    dx1 -= dx2;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    EXPECT(dx1.bias() == fix.bias1_ - fix.bias2_);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_assignment_subtract_inactive&quot;</span>) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    dx1 -= dx2;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// the active_ value is zero, so the bias will be unchanged</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    EXPECT(dx1.bias() == fix.bias1_);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_assignment_multiply_active&quot;</span>) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    lorenz95::ModelBiasCorrection dx(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    dx.bias() = fix.bias1_;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    dx *= fix.fact_;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    EXPECT(dx.bias() == fix.bias1_ * fix.fact_);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_assignment_multiply_inactive&quot;</span>) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    lorenz95::ModelBiasCorrection dx(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    dx.bias() = fix.bias1_;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    dx *= fix.fact_;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// the active_ value is zero, so the bias will be unchanged</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    EXPECT(dx.bias() == fix.bias1_);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_axpy_active&quot;</span>) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    dx1.axpy(fix.fact_, dx2);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    EXPECT(dx1.bias() == (fix.bias1_ + fix.fact_ * fix.bias2_));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_axpy_inactive&quot;</span>) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    dx1.axpy(fix.fact_, dx2);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// the active_ value is zero, so the bias will be unchanged</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    EXPECT(dx1.bias() == fix.bias1_);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_dot_product_with_active&quot;</span>) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">double</span> dpwResult = dx1.dot_product_with(dx2);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    EXPECT(dpwResult == fix.bias1_ * fix.bias2_);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_dot_product_with_inactive&quot;</span>) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    lorenz95::ModelBiasCorrection dx1(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    dx1.bias() = fix.bias1_;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    lorenz95::ModelBiasCorrection dx2(*fix.resol_, *fix.nobias_);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    dx2.bias() = fix.bias2_;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">double</span> dpwResult = dx1.dot_product_with(dx2);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// because of the empty config, the result is 0.0</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    EXPECT(dpwResult == 0.0);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_read&quot;</span>) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// nothing to test</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_write&quot;</span>) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// nothing to test</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_stream_output&quot;</span>) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    lorenz95::ModelBiasCorrection dx(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    dx.bias() = fix.bias1_;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// use the operator&lt;&lt; method to write the value to a file</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    std::filebuf fb;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    std::string filename(<span class="stringliteral">&quot;ModelBiasCorrectionTest.txt&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    fb.open(filename.c_str(), std::ios::out);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    std::ostream os(&amp;fb);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    os &lt;&lt; dx;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    fb.close();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// then read the value that was written to the file</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    std::string inputString;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    std::string inputBias;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">double</span> testBias = fix.bias1_;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">double</span> bias = 0.0;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">int</span> biasStartPos = 22;  <span class="comment">// length of &quot;ModelBiasCorrection = &quot; is 22</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    std::ifstream inputFile(filename.c_str());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (inputFile.is_open()) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      getline(inputFile, inputString);  <span class="comment">// ignore first (blank) line</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      getline(inputFile, inputString);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      inputBias = inputString.substr(biasStartPos);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        bias = eckit::Translator&lt;std::string, double&gt;()(inputBias);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">catch</span>(eckit::BadParameter <span class="keyword">const</span>&amp;) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; incorrectly output a non-double&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(testBias, bias, 0.000001));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="comment">// if we can&#39;t open the file then we can&#39;t</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="comment">// verify that the value was correctly written</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    inputFile.close();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCorrection_bias&quot;</span>) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    lorenz95::ModelBiasCorrection dx(*fix.resol_, *fix.conf_);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    dx.bias() = fix.bias1_;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// this one test checks both the setting and getting of the bias value</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    EXPECT(dx.bias() == fix.bias1_);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a6c70c2b14cadc9af9d6b12544891e8e6_cgraph.png" border="0" usemap="#namespacetest_a6c70c2b14cadc9af9d6b12544891e8e6_cgraph" alt=""/></div>
<map name="namespacetest_a6c70c2b14cadc9af9d6b12544891e8e6_cgraph" id="namespacetest_a6c70c2b14cadc9af9d6b12544891e8e6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,91,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="139,5,243,32"/>
</map>
</div>

</div>
</div>
<a id="a7993c2b28295f0786055e00797bb7d35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7993c2b28295f0786055e00797bb7d35">&#9670;&nbsp;</a></span>CASE() <span class="overload">[7/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_modelBiasCovariance&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="l95_2test_2lorenz95_2ModelBiasCovariance_8cc_source.html#l00045">45</a> of file <a class="el" href="l95_2test_2lorenz95_2ModelBiasCovariance_8cc_source.html">ModelBiasCovariance.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                 {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  ModBiasCovTestFixture f;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCovariance_constructor_conf&quot;</span>) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    lorenz95::ModelBiasCovariance bcovar(*f.covconf_, *f.resol_);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    EXPECT(bcovar.active() == <span class="keyword">true</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCovariance_constructor_no_conf&quot;</span>) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    lorenz95::ModelBiasCovariance bcovar(*f.nobias_, *f.resol_);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    EXPECT(bcovar.active() == <span class="keyword">false</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCovariance_linearize&quot;</span>) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCovariance_multiply_activei&quot;</span>) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// construct the ModelBiasCorrection object</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    lorenz95::ModelBiasCovariance bcovar(*f.covconf_, *f.resol_);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    lorenz95::ModelBiasCorrection dbias1(*f.resol_, *f.covconf_);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    dbias1.bias() = 2.0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    lorenz95::ModelBiasCorrection dbias2(dbias1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    bcovar.multiply(dbias1, dbias2);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">double</span> stdev = f.covconf_-&gt;getDouble(<span class="stringliteral">&quot;standard_deviation&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    EXPECT(dbias2.bias() == dbias1.bias() * stdev * stdev);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCovariance_multiply_inactive&quot;</span>) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// construct the ModelBiasCorrection object</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    lorenz95::ModelBiasCovariance bcovar(*f.nobias_, *f.resol_);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    lorenz95::ModelBiasCorrection dbias1(*f.resol_, *f.covconf_);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    dbias1.bias() = 2.0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    lorenz95::ModelBiasCorrection dbias2(dbias1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    bcovar.multiply(dbias1, dbias2);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// because the covconf_ is empty, the bias is set to 0</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    EXPECT(dbias2.bias() == 0.0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCovariance_invMult_active&quot;</span>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// construct the ModelBiasCorrection object</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    lorenz95::ModelBiasCovariance bcovar(*f.covconf_, *f.resol_);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    lorenz95::ModelBiasCorrection dbias1(*f.resol_, *f.covconf_);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    dbias1.bias() = 2.0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    lorenz95::ModelBiasCorrection dbias2(dbias1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    bcovar.inverseMultiply(dbias1, dbias2);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">double</span> stdev = f.covconf_-&gt;getDouble(<span class="stringliteral">&quot;standard_deviation&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    EXPECT(dbias2.bias() == dbias1.bias() *1.0 / (stdev * stdev));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCovariance_invMult_inactive&quot;</span>) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// construct the ModelBiasCorrection object</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    lorenz95::ModelBiasCovariance bcovar(*f.nobias_, *f.resol_);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    lorenz95::ModelBiasCorrection dbias1(*f.resol_, *f.covconf_);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    dbias1.bias() = 2.0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    lorenz95::ModelBiasCorrection dbias2(dbias1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    bcovar.inverseMultiply(dbias1, dbias2);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// because the covconf_ is empty, the bias is set to 0</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    EXPECT(dbias2.bias() == 0.0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelBiasCovariance_active&quot;</span>) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    lorenz95::ModelBiasCovariance bcovar(*f.covconf_, *f.resol_);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    EXPECT(bcovar.active() == <span class="keyword">true</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef436f3369a0043282105a0bf0f8ee65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef436f3369a0043282105a0bf0f8ee65">&#9670;&nbsp;</a></span>CASE() <span class="overload">[8/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_modelL95&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2ModelL95_8cc_source.html#l00049">49</a> of file <a class="el" href="test_2lorenz95_2ModelL95_8cc_source.html">ModelL95.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                      {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;ModelTestFixture fix;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelL95_constructor&quot;</span>) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    std::unique_ptr&lt;lorenz95::ModelL95&gt; model(<span class="keyword">new</span> lorenz95::ModelL95(*fix.resol_, *fix.nlconf_));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    EXPECT(model != NULL);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelL95_get_classname&quot;</span>) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    lorenz95::ModelL95 model(*fix.resol_, *fix.nlconf_);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    EXPECT(model.classname() == <span class="stringliteral">&quot;lorenz95::ModelL95&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelL95_get_timestep&quot;</span>) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    lorenz95::ModelL95 model(*fix.resol_, *fix.nlconf_);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    util::Duration dt(fix.nlconf_-&gt;getString(<span class="stringliteral">&quot;tstep&quot;</span>));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    EXPECT(model.timeResolution().toSeconds() == dt.toSeconds());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  SECTION(<span class="stringliteral">&quot;test_modelL95_stepRk&quot;</span>) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    lorenz95::ModelL95 model(*fix.resol_, *fix.nlconf_);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// construct a FieldL95 object</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    lorenz95::FieldL95 fieldL95(*fix.resol_);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// construct a ModelBias object</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    eckit::LocalConfiguration biasCfg(TestConfig::config(), <span class="stringliteral">&quot;ModelBias&quot;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    lorenz95::ModelBias modelBias(*fix.resol_, biasCfg);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// construct a ModelTrajectory object</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    lorenz95::ModelTrajectory modelTraj(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    modelTraj.set(fieldL95);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//    for(int i = 0; i &lt; fieldL95.resol(); ++i) {</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//      oops::Log::error() &lt;&lt; &quot;PMC: pre  stepRK &quot; &lt;&lt; fieldL95[i] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    model.stepRK(fieldL95, modelBias, modelTraj);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//    for(int i = 0; i &lt; fieldL95.resol(); ++i) {</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//      oops::Log::error() &lt;&lt; &quot;PMC: post stepRK &quot; &lt;&lt; fieldL95[i] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a99663e3bd4cd256de63291ae62197006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99663e3bd4cd256de63291ae62197006">&#9670;&nbsp;</a></span>CASE() <span class="overload">[9/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_obsBias&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="l95_2test_2lorenz95_2ObsBias_8cc_source.html#l00057">57</a> of file <a class="el" href="l95_2test_2lorenz95_2ObsBias_8cc_source.html">ObsBias.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                     {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  ObsBiasTestFixture fix;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_constructor_bias&quot;</span>) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    lorenz95::ObsBias ob(*fix.obstable_, *fix.biasconf_);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    EXPECT(ob.value() == fix.biasconf_-&gt;getDouble(<span class="stringliteral">&quot;bias&quot;</span>));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_constructor_no_bias&quot;</span>) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    lorenz95::ObsBias ob(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    EXPECT(ob.value() == 0.0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_copy_constructor_config_copy&quot;</span>) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    lorenz95::ObsBias ob1(*fix.obstable_, *fix.biasconf_);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    lorenz95::ObsBias ob2(ob1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    EXPECT(ob2.value() == fix.biasconf_-&gt;getDouble(<span class="stringliteral">&quot;bias&quot;</span>));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_copy_constructor_config_no_copy&quot;</span>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    lorenz95::ObsBias ob1(*fix.obstable_, *fix.biasconf_);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    lorenz95::ObsBias ob2(ob1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// bias value is 0 because copy flag was set to false</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    EXPECT(ob2.value() == 0.0);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_copy_constructor_no_config_copy&quot;</span>) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    lorenz95::ObsBias ob1(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    lorenz95::ObsBias ob2(ob1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// bias value is 0 because an empty config was used</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    EXPECT(ob2.value() == 0.0);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_copy_constructor_no_config_no_copy&quot;</span>) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    lorenz95::ObsBias ob1(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    lorenz95::ObsBias ob2(ob1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// bias value is 0 because an empty config was used</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    EXPECT(ob2.value() == 0.0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_destructor&quot;</span>) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_compound_assignment_add_active&quot;</span>) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    lorenz95::ObsBias ob(*fix.obstable_, *fix.biasconf_);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// construct an obsBiasCorrection object</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    lorenz95::ObsBiasCorrection obsBiasCorrection(*fix.obstable_, *fix.covconf_);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    obsBiasCorrection.value() = 3.14;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    ob += obsBiasCorrection;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    EXPECT(ob.value() == fix.biasconf_-&gt;getDouble(<span class="stringliteral">&quot;bias&quot;</span>) + 3.14);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_compound_assignment_add_inactive&quot;</span>) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    lorenz95::ObsBias ob(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// construct an obsBiasCorrection object</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    lorenz95::ObsBiasCorrection obsBiasCorrection(*fix.obstable_, *fix.covconf_);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    obsBiasCorrection.value() = 3.14;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    ob += obsBiasCorrection;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// the bias value will be 0 because the ob had an empty config</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    EXPECT(ob.value() == 0.0);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_value&quot;</span>) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    lorenz95::ObsBias ob(*fix.obstable_, *fix.biasconf_);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    EXPECT(ob.value() == fix.biasconf_-&gt;getDouble(<span class="stringliteral">&quot;bias&quot;</span>));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_read&quot;</span>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_write&quot;</span>) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBias_stream_output&quot;</span>) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    lorenz95::ObsBias ob(*fix.obstable_, *fix.biasconf_);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// use the operator&lt;&lt; method to write the value to a file</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    std::filebuf fb;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    std::string filename(<span class="stringliteral">&quot;ObsBiasTest.txt&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    fb.open(filename.c_str(), std::ios::out);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    std::ostream os(&amp;fb);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    os &lt;&lt; ob;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    fb.close();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// then read the value that was written to the file</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    std::string inputString;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    std::string inputBias;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">double</span> testBias = fix.biasconf_-&gt;getDouble(<span class="stringliteral">&quot;bias&quot;</span>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">double</span> bias = 0.0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">int</span> biasStartPos = 10;  <span class="comment">// length of &quot;ObsBias = &quot; is 10</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    std::ifstream inputFile(filename.c_str());</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (inputFile.is_open()) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      getline(inputFile, inputString);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      getline(inputFile, inputString);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      inputBias = inputString.substr(biasStartPos);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        bias = eckit::Translator&lt;std::string, double&gt;()(inputBias);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">catch</span>(eckit::BadParameter <span class="keyword">const</span>&amp;) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; incorrectly output a non-double&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(testBias, bias, 0.000001));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="comment">// if we can&#39;t open the file then we can&#39;t</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="comment">// verify that the value was correctly written</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    inputFile.close();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a99663e3bd4cd256de63291ae62197006_cgraph.png" border="0" usemap="#namespacetest_a99663e3bd4cd256de63291ae62197006_cgraph" alt=""/></div>
<map name="namespacetest_a99663e3bd4cd256de63291ae62197006_cgraph" id="namespacetest_a99663e3bd4cd256de63291ae62197006_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,91,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="139,5,243,32"/>
</map>
</div>

</div>
</div>
<a id="afc3b6e9e4196a705b01fa054b9e28483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc3b6e9e4196a705b01fa054b9e28483">&#9670;&nbsp;</a></span>CASE() <span class="overload">[10/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_obsBiasCorrection&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2ObsBiasCorrection_8cc_source.html#l00065">65</a> of file <a class="el" href="test_2lorenz95_2ObsBiasCorrection_8cc_source.html">ObsBiasCorrection.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                               {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  ObsBiasTestFixture fix;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_constructor_active&quot;</span>) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    lorenz95::ObsBiasCorrection dob(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    EXPECT(dob.value() == 0.0);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_constructor_inactive&quot;</span>) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    lorenz95::ObsBiasCorrection dob(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    EXPECT(dob.value() == 0.0);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_copy_ctor_active_copy&quot;</span>) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    EXPECT(dob2.value() == fix.bias1_);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_copy_ctor_active_no_copy&quot;</span>) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// because the copy is false,</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// the active_ flag is true and the bias1_ value is 0.0</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    EXPECT(dob2.value() == 0.0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_copy_ctor_inactive_copy&quot;</span>) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// because the cfg is empty when used,</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// the active_ flag is false and the bias1_ value is 0.0</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    EXPECT(dob2.value() == 0.0);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_copy_ctor_inactive_no_copy&quot;</span>) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// because the cfg is empty when used and the copy flag is false,</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// the active_ flag is false and the bias1_ value is 0.0</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    EXPECT(dob2.value() == 0.0);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_copy_constructor_config&quot;</span>) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1, *fix.conf_);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    EXPECT(dob2.value() == fix.bias1_);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_copy_constructor_no_config&quot;</span>) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1, eckit::LocalConfiguration());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// because the covarCfg is empty when used (regardless of the cfg),</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// the active_ flag is false and the bias1_ value is 0.0</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    EXPECT(dob2.value() == 0.0);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_diff_active&quot;</span>) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    lorenz95::ObsBias obias2(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    obias2.value() = fix.bias2_;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    lorenz95::ObsBiasCorrection dob(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    dob.diff(*fix.obias_, obias2);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    EXPECT(dob.value() == fix.bias1_ - fix.bias2_);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_diff_inactive&quot;</span>) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    lorenz95::ObsBias obias2(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    obias2.value() = fix.bias2_;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// construct the dob object with empty config</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    lorenz95::ObsBiasCorrection dob(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    dob.diff(*fix.obias_, obias2);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// because the OBC has empty config the active_flag is false and</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// the diff will not be performed, leaving the OBC value unchanged</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    EXPECT(dob.value() == 0.0);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_zero&quot;</span>) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    lorenz95::ObsBiasCorrection dob(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    dob.value() = fix.bias1_;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    dob.zero();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    EXPECT(dob.value() == 0.0);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_assignment_active&quot;</span>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    dob1 = dob2;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    EXPECT(dob1.value() == fix.bias2_);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_assignment_inactive&quot;</span>) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    dob1 = dob2;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// because the OBC has empty config the active_ flag is false</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    EXPECT(dob1.value() == 0.0);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_assignment_add_active&quot;</span>) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    dob1 += dob2;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    EXPECT(dob1.value() == fix.bias1_ + fix.bias2_);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_assign_add_inactive&quot;</span>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    dob1 += dob2;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// because the OBC has empty config, the bias value is unchanged</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    EXPECT(dob1.value() == fix.bias1_);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_assignment_subtract_active&quot;</span>) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    dob1 -= dob2;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    EXPECT(dob1.value() == fix.bias1_ - fix.bias2_);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_assignment_subtract_inactive&quot;</span>) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    dob1 -= dob2;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// because the OBC has empty config, the bias value is unchanged</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    EXPECT(dob1.value() == fix.bias1_);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_assignment_multiply_active&quot;</span>) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    lorenz95::ObsBiasCorrection dob(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    dob.value() = fix.bias1_;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    dob *= fix.fact_;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    EXPECT(dob.value() == fix.bias1_ * fix.fact_);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_assignment_multiply_inactive&quot;</span>) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    lorenz95::ObsBiasCorrection dob(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    dob.value() = fix.bias1_;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    dob *= fix.fact_;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// because the OBC has empty config, the bias value is unchanged</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    EXPECT(dob.value() == fix.bias1_);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_axpy_active&quot;</span>) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    dob1.axpy(fix.fact_, dob2);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    EXPECT(dob1.value() == fix.bias1_ + (fix.fact_ * fix.bias2_));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_axpy_inactive&quot;</span>) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    dob1.axpy(fix.fact_, dob2);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// because the OBC has empty config, the bias value is unchanged</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    EXPECT(dob1.value() == fix.bias1_);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_dot_product_with_active&quot;</span>) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">double</span> dpwResult = dob1.dot_product_with(dob2);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    EXPECT(dpwResult == fix.bias1_ * fix.bias2_);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_dot_product_with_inactive&quot;</span>) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    lorenz95::ObsBiasCorrection dob1(*fix.obstable_, *fix.off_);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    dob1.value() = fix.bias1_;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    lorenz95::ObsBiasCorrection dob2(dob1);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    dob2.value() = fix.bias2_;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">double</span> dpwResult = dob1.dot_product_with(dob2);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// because the OBC has empty config, the result is 0</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    EXPECT(dpwResult == 0.0);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_read&quot;</span>) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_write&quot;</span>) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCorrection_stream_output&quot;</span>) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    lorenz95::ObsBiasCorrection dob(*fix.obstable_, *fix.conf_);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    dob.value() = fix.bias1_;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// use the operator&lt;&lt; method to write the value to a file</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    std::filebuf fb;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    std::string filename(<span class="stringliteral">&quot;ObsBiasCorrectionTest.txt&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    fb.open(filename.c_str(), std::ios::out);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    std::ostream os(&amp;fb);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    os &lt;&lt; dob;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    fb.close();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// then read the value that was written to the file</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    std::string inputString;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    std::string inputBias;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">double</span> bias = 0.0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">int</span> biasStartPos = 20;  <span class="comment">// length of &quot;ObsBiasCorrection = &quot; is 20</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    std::ifstream inputFile(filename.c_str());</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (inputFile.is_open()) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      getline(inputFile, inputString);  <span class="comment">// ignore first (blank) line</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      getline(inputFile, inputString);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      inputBias = inputString.substr(biasStartPos);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        bias = eckit::Translator&lt;std::string, double&gt;()(inputBias);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">catch</span>(eckit::BadParameter <span class="keyword">const</span>&amp;) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; incorrectly output a non-double&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(fix.bias1_, bias, 0.0001));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="comment">// if we can&#39;t open the file then we can&#39;t</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">// verify that the value was correctly written</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    inputFile.close();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_afc3b6e9e4196a705b01fa054b9e28483_cgraph.png" border="0" usemap="#namespacetest_afc3b6e9e4196a705b01fa054b9e28483_cgraph" alt=""/></div>
<map name="namespacetest_afc3b6e9e4196a705b01fa054b9e28483_cgraph" id="namespacetest_afc3b6e9e4196a705b01fa054b9e28483_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,91,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="139,5,243,32"/>
</map>
</div>

</div>
</div>
<a id="a477fb0ed4be371d20d1b0f122a5d81d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a477fb0ed4be371d20d1b0f122a5d81d0">&#9670;&nbsp;</a></span>CASE() <span class="overload">[11/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_obsBiasCovariance&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="l95_2test_2lorenz95_2ObsBiasCovariance_8cc_source.html#l00053">53</a> of file <a class="el" href="l95_2test_2lorenz95_2ObsBiasCovariance_8cc_source.html">ObsBiasCovariance.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                               {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  ObsBiasTestFixture fix;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCovariance_constructor_conf&quot;</span>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    lorenz95::ObsBiasCovariance obcovar(*fix.obstable_, *fix.covconf_);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    EXPECT(obcovar.active() == <span class="keyword">true</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCovariance_constructor_no_conf&quot;</span>) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    lorenz95::ObsBiasCovariance obcovar(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    EXPECT(obcovar.active() == <span class="keyword">false</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCovariance_destructor&quot;</span>) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCovariance_linearize&quot;</span>) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// not yet implemented</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCovariance_multiply_active&quot;</span>) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    lorenz95::ObsBiasCovariance obcovar(*fix.obstable_, *fix.covconf_);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    lorenz95::ObsBiasCorrection db1(*fix.obstable_, *fix.covconf_);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    db1.value() = 2.0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    lorenz95::ObsBiasCorrection db2(db1, *fix.covconf_);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    obcovar.multiply(db1, db2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> stdev = fix.covconf_-&gt;getDouble(<span class="stringliteral">&quot;standard_deviation&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    EXPECT(db2.value() == db1.value() * stdev * stdev);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCovariance_multiply_inactive&quot;</span>) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    lorenz95::ObsBiasCovariance obcovar(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    lorenz95::ObsBiasCorrection db1(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    db1.value() = 2.0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    lorenz95::ObsBiasCorrection db2(db1, *fix.covconf_);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    obcovar.multiply(db1, db2);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// because the OBC has empty config, the bias is set to 0.0</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    EXPECT(db2.value() == 0.0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCovariance_invMult_active&quot;</span>) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    lorenz95::ObsBiasCovariance obcovar(*fix.obstable_, *fix.covconf_);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    lorenz95::ObsBiasCorrection db1(*fix.obstable_, *fix.covconf_);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    db1.value() = 2.0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    lorenz95::ObsBiasCorrection db2(db1, *fix.covconf_);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    obcovar.inverseMultiply(db1, db2);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> stdev = fix.covconf_-&gt;getDouble(<span class="stringliteral">&quot;standard_deviation&quot;</span>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    EXPECT(db2.value() == db1.value() * 1.0 / (stdev * stdev));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  SECTION(<span class="stringliteral">&quot;test_obsBiasCovariance_invMult_inactive&quot;</span>) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    lorenz95::ObsBiasCovariance obcovar(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    lorenz95::ObsBiasCorrection db1(*fix.obstable_, *fix.nobias_);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    db1.value() = 2.0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    lorenz95::ObsBiasCorrection db2(db1, *fix.covconf_);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    obcovar.inverseMultiply(db1, db2);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// because the OBC has empty config, the bias is set to 0.0</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    EXPECT(db2.value() == 0.0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7df81f38a936f3a9f697f966833edbdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7df81f38a936f3a9f697f966833edbdd">&#9670;&nbsp;</a></span>CASE() <span class="overload">[12/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_ObsL95&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2ObservationL95_8cc_source.html#l00045">45</a> of file <a class="el" href="test_2lorenz95_2ObservationL95_8cc_source.html">ObservationL95.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                    {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  ObsTestFixture fix;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsL95_constructor&quot;</span>) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    std::unique_ptr&lt;lorenz95::ObservationL95&gt;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      obs(<span class="keyword">new</span> lorenz95::ObservationL95(*fix.ot_, TestConfig::config()));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    EXPECT(obs.get() != NULL);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  SECTION(<span class="stringliteral">&quot;test_observationL95_classname&quot;</span>) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    std::unique_ptr&lt;lorenz95::ObservationL95&gt;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      obs(<span class="keyword">new</span> lorenz95::ObservationL95(*fix.ot_, TestConfig::config()));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    EXPECT(obs-&gt;classname() == <span class="stringliteral">&quot;lorenz95::ObservationL95&quot;</span>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad33f2e5283ade82228ccce4b52af282b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad33f2e5283ade82228ccce4b52af282b">&#9670;&nbsp;</a></span>CASE() <span class="overload">[13/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_ObsTable&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2ObsTable_8cc_source.html#l00047">47</a> of file <a class="el" href="test_2lorenz95_2ObsTable_8cc_source.html">ObsTable.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                      {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  ObsTableTestFixture fix;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsTable_constructor&quot;</span>) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    std::unique_ptr&lt;lorenz95::ObsTable&gt;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      ot(<span class="keyword">new</span> lorenz95::ObsTable(*fix.testconf_, *fix.resol_, *fix.bgn_, *fix.end_));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    EXPECT(ot.get() != NULL);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsTable_nobs&quot;</span>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    std::unique_ptr&lt;lorenz95::ObsTable&gt;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      ot(<span class="keyword">new</span> lorenz95::ObsTable(*fix.testconf_, *fix.resol_, *fix.bgn_, *fix.end_));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nobs = 160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    EXPECT(ot-&gt;nobs() == nobs);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  SECTION(<span class="stringliteral">&quot;test_observationL95_put_get&quot;</span>) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    std::unique_ptr&lt;lorenz95::ObsTable&gt;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      ot(<span class="keyword">new</span> lorenz95::ObsTable(*fix.testconf_, *fix.resol_, *fix.bgn_, *fix.end_));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nn = ot-&gt;nobs();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    std::vector&lt;double&gt; v1(nn);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj = 0; jj &lt; nn; ++jj) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      v1[jj] = 3.14*jj;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    ot-&gt;putdb(<span class="stringliteral">&quot;ObsTest&quot;</span>, v1);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    std::vector&lt;double&gt; v2;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    ot-&gt;getdb(<span class="stringliteral">&quot;ObsTest&quot;</span>, v2);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    EXPECT(v2.size() == nn);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj = 0; jj &lt; nn; ++jj) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      EXPECT(v2[jj] == v1[jj]);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  SECTION(<span class="stringliteral">&quot;test_observationL95_timeSelect&quot;</span>) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    std::unique_ptr&lt;lorenz95::ObsTable&gt;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      ot(<span class="keyword">new</span> lorenz95::ObsTable(*fix.testconf_, *fix.resol_, *fix.bgn_, *fix.end_));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    util::DateTime t1(<span class="stringliteral">&quot;2010-01-01T09:00:00Z&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    util::DateTime t2(<span class="stringliteral">&quot;2010-01-01T21:00:00Z&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    std::vector&lt;int&gt; mask = ot-&gt;timeSelect(t1, t2);  <span class="comment">// t1 not includede, t2 is</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = 80;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    EXPECT(mask.size() == size);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    EXPECT(mask[0] == 40);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    EXPECT(mask[79] == 119);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  SECTION(<span class="stringliteral">&quot;test_observationL95_locations&quot;</span>) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    std::unique_ptr&lt;lorenz95::ObsTable&gt;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      ot(<span class="keyword">new</span> lorenz95::ObsTable(*fix.testconf_, *fix.resol_,  *fix.bgn_, *fix.end_));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    util::DateTime t1(<span class="stringliteral">&quot;2010-01-01T09:00:00Z&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    util::DateTime t2(<span class="stringliteral">&quot;2010-01-01T21:00:00Z&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    std::vector&lt;double&gt; locs = ot-&gt;locations(t1, t2);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = 80;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    EXPECT(locs.size() == size);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  SECTION(<span class="stringliteral">&quot;test_observationL95_distribute&quot;</span>) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    eckit::LocalConfiguration otconf;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    util::DateTime t1(<span class="stringliteral">&quot;2010-01-01T00:00:00Z&quot;</span>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    util::DateTime t2(<span class="stringliteral">&quot;2010-01-02T23:59:59Z&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    std::unique_ptr&lt;lorenz95::ObsTable&gt;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      ot(<span class="keyword">new</span> lorenz95::ObsTable(otconf, *fix.resol_, t1, t2));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// More complete test in makeobs* tests.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    eckit::LocalConfiguration genconf(*fix.obsconf_, <span class="stringliteral">&quot;Generate&quot;</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ot-&gt;generateDistribution(genconf);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55819a0afd980b2e0a27143f9535abd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55819a0afd980b2e0a27143f9535abd8">&#9670;&nbsp;</a></span>CASE() <span class="overload">[14/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_ObsVec1D&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2ObsVec1D_8cc_source.html#l00047">47</a> of file <a class="el" href="test_2lorenz95_2ObsVec1D_8cc_source.html">ObsVec1D.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                      {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  ObsVecTestFixture fix;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_constructor&quot;</span>) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    EXPECT(ov.get() != NULL);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      EXPECT((*ov)(ii) == 0.0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_nobs&quot;</span>) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    EXPECT(ov-&gt;size() == fix.obstable_-&gt;nobs());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_read&quot;</span>) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    ov-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      EXPECT((*ov)(ii) != 0.0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_copy_constructor_copy&quot;</span>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      EXPECT((*ov2)(ii) == (*ov1)(ii));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_copy_constructor_no_copy&quot;</span>) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      EXPECT((*ov2)(ii) == 0.0);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_classname&quot;</span>) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    EXPECT(ov-&gt;classname() == <span class="stringliteral">&quot;lorenz95::ObsVec1D&quot;</span>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_assignment&quot;</span>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// use the assignment operator to populate the second ObsVec1D object</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    *ov2 = *ov1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      EXPECT((*ov2)(ii) == (*ov1)(ii));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_compound_assignment_multiply_double&quot;</span>) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// create a random double value</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">double</span> mult = 7.92;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    *ov2 *= mult;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      EXPECT((*ov2)(ii) == (*ov1)(ii) * mult);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_compound_assignment_add&quot;</span>) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    *ov1 += *ov2;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      EXPECT((*ov1)(ii) == (*ov2)(ii) + (*ov2)(ii));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_compound_assignment_subtract&quot;</span>) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    *ov1 -= *ov2;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      EXPECT((*ov1)(ii) == 0.0);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_compound_assignment_multiply&quot;</span>) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    *ov1 *= *ov2;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      EXPECT((*ov1)(ii) == (*ov2)(ii) * (*ov2)(ii));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_compound_assignment_divide&quot;</span>) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    *ov1 /= *ov2;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      EXPECT((*ov1)(ii) == 1.0);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_zero&quot;</span>) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    ov-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    ov-&gt;zero();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      EXPECT((*ov)(ii) == 0.0);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_axpy&quot;</span>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">double</span> mult = 2.00;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    ov1-&gt;axpy(mult, *ov2);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      EXPECT((*ov1)(ii) == (*ov2)(ii) + mult * (*ov2)(ii));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_invert&quot;</span>) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    ov1-&gt;invert();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      EXPECT((*ov1)(ii) == 1.0 / (*ov2)(ii));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_random&quot;</span>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    ov-&gt;random();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      EXPECT((*ov)(ii) != 0);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  SECTION(<span class="stringliteral">&quot;test_ObsVec1D_dot_product_with&quot;</span>) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov1(<span class="keyword">new</span> lorenz95::ObsVec1D(*fix.obstable_));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    ov1-&gt;read(<span class="stringliteral">&quot;ObsVal&quot;</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    std::unique_ptr&lt;lorenz95::ObsVec1D&gt; ov2(<span class="keyword">new</span> lorenz95::ObsVec1D(*ov1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">double</span> result = ov1-&gt;dot_product_with(*ov2);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">double</span> check = 0.0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; fix.obstable_-&gt;nobs(); ++ii) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      check += (*ov2)(ii) * (*ov2)(ii);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(result, check, 1.0e-8));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a55819a0afd980b2e0a27143f9535abd8_cgraph.png" border="0" usemap="#namespacetest_a55819a0afd980b2e0a27143f9535abd8_cgraph" alt=""/></div>
<map name="namespacetest_a55819a0afd980b2e0a27143f9535abd8_cgraph" id="namespacetest_a55819a0afd980b2e0a27143f9535abd8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,91,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="139,5,243,32"/>
</map>
</div>

</div>
</div>
<a id="a1c9d87071f82b1eea1478990acf163ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c9d87071f82b1eea1478990acf163ae">&#9670;&nbsp;</a></span>CASE() <span class="overload">[15/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_resolution&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Resolution_8cc_source.html#l00041">41</a> of file <a class="el" href="Resolution_8cc_source.html">Resolution.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                        {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  ResolutionTestFixture fix;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  SECTION(<span class="stringliteral">&quot;test_resolution_constructor&quot;</span>) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    std::unique_ptr&lt;lorenz95::Resolution&gt; resol(<span class="keyword">new</span> lorenz95::Resolution(*fix.testconf_));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    EXPECT(resol.get() != NULL);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  SECTION(<span class="stringliteral">&quot;test_resolution_copy_constructor&quot;</span>) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    std::unique_ptr&lt;lorenz95::Resolution&gt; xx(<span class="keyword">new</span> lorenz95::Resolution(*fix.testconf_));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    std::unique_ptr&lt;lorenz95::Resolution&gt; resol(<span class="keyword">new</span> lorenz95::Resolution(*xx));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    EXPECT(resol.get() != NULL);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  SECTION(<span class="stringliteral">&quot;test_resolution_get_npoints&quot;</span>) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    std::unique_ptr&lt;lorenz95::Resolution&gt; resol(<span class="keyword">new</span> lorenz95::Resolution(*fix.testconf_));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    EXPECT(resol-&gt;npoints() == fix.testconf_-&gt;getInt(<span class="stringliteral">&quot;resol&quot;</span>));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  SECTION(<span class="stringliteral">&quot;test_resolution_stream_output&quot;</span>) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    std::unique_ptr&lt;lorenz95::Resolution&gt; resol(<span class="keyword">new</span> lorenz95::Resolution(*fix.testconf_));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// use the operator&lt;&lt; method to write the value to a file</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    std::filebuf fb;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    std::string filename(<span class="stringliteral">&quot;ResolutionTest.txt&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    fb.open(filename.c_str(), std::ios::out);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    std::ostream os(&amp;fb);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    os &lt;&lt; *resol.get();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    fb.close();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// then read the value that was written to the file</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">int</span> inputInt;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    std::string input;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    std::ifstream inputFile(filename.c_str());</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (inputFile.is_open()) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      getline(inputFile, input);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        inputInt = eckit::Translator&lt;std::string, int&gt;()(input);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">catch</span>(eckit::BadParameter <span class="keyword">const</span>&amp;) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// test fails because the value written to</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="comment">// the file can&#39;t be converted to an integer</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        oops::Log::error() &lt;&lt;<span class="stringliteral">&quot;operator&lt;&lt; incorrectly output a non-integer&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="comment">// it should equal the value that was used in the constructor</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      EXPECT(inputInt == resol-&gt;npoints());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="comment">// if we can&#39;t open the file then we can&#39;t</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">// verify that the value was correctly written</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;operator&lt;&lt; functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    inputFile.close();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64f8f0694ad7b5d8ccf2fe78b9abf25e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64f8f0694ad7b5d8ccf2fe78b9abf25e">&#9670;&nbsp;</a></span>CASE() <span class="overload">[16/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_StateL95&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2StateL95_8cc_source.html#l00062">62</a> of file <a class="el" href="test_2lorenz95_2StateL95_8cc_source.html">StateL95.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                      {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  StateTestFixture fix;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_readin_constructor&quot;</span>) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    std::unique_ptr&lt;lorenz95::StateL95&gt;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      xx(<span class="keyword">new</span> lorenz95::StateL95(*fix.resol_, *fix.model_, *fix.file_));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    EXPECT(xx.get() != NULL);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_interpolation_constructor&quot;</span>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    lorenz95::StateL95 xx1(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    std::unique_ptr&lt;lorenz95::StateL95&gt; xx2(<span class="keyword">new</span> lorenz95::StateL95(*fix.resol_, *fix.model_, xx1));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    EXPECT(xx2.get() != NULL);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_copy_constructor&quot;</span>) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    lorenz95::StateL95 xx(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    std::unique_ptr&lt;lorenz95::StateL95&gt; xx2(<span class="keyword">new</span> lorenz95::StateL95(xx));</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    EXPECT(xx2.get() != NULL);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_destructor&quot;</span>) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// nothing to test</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_getField&quot;</span>) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    lorenz95::StateL95 xx(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// there are 2 values in FieldL95: the 1st is the *resol_ value,</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// the 2nd is a vector of doubles initialised to 0.0, the size of the</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// vector is the *resol_ value</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    EXPECT(xx.getField().resol() == fix.resol_-&gt;npoints());</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_validTime&quot;</span>) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    lorenz95::StateL95 xx(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    EXPECT(xx.validTime().toString() == fix.date_str_);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_assignment&quot;</span>) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    lorenz95::StateL95 xx1(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// construct the second StateL95 object</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    lorenz95::StateL95 xx2(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    xx2 = xx1;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// initially, xx1 held data, xx2 was initialised to 0, now</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// ensure the two stateL95s are the same</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    EXPECT(xx1.validTime() == xx2.validTime());</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    EXPECT(xx1.getField().resol() == xx2.getField().resol());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; xx1.getField().resol(); ++i) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      EXPECT(xx1.getField()[i] == xx2.getField()[i]);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_compound_assignment&quot;</span>) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    lorenz95::StateL95 xx(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// construct the incrementL95 object</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    lorenz95::IncrementL95 dx(*fix.resol_, *fix.vars_, *fix.time_);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    dx.read(*fix.file_);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    xx += dx;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// both xx and dx were initialised with the same data,</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// so when the two are added together xx should be double incL95</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; xx.getField().resol(); ++i) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      EXPECT(xx.getField()[i] == 2.0 * dx.getField()[i]);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_read&quot;</span>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    lorenz95::StateL95 xx(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// to verify the information has been read correctly, we need to open</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// and read the file using ifstream functionality</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">const</span> std::string filename(fix.file_-&gt;getString(<span class="stringliteral">&quot;filename&quot;</span>));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    std::ifstream inStream(filename.c_str());</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (!inStream.is_open()) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      oops::Log::error() &lt;&lt; <span class="stringliteral">&quot;read functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">int</span> resolInt;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    inStream &gt;&gt; resolInt;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::string time;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    inStream &gt;&gt; time;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    std::vector&lt;double&gt; doubleVec(resolInt);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; resolInt; ++i) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      inStream &gt;&gt; doubleVec[i];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    inStream.close();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fix.resol_-&gt;npoints(); ++i) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      EXPECT((xx.getField())[i] == doubleVec[i]);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  SECTION(<span class="stringliteral">&quot;test_stateL95_timeUpdate&quot;</span>) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    lorenz95::StateL95 xx(*fix.resol_, *fix.model_, *fix.file_);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    util::Duration dur(10);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    util::DateTime updatedTime(*fix.time_);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    updatedTime += dur;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    std::string updated_date_string(updatedTime.toString());</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    xx.validTime() += dur;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    EXPECT(xx.validTime().toString() == updated_date_string);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">  SECTION(&quot;test_stateL95_stream_output&quot;) {</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">    lorenz95::StateL95 xx(*fix.resol_, *fix.vars_, *fix.time_);</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">    xx.read(*fix.file_);</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">    // use the operator&lt;&lt; method to write the value to a file</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">    std::filebuf fb;</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">    std::string filename(&quot;StateL95Test.txt&quot;);</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">    fb.open(filename.c_str(), std::ios::out);</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">    std::ostream os(&amp;fb);</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">    os &lt;&lt; xx;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">    fb.close();</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">    std::vector&lt;double&gt; doubleVec(xx.getField().resol());</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">    for (int i = 0; i &lt; xx.getField().resol(); ++i) {</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">      doubleVec[i] = xx.getField()[i];</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">    std::vector&lt;double&gt;::iterator iter;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">    iter = std::min_element(doubleVec.begin(), doubleVec.end());</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">    double min = *iter;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">    iter = std::max_element(doubleVec.begin(), doubleVec.end());</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">    double max = *iter;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">//    double avg = 0.0;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">    // then read the values that were written to the file</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">    int idxStart;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    int idxEnd;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">    double inputDouble = 0.0;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">    std::string input;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">    std::string inputTest;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">    std::string inputTimeTest(&quot; Valid time: &quot; + fix.file_-&gt;getString(&quot;date&quot;));</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">    std::ifstream inputFile(filename.c_str());</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">    if (inputFile.is_open()) {</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">      getline(inputFile, input);  // ignore the first (blank) line</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">      getline(inputFile, input);</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">      EXPECT(input == inputTimeTest);</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">      getline(inputFile, input);</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">      // test min value</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">      idxStart = input.find(&quot;=&quot;);</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">      idxEnd = input.find(&quot;,&quot;);</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">      inputTest = input.substr(idxStart + 1, (idxEnd - 1) - idxStart);</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">      inputDouble = eckit::Translator&lt;std::string, double&gt;()(inputTest);</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">      EXPECT(oops::is_close(inputDouble, min, 0.0001));</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">      // test max value</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">      idxStart = input.find(&quot;=&quot;, idxEnd);</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">      idxEnd = input.find(&quot;,&quot;, idxEnd + 1);</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">      inputTest = input.substr(idxStart + 1, (idxEnd - 1) - idxStart);</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">      inputDouble = eckit::Translator&lt;std::string, double&gt;()(inputTest);</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">      EXPECT(oops::is_close(inputDouble, max, 0.0001));</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">      // test avg value</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">//      idxStart = input.find(&quot;=&quot;, idxEnd + 1);</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">//      idxEnd = input.find(&quot;,&quot;, idxEnd + 1);</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">//      inputTest = input.substr(idxStart + 1);</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">//      inputDouble = eckit::Translator&lt;std::string, double&gt;()(inputTest);</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">//      EXPECT(oops::is_close(inputDouble, avg, 0.0001));</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">    } else {</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">      // if we can&#39;t open the file then we can&#39;t</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">      // verify that the value was correctly written</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">      oops::Log::error() &lt;&lt; &quot;operator&lt;&lt; functionality cannot be determined&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">    inputFile.close();</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">//  SECTION(&quot;test_stateL95_step_traj&quot;) {</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">//    lorenz95::StateL95 xx(*fix.resol_, *fix.vars_, *fix.time_);</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">//    xx.read(*fix.file_);</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">//    // construct a ModelL95 object</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">//    eckit::LocalConfiguration modelCfg(TestConfig::config(), &quot;model&quot;);</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">//    lorenz95::ModelL95 modelL95(*fix.resol_, modelCfg);</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">//    // construct a ModelBias object</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">//    eckit::LocalConfiguration biasCfg(TestConfig::config(), &quot;ModelBias&quot;);</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">//    lorenz95::ModelBias modelBias(*fix.resol_, biasCfg);</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">//    // construct a ModelTrajectory object</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">//    lorenz95::ModelTrajectory modelTraj(true);</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">//    // copy construct a FieldL95 object to set params</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">//    // in the ModelTrajectory object</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">//    lorenz95::FieldL95 fieldL95(xx.getField());</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">//    modelTraj.set(fieldL95);</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">//    xx.stepTraj(modelL95, modelBias, modelTraj);</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">//    // create test data</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//    modelL95.stepRK(fieldL95, modelBias, modelTraj);</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">//    // test xx data against newly created fieldL95 test data</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">//    for(int i = 0; i &lt; xx.getField().resol(); ++i) {</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">//      EXPECT(xx.getField()[i] == fieldL95[i]);</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa51b7609b53d46d45da3b24e50c0011f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa51b7609b53d46d45da3b24e50c0011f">&#9670;&nbsp;</a></span>CASE() <span class="overload">[17/17]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">test::CASE </td>
          <td>(</td>
          <td class="paramtype">&quot;test_tlmL95&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2lorenz95_2TLML95_8cc_source.html#l00055">55</a> of file <a class="el" href="test_2lorenz95_2TLML95_8cc_source.html">TLML95.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                    {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  TlmTestFixture fix;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  SECTION(<span class="stringliteral">&quot;test_tlmL95_constructor&quot;</span>) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    std::unique_ptr&lt;lorenz95::TLML95&gt; tlm(<span class="keyword">new</span> lorenz95::TLML95(*fix.resol_, *fix.tlconf_));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    EXPECT(tlm.get() != NULL);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">  SECTION(&quot;test_tlmL95_set_get_Trajectory&quot;) {</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">    lorenz95::TLML95 tlm(*fix.resol_, *fix.tlconf_, *fix.model_);</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    // construct a StateL95 object</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">    std::string date_string(&quot;2014-09-12T09:35:00Z&quot;);</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">    util::DateTime dt(date_string);</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">    oops::Variables vars();</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">    std::unique_ptr&lt;lorenz95::StateL95&gt; stateL95(new lorenz95::StateL95(*fix.resol_, vars, dt));</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">    // construct a ModelBias object</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">    std::shared_ptr&lt;const eckit::LocalConfiguration&gt; biasCfg(new eckit::LocalConfiguration(TestConfig::config(), &quot;ModelBias&quot;));</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">    std::unique_ptr&lt;lorenz95::ModelBias&gt; modelBias(new lorenz95::ModelBias(*biasCfg, *fix.resol_));</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">    tlm.setTrajectory(*stateL95, *modelBias);</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">    std::unique_ptr&lt;lorenz95::ModelTrajectory&gt; modelTraj(new lorenz95::ModelTrajectory(true));</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">    oops::Log::error() &lt;&lt; &quot;PMC: getTraj result &lt;&quot; &lt;&lt; tlm.getTrajectory(dt)-&gt;get(1) &lt;&lt; &quot;&gt;&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">    modelTraj-&gt;set(tlm.getTrajectory(dt)-&gt;get(1));</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">    //oops::Log::error() &lt;&lt; &quot;PMC: modelTraj 1st &quot; &lt;&lt; modelTraj-&gt;get(1)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    oops::Log::error() &lt;&lt; &quot;PMC: modelTraj resol  &lt;&quot; &lt;&lt; modelTraj-&gt;get(1).resol() &lt;&lt; &quot;&gt;&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">    for(int i = 0; i &lt; modelTraj-&gt;get(1).resol(); ++i) {</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">      oops::Log::error() &lt;&lt; &quot;PMC: modelTraj FieldL95 elements &quot; &lt;&lt; modelTraj-&gt;get(1)[i] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">  SECTION(&quot;test_tlmL95_stepTL&quot;) {</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">    lorenz95::TLML95 tlm(*fix.resol_, *fix.tlconf_, *fix.model_);</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    // construct a FieldL95 object</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    std::unique_ptr&lt;lorenz95::FieldL95&gt; fieldL95(new lorenz95::FieldL95(*fix.resol_));</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    // construct a datetime object</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">    std::string dateString(&quot;2014-10-08T11:25:45Z&quot;);</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">    util::DateTime dt(dateString);</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    //construct a ModelBiasCorrection object</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">    std::unique_ptr&lt;const eckit::LocalConfiguration&gt; covarCfg(new eckit::LocalConfiguration(TestConfig::config(), &quot;Covariance&quot;));</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">    std::unique_ptr&lt;lorenz95::ModelBiasCovariance&gt; modelBiasCovariance(</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">        new lorenz95::ModelBiasCovariance(*covarCfg, *fix.resol_));</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">    std::unique_ptr&lt;lorenz95::ModelBiasCorrection&gt; modelBiasCorrection(</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">        new lorenz95::ModelBiasCorrection(*modelBiasCovariance));</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">    tlm.stepTL(*fieldL95, dt, *modelBiasCorrection);</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    oops::Log::error() &lt;&lt; &quot;PMC: original dt was &quot; &lt;&lt; dateString &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">    oops::Log::error() &lt;&lt; &quot;PMC: modified dt is  &quot; &lt;&lt; dt.toString() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">  SECTION(&quot;test_tlmL95_stepAD&quot;) {</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  SECTION(<span class="stringliteral">&quot;test_tlmL95_get_classname&quot;</span>) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    lorenz95::TLML95 tlm(*fix.resol_, *fix.tlconf_);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    EXPECT(tlm.classname() == <span class="stringliteral">&quot;lorenz95::TLML95&quot;</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  SECTION(<span class="stringliteral">&quot;test_tlmL95_get_timestep&quot;</span>) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    lorenz95::TLML95 tlm(*fix.resol_, *fix.tlconf_);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    util::Duration dt(fix.tlconf_-&gt;getString(<span class="stringliteral">&quot;tstep&quot;</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    EXPECT(tlm.timeResolution().toSeconds() == dt.toSeconds());</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  SECTION(<span class="stringliteral">&quot;test_tlmL95_get_resolution&quot;</span>) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    eckit::LocalConfiguration rescf(TestConfig::config(), <span class="stringliteral">&quot;resolution&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    lorenz95::Resolution resol(rescf);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    lorenz95::TLML95 tlm(*fix.resol_, *fix.tlconf_);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    EXPECT(tlm.resolution().npoints() == resol.npoints());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  SECTION(<span class="stringliteral">&quot;test_tlmL95_stream_output&quot;</span>) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    lorenz95::TLML95 tlm(*fix.resol_, *fix.tlconf_);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// use the operator&lt;&lt; method to write the value to a file</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    std::filebuf fb;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    std::string filename(<span class="stringliteral">&quot;TLML95Test.txt&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    fb.open(filename.c_str(), std::ios::out);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    std::ostream os(&amp;fb);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    os &lt;&lt; tlm;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    fb.close();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// then read the value that was written to the file</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::string inputString;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    std::string inputStartsWith;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    std::string testString(<span class="stringliteral">&quot;TLML95: resol = &quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">int</span> endPos = testString.size();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    std::ifstream inputFile(filename.c_str());</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (inputFile.is_open()) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      getline(inputFile, inputString);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      inputStartsWith = inputString.substr(0, endPos);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      EXPECT(inputStartsWith == testString);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="comment">// if we can&#39;t open the file then we can&#39;t</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="comment">// verify that the value was correctly written</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      oops::Log::error() &lt;&lt;<span class="stringliteral">&quot;operator&lt;&lt; functionality cannot be determined&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    inputFile.close();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}  <span class="comment">//  CASE</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aada6b2f311113e191f7e0668f7bf792f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aada6b2f311113e191f7e0668f7bf792f">&#9670;&nbsp;</a></span>test_normal_real_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::int32_t test::test_normal_real_f </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration *const *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad29d6580d50e94a470227e758ee85fe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad29d6580d50e94a470227e758ee85fe4">&#9670;&nbsp;</a></span>test_uniform_int_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::int32_t test::test_uniform_int_f </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration *const *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a98b248abc7fe65ce82ecf904fa7a8650"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98b248abc7fe65ce82ecf904fa7a8650">&#9670;&nbsp;</a></span>test_uniform_real_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::int32_t test::test_uniform_real_f </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration *const *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is intended as a general interface for testing objects in the <b>util</b> namespace from Fortran </p>

</div>
</div>
<a id="adc082c130e67563751c45ba53e9dd1c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc082c130e67563751c45ba53e9dd1c6">&#9670;&nbsp;</a></span>testChangeRes()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testChangeRes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxControl_8h_source.html#l00108">108</a> of file <a class="el" href="test_2interface_2ModelAuxControl_8h_source.html">ModelAuxControl.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                     {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxControlFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">using</span> ModelAux_ = <a class="code" href="classoops_1_1ModelAuxControl.html">oops::ModelAuxControl&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  std::unique_ptr&lt;ModelAux_&gt; bias(</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keyword">new</span> ModelAux_(Test_::resol(), Test_::model(), Test_::config()));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  std::unique_ptr&lt;ModelAux_&gt; other(<span class="keyword">new</span> ModelAux_(Test_::resol(), *bias));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  EXPECT(other.get());</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  other.reset();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  EXPECT(!other.get());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  EXPECT(bias.get());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe93d1d3b3b467f2cccd8b1c11484a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe93d1d3b3b467f2cccd8b1c11484a2e">&#9670;&nbsp;</a></span>testConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Geometry_8h_source.html#l00057">57</a> of file <a class="el" href="test_2interface_2Geometry_8h_source.html">Geometry.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                       {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keyword">using</span> Geometry_ = <a class="code" href="classoops_1_1Geometry.html">oops::Geometry&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  std::unique_ptr&lt;Geometry_&gt; geom(</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">new</span> Geometry_(GeometryFixture&lt;MODEL&gt;::getConfig()));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  EXPECT(geom.get());</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  geom.reset();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  EXPECT(!geom.get());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a982f56aedee487345fbfdb30b5ca886e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a982f56aedee487345fbfdb30b5ca886e">&#9670;&nbsp;</a></span>testConstructors()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testConstructors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Locations_8h_source.html#l00080">80</a> of file <a class="el" href="test_2interface_2Locations_8h_source.html">Locations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                        {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">using</span> Locations_ = <a class="code" href="classoops_1_1Locations.html">oops::Locations&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  std::unique_ptr&lt;Locations_&gt; locs(<span class="keyword">new</span> Locations_(</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      LocationsFixture&lt;MODEL&gt;::getObSpace(), LocationsFixture&lt;MODEL&gt;::gett1(),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      LocationsFixture&lt;MODEL&gt;::gett2()));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  EXPECT(locs.get());</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  locs.reset();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  EXPECT(!locs.get());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a947678f81f6139e1abbf436739e0fde4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a947678f81f6139e1abbf436739e0fde4">&#9670;&nbsp;</a></span>testCopyConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testCopyConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Geometry_8h_source.html#l00071">71</a> of file <a class="el" href="test_2interface_2Geometry_8h_source.html">Geometry.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                           {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">using</span> Geometry_ = <a class="code" href="classoops_1_1Geometry.html">oops::Geometry&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  std::unique_ptr&lt;Geometry_&gt; geom(</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keyword">new</span> Geometry_(GeometryFixture&lt;MODEL&gt;::getConfig()));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  std::unique_ptr&lt;Geometry_&gt; other(<span class="keyword">new</span> Geometry_(*geom));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  EXPECT(other.get());</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  other.reset();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  EXPECT(!other.get());</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  EXPECT(geom.get());</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a194d99e938e0d7b626319787003b8871"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a194d99e938e0d7b626319787003b8871">&#9670;&nbsp;</a></span>testErrorCovarianceInverse()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testErrorCovarianceInverse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ErrorCovariance_8h_source.html#l00143">143</a> of file <a class="el" href="test_2interface_2ErrorCovariance_8h_source.html">ErrorCovariance.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                  {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keyword">using</span> Test_ = ErrorCovarianceFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> testinverse = Test_::test().getBool(<span class="stringliteral">&quot;testinverse&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (testinverse) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    Increment_ dx1(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    Increment_ dx2(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    Increment_ dx3(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    Test_::covariance().randomize(dx1);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    EXPECT(dx1.norm() &gt; 0.0);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    Test_::covariance().multiply(dx1, dx2);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    Test_::covariance().inverseMultiply(dx2, dx3);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    EXPECT(dx2.norm() &gt; 0.0);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    EXPECT(dx3.norm() &gt; 0.0);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    dx3 -= dx1;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> tol = Test_::test().getDouble(<span class="stringliteral">&quot;tolerance&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    EXPECT(dx3.norm() / dx1.norm() &lt; tol);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b80a6d456d44d7df67b9749aad0235e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b80a6d456d44d7df67b9749aad0235e">&#9670;&nbsp;</a></span>testErrorCovarianceSym()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testErrorCovarianceSym </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ErrorCovariance_8h_source.html#l00171">171</a> of file <a class="el" href="test_2interface_2ErrorCovariance_8h_source.html">ErrorCovariance.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                              {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keyword">using</span> Test_ = ErrorCovarianceFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  Increment_ dx(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  Increment_ Bdx(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  Increment_ dy(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  Increment_ Bdy(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  dx.random();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  dy.random();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  Test_::covariance().multiply(dx, Bdx);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  Test_::covariance().multiply(dy, Bdy);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> zz1 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx, Bdy);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> zz2 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(Bdx, dy);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  oops::Log::info() &lt;&lt; <span class="stringliteral">&quot;&lt;dx,Bdy&gt;-&lt;Bdx,dy&gt;/&lt;dx,Bdy&gt;=&quot;</span> &lt;&lt; (zz1 - zz2) / zz1</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  oops::Log::info() &lt;&lt; <span class="stringliteral">&quot;&lt;dx,Bdy&gt;-&lt;Bdx,dy&gt;/&lt;Bdx,dy&gt;=&quot;</span> &lt;&lt; (zz1 - zz2) / zz2</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> tol = Test_::test().getDouble(<span class="stringliteral">&quot;tolerance&quot;</span>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(zz1, zz2, tol));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dot__product_8h_source.html#l00017">dot_product()</a>, and <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a5b80a6d456d44d7df67b9749aad0235e_cgraph.png" border="0" usemap="#namespacetest_a5b80a6d456d44d7df67b9749aad0235e_cgraph" alt=""/></div>
<map name="namespacetest_a5b80a6d456d44d7df67b9749aad0235e_cgraph" id="namespacetest_a5b80a6d456d44d7df67b9749aad0235e_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,196,57"/>
<area shape="rect" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a" title="Syntactic sugar to let us use a more mathematical notation for dot products." alt="" coords="251,5,341,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="244,56,348,83"/>
</map>
</div>

</div>
</div>
<a id="adfb577b9c0284083b93dc63def9e411c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb577b9c0284083b93dc63def9e411c">&#9670;&nbsp;</a></span>testErrorCovarianceZero()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testErrorCovarianceZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ErrorCovariance_8h_source.html#l00110">110</a> of file <a class="el" href="test_2interface_2ErrorCovariance_8h_source.html">ErrorCovariance.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                               {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keyword">using</span> Test_ = ErrorCovarianceFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  Increment_ dx1(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  Increment_ dx2(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  Test_::covariance().randomize(dx2);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  oops::Log::info() &lt;&lt; <span class="stringliteral">&quot;dx2.norm()=&quot;</span> &lt;&lt; dx2.norm() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  EXPECT(dx1.norm() == 0.0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  EXPECT(dx2.norm() &gt; 0.0);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  Test_::covariance().multiply(dx1, dx2);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  EXPECT(dx2.norm() == 0.0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> testinverse = Test_::test().getBool(<span class="stringliteral">&quot;testinverse&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (testinverse) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    oops::Log::info() &lt;&lt; <span class="stringliteral">&quot;Doing zero test for inverse&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    dx1.zero();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    Test_::covariance().randomize(dx2);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    EXPECT(dx1.norm() == 0.0);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    EXPECT(dx2.norm() &gt; 0.0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    Test_::covariance().inverseMultiply(dx1, dx2);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    EXPECT(dx2.norm() == 0.0);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    oops::Log::info() &lt;&lt; <span class="stringliteral">&quot;Not doing zero test for inverse&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a71da8a6a816cb575c85340db5754ea4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71da8a6a816cb575c85340db5754ea4a">&#9670;&nbsp;</a></span>testIncrementAxpy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testIncrementAxpy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Increment_8h_source.html#l00204">204</a> of file <a class="el" href="test_2interface_2Increment_8h_source.html">Increment.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                         {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keyword">using</span> Test_ = IncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  Increment_ dx1(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  dx1.random();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// test axpy</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  Increment_ dx2(dx1);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  dx2.axpy(2.0, dx1);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  EXPECT(dx2.norm() &lt; 1e-8);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6c109da2ad2df0e707fafdfb3468bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6c109da2ad2df0e707fafdfb3468bd6">&#9670;&nbsp;</a></span>testIncrementConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testIncrementConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Increment_8h_source.html#l00093">93</a> of file <a class="el" href="test_2interface_2Increment_8h_source.html">Increment.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">using</span> Test_ = IncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  Increment_ dx(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a64527c7c93e0849358a4704857846703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64527c7c93e0849358a4704857846703">&#9670;&nbsp;</a></span>testIncrementCopyConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testIncrementCopyConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Increment_8h_source.html#l00105">105</a> of file <a class="el" href="test_2interface_2Increment_8h_source.html">Increment.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                    {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">using</span> Test_ = IncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  Increment_ dx1(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  dx1.random();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  EXPECT(dx1.norm() &gt; 0.0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  Increment_ dx2(dx1);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  EXPECT(dx2.norm() &gt; 0.0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// Check that the copy is equal to the original</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  EXPECT(dx2.norm() == 0.0);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="add45a80cab20890c279f3558cbf496b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add45a80cab20890c279f3558cbf496b9">&#9670;&nbsp;</a></span>testIncrementDotProduct()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testIncrementDotProduct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Increment_8h_source.html#l00169">169</a> of file <a class="el" href="test_2interface_2Increment_8h_source.html">Increment.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                               {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keyword">using</span> Test_ = IncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  Increment_ dx1(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  dx1.random();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  Increment_ dx2(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  dx2.random();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// test symmetry of dot product</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">double</span> zz1 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx1, dx2);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">double</span> zz2 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx2, dx1);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  EXPECT(zz1 == zz2);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dot__product_8h_source.html#l00017">dot_product()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_add45a80cab20890c279f3558cbf496b9_cgraph.png" border="0" usemap="#namespacetest_add45a80cab20890c279f3558cbf496b9_cgraph" alt=""/></div>
<map name="namespacetest_add45a80cab20890c279f3558cbf496b9_cgraph" id="namespacetest_add45a80cab20890c279f3558cbf496b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,200,32"/>
<area shape="rect" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a" title="Syntactic sugar to let us use a more mathematical notation for dot products." alt="" coords="248,5,339,32"/>
</map>
</div>

</div>
</div>
<a id="abc79fc6211048a8c413c5e488cac2946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc79fc6211048a8c413c5e488cac2946">&#9670;&nbsp;</a></span>testIncrementOpPlusEq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testIncrementOpPlusEq </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Increment_8h_source.html#l00150">150</a> of file <a class="el" href="test_2interface_2Increment_8h_source.html">Increment.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                             {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keyword">using</span> Test_ = IncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  Increment_ dx1(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  dx1.random();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  Increment_ dx2(dx1);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// test *= and +=</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  dx2 += dx1;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  dx1 *= 2.0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  EXPECT(dx2.norm() &lt; 1e-8);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7930ebd5aab1012896e560091c6e46a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7930ebd5aab1012896e560091c6e46a7">&#9670;&nbsp;</a></span>testIncrementTriangle()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testIncrementTriangle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Increment_8h_source.html#l00124">124</a> of file <a class="el" href="test_2interface_2Increment_8h_source.html">Increment.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                             {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keyword">using</span> Test_ = IncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  Increment_ dx1(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  dx1.random();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  Increment_ dx2(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  dx2.random();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// test triangle inequality</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordtype">double</span> dot1 = dx1.norm();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  EXPECT(dot1 &gt; 0.0);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">double</span> dot2 = dx2.norm();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  EXPECT(dot2 &gt; 0.0);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  dx2 += dx1;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">double</span> dot3 = dx2.norm();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  EXPECT(dot3 &gt; 0.0);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  EXPECT(dot3 &lt;= dot1 + dot2);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6bd8ad9182e87bc3f64c8041ea5c79bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bd8ad9182e87bc3f64c8041ea5c79bd">&#9670;&nbsp;</a></span>testIncrementZero()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testIncrementZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Increment_8h_source.html#l00188">188</a> of file <a class="el" href="test_2interface_2Increment_8h_source.html">Increment.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                         {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keyword">using</span> Test_ = IncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  Increment_ dx(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  dx.random();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  EXPECT(dx.norm() &gt; 0.0);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// test zero</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  dx-&gt;zero();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2914132b68f54cc37ac15f5b4ac94bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2914132b68f54cc37ac15f5b4ac94bc">&#9670;&nbsp;</a></span>testLinearApproximation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testLinearApproximation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2LinearModel_8h_source.html#l00268">268</a> of file <a class="el" href="test_2interface_2LinearModel_8h_source.html">LinearModel.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                               {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keyword">using</span> Test_ = LinearModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keyword">using</span> State_ = <a class="code" href="classoops_1_1State.html">oops::State&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keyword">const</span> util::Duration len(Test_::test().getString(<span class="stringliteral">&quot;fclength&quot;</span>));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keyword">const</span> util::DateTime t1(Test_::time());</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keyword">const</span> util::DateTime t2(t1 + len);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  EXPECT(t2 &gt; t1);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  Increment_ dx0(Test_::resol(), Test_::ctlvars(), t1);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  Test_::covariance().randomize(dx0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  EXPECT(dx0.norm() &gt; 0.0);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  Increment_ dx(dx0);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  Test_::tlm().forecastTL(dx, Test_::dbias(), len);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dxnorm = dx.norm();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classoops_1_1PostProcessor.html">oops::PostProcessor&lt;State_&gt;</a> post;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  State_ xx0(Test_::xref());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  Test_::model().forecast(xx0, Test_::bias(), len, post);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ntest = Test_::test().getInt(<span class="stringliteral">&quot;testiterTL&quot;</span>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordtype">double</span> zz = 1.0;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  std::vector&lt;double&gt; errors;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jtest = 0; jtest &lt; ntest; ++jtest) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    State_ xx(Test_::xref());</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    Increment_ pert(dx0);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    pert *= zz;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    xx += pert;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    Test_::model().forecast(xx, Test_::bias(), len, post);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    Increment_ diff(Test_::resol(), Test_::ctlvars(), t2);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    diff.diff(xx, xx0);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> difnorm = diff.norm();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> err = zz * dxnorm / difnorm;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    Increment_ derr(dx);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    derr *= zz;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    derr -= diff;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> errnorm = derr.norm();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    errors.push_back(errnorm / difnorm);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    Log::test() &lt;&lt; <span class="stringliteral">&quot;TL error = &quot;</span> &lt;&lt; std::setprecision(16) &lt;&lt; err</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, relative error = &quot;</span> &lt;&lt; errnorm / difnorm &lt;&lt; std::endl;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    zz /= 10.0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// Analyze results</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> approx = *std::min_element(errors.begin(), errors.end());</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  Log::test() &lt;&lt; <span class="stringliteral">&quot;Test TL min error = &quot;</span> &lt;&lt; approx &lt;&lt; std::endl;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> tol = Test_::test().getDouble(<span class="stringliteral">&quot;toleranceTL&quot;</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  EXPECT(approx &lt; tol);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0aa681e807fc771d75b69799a30fb8a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aa681e807fc771d75b69799a30fb8a0">&#9670;&nbsp;</a></span>testLinearModelAdjoint()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testLinearModelAdjoint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2LinearModel_8h_source.html#l00324">324</a> of file <a class="el" href="test_2interface_2LinearModel_8h_source.html">LinearModel.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                              {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keyword">using</span> Test_ = LinearModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keyword">using</span> ModelAuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keyword">const</span> util::Duration len(Test_::test().getString(<span class="stringliteral">&quot;fclength&quot;</span>));</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keyword">const</span> util::DateTime t1(Test_::time());</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keyword">const</span> util::DateTime t2(t1 + len);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  EXPECT(t2 &gt; t1);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  Increment_ dx11(Test_::resol(), Test_::ctlvars(), t1);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  Test_::covariance().randomize(dx11);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  ModelAuxIncr_ daux1(Test_::dbias());</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  EXPECT(dx11.norm() &gt; 0.0);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  Increment_ dx12(dx11);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  Test_::tlm().forecastTL(dx12, daux1, len);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  EXPECT(dx12.norm() &gt; 0.0);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  Increment_ dx22(Test_::resol(), Test_::ctlvars(), t2);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  Test_::covariance().randomize(dx22);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  ModelAuxIncr_ daux2(Test_::dbias());</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  EXPECT(dx22.norm() &gt; 0.0);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  Increment_ dx21(dx22);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  Test_::tlm().forecastAD(dx21, daux2, len);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  EXPECT(dx21.norm() &gt; 0.0);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  EXPECT(dx11.norm() != dx22.norm());</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  EXPECT(dx11.validTime() == t1);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  EXPECT(dx21.validTime() == t1);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  EXPECT(dx12.validTime() == t2);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  EXPECT(dx22.validTime() == t2);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dot1 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx11, dx21);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dot2 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx12, dx22);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> tol = Test_::test().getDouble(<span class="stringliteral">&quot;toleranceAD&quot;</span>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(dot1, dot2, tol));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dot__product_8h_source.html#l00017">dot_product()</a>, and <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a0aa681e807fc771d75b69799a30fb8a0_cgraph.png" border="0" usemap="#namespacetest_a0aa681e807fc771d75b69799a30fb8a0_cgraph" alt=""/></div>
<map name="namespacetest_a0aa681e807fc771d75b69799a30fb8a0_cgraph" id="namespacetest_a0aa681e807fc771d75b69799a30fb8a0_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,188,57"/>
<area shape="rect" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a" title="Syntactic sugar to let us use a more mathematical notation for dot products." alt="" coords="243,5,333,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="236,56,340,83"/>
</map>
</div>

</div>
</div>
<a id="a0055834957557dc43e9082ef9a093491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0055834957557dc43e9082ef9a093491">&#9670;&nbsp;</a></span>testLinearModelConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testLinearModelConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2LinearModel_8h_source.html#l00158">158</a> of file <a class="el" href="test_2interface_2LinearModel_8h_source.html">LinearModel.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                  {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keyword">using</span> Test_ = LinearModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">const</span> util::Duration zero(0);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  EXPECT(Test_::tlm().timeResolution() &gt; zero);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa4de23df7e1f7cb3e2bfa6b6cbe8939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa4de23df7e1f7cb3e2bfa6b6cbe8939">&#9670;&nbsp;</a></span>testLinearModelLinearity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testLinearModelLinearity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2LinearModel_8h_source.html#l00232">232</a> of file <a class="el" href="test_2interface_2LinearModel_8h_source.html">LinearModel.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keyword">using</span> Test_ = LinearModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keyword">using</span> ModelAuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keyword">const</span> util::Duration len(Test_::test().getString(<span class="stringliteral">&quot;fclength&quot;</span>));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keyword">const</span> util::DateTime t1(Test_::time());</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keyword">const</span> util::DateTime t2(t1 + len);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  EXPECT(t2 &gt; t1);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> zz = 3.1415;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  Increment_ dx1(Test_::resol(), Test_::ctlvars(), t1);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  Test_::covariance().randomize(dx1);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  ModelAuxIncr_ daux1(Test_::dbias());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  EXPECT(dx1.norm() &gt; 0.0);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  Increment_ dx2(dx1);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  ModelAuxIncr_ daux2(daux1);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  Test_::tlm().forecastTL(dx1, daux1, len);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  EXPECT(dx1.validTime() == t2);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  dx1 *= zz;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  daux1 *= zz;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  dx2 *= zz;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  daux2 *= zz;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  Test_::tlm().forecastTL(dx2, daux2, len);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  EXPECT(dx2.validTime() == t2);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> tol = Test_::test().getDouble(<span class="stringliteral">&quot;toleranceAD&quot;</span>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(dx1.norm(), dx2.norm(), tol));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_afa4de23df7e1f7cb3e2bfa6b6cbe8939_cgraph.png" border="0" usemap="#namespacetest_afa4de23df7e1f7cb3e2bfa6b6cbe8939_cgraph" alt=""/></div>
<map name="namespacetest_afa4de23df7e1f7cb3e2bfa6b6cbe8939_cgraph" id="namespacetest_afa4de23df7e1f7cb3e2bfa6b6cbe8939_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,197,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="245,5,349,32"/>
</map>
</div>

</div>
</div>
<a id="a3ac75fecb3badb35d35b10ec07e0d669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ac75fecb3badb35d35b10ec07e0d669">&#9670;&nbsp;</a></span>testLinearModelZeroLength()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testLinearModelZeroLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2LinearModel_8h_source.html#l00168">168</a> of file <a class="el" href="test_2interface_2LinearModel_8h_source.html">LinearModel.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                 {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keyword">using</span> Test_ = LinearModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keyword">using</span> ModelAuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keyword">const</span> util::DateTime vt(Test_::time());</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">const</span> util::Duration zero(0);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  Increment_ dxref(Test_::resol(), Test_::ctlvars(), vt);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  Test_::covariance().randomize(dxref);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  ModelAuxIncr_ daux(Test_::dbias());</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> ininorm = dxref.norm();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  EXPECT(ininorm &gt; 0.0);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  Increment_ dx(Test_::resol(), Test_::ctlvars(), vt);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  Increment_ dxm(Test_::resol(), Test_::ctlvars(), vt);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  dxm = dxref;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  Test_::tlm().forecastTL(dxm, daux, zero);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  dx = dxm;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  EXPECT(dx.validTime() == vt);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  EXPECT(dx.norm() == ininorm);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  dxm.zero();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  dxm = dxref;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  Test_::tlm().forecastAD(dxm, daux, zero);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  dx = dxm;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  EXPECT(dx.validTime() == vt);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  EXPECT(dx.norm() == ininorm);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abe803ae36153ee74bc49ce00c07fe897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe803ae36153ee74bc49ce00c07fe897">&#9670;&nbsp;</a></span>testLinearModelZeroPert()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testLinearModelZeroPert </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2LinearModel_8h_source.html#l00201">201</a> of file <a class="el" href="test_2interface_2LinearModel_8h_source.html">LinearModel.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                               {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keyword">using</span> Test_ = LinearModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keyword">using</span> ModelAuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keyword">const</span> util::Duration len(Test_::test().getString(<span class="stringliteral">&quot;fclength&quot;</span>));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keyword">const</span> util::DateTime t1(Test_::time());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keyword">const</span> util::DateTime t2(t1 + len);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  EXPECT(t2 &gt; t1);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  Increment_ dx(Test_::resol(), Test_::ctlvars(), t1);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  ModelAuxIncr_ daux(Test_::dbias());</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  dx.zero();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  daux.zero();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  Test_::tlm().forecastTL(dx, daux, len);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  EXPECT(dx.validTime() == t2);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  dx.zero();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  daux.zero();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  Test_::tlm().forecastAD(dx, daux, len);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  EXPECT(dx.validTime() == t1);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fdb15750de87b96f3cd9c08aa445e05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fdb15750de87b96f3cd9c08aa445e05">&#9670;&nbsp;</a></span>testLocalizationMultiply()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testLocalizationMultiply </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Localization_8h_source.html#l00102">102</a> of file <a class="el" href="test_2interface_2Localization_8h_source.html">Localization.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keyword">using</span> Test_ = LocalizationFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  Increment_ dx(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  dx.random();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  EXPECT(dx.norm() &gt; 0.0);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  Test_::localization().multiply(dx);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  EXPECT(dx.norm() &gt; 0.0);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac0727efdeb021cb1e677e2df21e6edd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac0727efdeb021cb1e677e2df21e6edd">&#9670;&nbsp;</a></span>testLocalizationZero()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testLocalizationZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Localization_8h_source.html#l00088">88</a> of file <a class="el" href="test_2interface_2Localization_8h_source.html">Localization.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                            {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">using</span> Test_ = LocalizationFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keyword">using</span> Increment_ = <a class="code" href="classoops_1_1Increment.html">oops::Increment&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  Increment_ dx(Test_::resol(), Test_::ctlvars(), Test_::time());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  Test_::localization().multiply(dx);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bb59e68a4aeb7c66357982fb5df1d00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bb59e68a4aeb7c66357982fb5df1d00">&#9670;&nbsp;</a></span>testModelAuxIncrementAxpy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelAuxIncrementAxpy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html#l00211">211</a> of file <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html">ModelAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                 {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  AuxIncr_ dx1(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// test axpy</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  AuxIncr_ dx2(dx1);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  dx2.axpy(2.0, dx1);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  EXPECT(dx2.norm() &lt; 1e-8);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f79b3283d2403f2588033b342dc8b47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f79b3283d2403f2588033b342dc8b47">&#9670;&nbsp;</a></span>testModelAuxIncrementChangeRes()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelAuxIncrementChangeRes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html#l00112">112</a> of file <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html">ModelAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                      {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  AuxIncr_ dx1(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  AuxIncr_ dx2(dx1, Test_::config());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  EXPECT(dx2.norm() &gt; 0.0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  EXPECT(dx2.norm() == dx1.norm());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">// Check that the copy is equal to the original</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  EXPECT(dx2.norm() == 0.0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e9f1da1d3e0105f5dc7cec9e786a943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e9f1da1d3e0105f5dc7cec9e786a943">&#9670;&nbsp;</a></span>testModelAuxIncrementConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelAuxIncrementConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html#l00081">81</a> of file <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html">ModelAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                        {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  AuxIncr_ dx(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d2001722603103a0bf4ddbc3649b896"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d2001722603103a0bf4ddbc3649b896">&#9670;&nbsp;</a></span>testModelAuxIncrementCopyConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelAuxIncrementCopyConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html#l00093">93</a> of file <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html">ModelAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                            {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  AuxIncr_ dx1(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  AuxIncr_ dx2(dx1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  EXPECT(dx2.norm() &gt; 0.0);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  EXPECT(dx2.norm() == dx1.norm());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// Check that the copy is equal to the original</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  EXPECT(dx2.norm() == 0.0);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af1bae4f6a7e42a154d45967d21471452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1bae4f6a7e42a154d45967d21471452">&#9670;&nbsp;</a></span>testModelAuxIncrementDotProduct()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelAuxIncrementDotProduct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html#l00176">176</a> of file <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html">ModelAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                       {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  AuxIncr_ dx1(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  AuxIncr_ dx2(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx2);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// test symmetry of dot product</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">double</span> zz1 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx1, dx2);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordtype">double</span> zz2 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx2, dx1);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  EXPECT(zz1 == zz2);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dot__product_8h_source.html#l00017">dot_product()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_af1bae4f6a7e42a154d45967d21471452_cgraph.png" border="0" usemap="#namespacetest_af1bae4f6a7e42a154d45967d21471452_cgraph" alt=""/></div>
<map name="namespacetest_af1bae4f6a7e42a154d45967d21471452_cgraph" id="namespacetest_af1bae4f6a7e42a154d45967d21471452_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,192,47"/>
<area shape="rect" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a" title="Syntactic sugar to let us use a more mathematical notation for dot products." alt="" coords="240,13,331,39"/>
</map>
</div>

</div>
</div>
<a id="a6cd4e4ed3fb006162249bb746a5222eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd4e4ed3fb006162249bb746a5222eb">&#9670;&nbsp;</a></span>testModelAuxIncrementOpPlusEq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelAuxIncrementOpPlusEq </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html#l00157">157</a> of file <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html">ModelAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                     {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  AuxIncr_ dx1(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  AuxIncr_ dx2(dx1);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// test *= and +=</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  dx2 += dx1;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  dx1 *= 2.0;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  EXPECT(dx2.norm() &lt; 1e-8);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a81307c4cc01741f1ee742fadf19efa6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81307c4cc01741f1ee742fadf19efa6b">&#9670;&nbsp;</a></span>testModelAuxIncrementTriangle()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelAuxIncrementTriangle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html#l00131">131</a> of file <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html">ModelAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                     {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  AuxIncr_ dx1(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  AuxIncr_ dx2(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx2);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// test triangle inequality</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">double</span> dot1 = dx1.norm();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  EXPECT(dot1 &gt; 0.0);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">double</span> dot2 = dx2.norm();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  EXPECT(dot2 &gt; 0.0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  dx2 += dx1;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">double</span> dot3 = dx2.norm();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  EXPECT(dot3 &gt; 0.0);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  EXPECT(dot3 &lt;= dot1 + dot2);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1738b7cec96e63175cf7a3dfa0bbe4b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1738b7cec96e63175cf7a3dfa0bbe4b0">&#9670;&nbsp;</a></span>testModelAuxIncrementZero()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelAuxIncrementZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html#l00195">195</a> of file <a class="el" href="test_2interface_2ModelAuxIncrement_8h_source.html">ModelAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                 {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keyword">using</span> Test_ = ModelAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  AuxIncr_ dx(Test_::resol(), Test_::config());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  ModelAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  EXPECT(dx.norm() &gt; 0.0);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// test zero</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  dx-&gt;zero();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3616bd5816927eec881a61b21af2476e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3616bd5816927eec881a61b21af2476e">&#9670;&nbsp;</a></span>testModelConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Model_8h_source.html#l00094">94</a> of file <a class="el" href="test_2interface_2Model_8h_source.html">Model.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                            {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keyword">using</span> Test_ = ModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keyword">const</span> util::Duration zero(0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  EXPECT(Test_::model().timeResolution() &gt; zero);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9acb0a929c48ae1ca8fb04704b0fd75a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9acb0a929c48ae1ca8fb04704b0fd75a">&#9670;&nbsp;</a></span>testModelForecast()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelForecast </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Model_8h_source.html#l00127">127</a> of file <a class="el" href="test_2interface_2Model_8h_source.html">Model.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                         {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keyword">using</span> Test_ = ModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keyword">using</span> State_ = <a class="code" href="classoops_1_1State.html">oops::State&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> fnorm = Test_::test().getDouble(<span class="stringliteral">&quot;finalnorm&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> tol = Test_::test().getDouble(<span class="stringliteral">&quot;tolerance&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keyword">const</span> util::Duration len(Test_::test().getString(<span class="stringliteral">&quot;fclength&quot;</span>));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> ininorm = Test_::xref().norm();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  State_ xx(Test_::xref());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">const</span> util::DateTime vt(xx.validTime() + len);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="classoops_1_1PostProcessor.html">oops::PostProcessor&lt;State_&gt;</a> post;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  Test_::model().forecast(xx, Test_::bias(), len, post);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  EXPECT(xx.validTime() == vt);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  EXPECT(<a class="code" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a>(xx.norm(), fnorm, tol));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// Recomputing initial norm to make sure nothing bad happened</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  EXPECT(Test_::xref().norm() == ininorm);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Test_8h_source.html#l00089">oops::is_close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a9acb0a929c48ae1ca8fb04704b0fd75a_cgraph.png" border="0" usemap="#namespacetest_a9acb0a929c48ae1ca8fb04704b0fd75a_cgraph" alt=""/></div>
<map name="namespacetest_a9acb0a929c48ae1ca8fb04704b0fd75a_cgraph" id="namespacetest_a9acb0a929c48ae1ca8fb04704b0fd75a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,164,32"/>
<area shape="rect" href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059" title=" " alt="" coords="212,5,316,32"/>
</map>
</div>

</div>
</div>
<a id="a5328bdf515d96904ecec34ce11dd7daa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5328bdf515d96904ecec34ce11dd7daa">&#9670;&nbsp;</a></span>testModelNoForecast()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testModelNoForecast </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2Model_8h_source.html#l00104">104</a> of file <a class="el" href="test_2interface_2Model_8h_source.html">Model.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                           {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">using</span> Test_ = ModelFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">using</span> State_ = <a class="code" href="classoops_1_1State.html">oops::State&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> ininorm = Test_::xref().<a class="code" href="classoops_1_1State.html#a075c8525fdc5c270359469661167fc82">norm</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  State_ xx(Test_::xref());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">const</span> util::DateTime vt(xx.validTime());</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">const</span> util::Duration zero(0);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="classoops_1_1PostProcessor.html">oops::PostProcessor&lt;State_&gt;</a> post;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  Test_::model().forecast(xx, Test_::bias(), zero, post);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  EXPECT(xx.validTime() == vt);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  EXPECT(xx.norm() == ininorm);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// Recomputing initial norm to make sure nothing bad happened</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  EXPECT(Test_::xref().norm() == ininorm);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="oops_2interface_2State_8h_source.html#l00253">oops::State&lt; MODEL &gt;::norm()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_a5328bdf515d96904ecec34ce11dd7daa_cgraph.png" border="0" usemap="#namespacetest_a5328bdf515d96904ecec34ce11dd7daa_cgraph" alt=""/></div>
<map name="namespacetest_a5328bdf515d96904ecec34ce11dd7daa_cgraph" id="namespacetest_a5328bdf515d96904ecec34ce11dd7daa_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="classoops_1_1State.html#a075c8525fdc5c270359469661167fc82" title="L&#45;2 norm." alt="" coords="228,5,351,32"/>
</map>
</div>

</div>
</div>
<a id="abde5fd0881acfbe6919633710d1b341b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abde5fd0881acfbe6919633710d1b341b">&#9670;&nbsp;</a></span>testObsAuxIncrementAxpy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testObsAuxIncrementAxpy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html#l00220">220</a> of file <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html">ObsAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                               {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keyword">using</span> Test_ = ObsAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  AuxIncr_ dx1(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// test axpy</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  AuxIncr_ dx2(dx1);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  dx2.axpy(2.0, dx1);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  EXPECT(dx2.norm() &lt; 1e-8);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a19de3f1e39e64524637af9ae4381a059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19de3f1e39e64524637af9ae4381a059">&#9670;&nbsp;</a></span>testObsAuxIncrementChangeRes()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testObsAuxIncrementChangeRes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html#l00121">121</a> of file <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html">ObsAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                    {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">using</span> Test_ = ObsAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  AuxIncr_ dx1(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  AuxIncr_ dx2(dx1, Test_::config());</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  EXPECT(dx2.norm() &gt; 0.0);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  EXPECT(dx2.norm() == dx1.norm());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// Check that the copy is equal to the original</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  EXPECT(dx2.norm() == 0.0);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a20d2595ff8046205c3b0bf736b91d442"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20d2595ff8046205c3b0bf736b91d442">&#9670;&nbsp;</a></span>testObsAuxIncrementConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testObsAuxIncrementConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html#l00090">90</a> of file <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html">ObsAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                      {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keyword">using</span> Test_ = ObsAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  AuxIncr_ dx(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a2af5ed0feab8257693851aec152835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a2af5ed0feab8257693851aec152835">&#9670;&nbsp;</a></span>testObsAuxIncrementCopyConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testObsAuxIncrementCopyConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html#l00102">102</a> of file <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html">ObsAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                          {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keyword">using</span> Test_ = ObsAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  AuxIncr_ dx1(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  AuxIncr_ dx2(dx1);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  EXPECT(dx2.norm() &gt; 0.0);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  EXPECT(dx2.norm() == dx1.norm());</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// Check that the copy is equal to the original</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  EXPECT(dx2.norm() == 0.0);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae24177f0b1871bebe95e01fe1ad6d243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae24177f0b1871bebe95e01fe1ad6d243">&#9670;&nbsp;</a></span>testObsAuxIncrementDotProduct()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testObsAuxIncrementDotProduct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html#l00185">185</a> of file <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html">ObsAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                     {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">using</span> Test_ = ObsAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  AuxIncr_ dx1(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  AuxIncr_ dx2(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx2);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// test symmetry of dot product</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">double</span> zz1 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx1, dx2);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">double</span> zz2 = <a class="code" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a>(dx2, dx1);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  EXPECT(zz1 == zz2);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dot__product_8h_source.html#l00017">dot_product()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacetest_ae24177f0b1871bebe95e01fe1ad6d243_cgraph.png" border="0" usemap="#namespacetest_ae24177f0b1871bebe95e01fe1ad6d243_cgraph" alt=""/></div>
<map name="namespacetest_ae24177f0b1871bebe95e01fe1ad6d243_cgraph" id="namespacetest_ae24177f0b1871bebe95e01fe1ad6d243_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,181,47"/>
<area shape="rect" href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a" title="Syntactic sugar to let us use a more mathematical notation for dot products." alt="" coords="229,13,320,39"/>
</map>
</div>

</div>
</div>
<a id="a4dc64ff48166fe98ebcba5702249c223"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dc64ff48166fe98ebcba5702249c223">&#9670;&nbsp;</a></span>testObsAuxIncrementOpPlusEq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testObsAuxIncrementOpPlusEq </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html#l00166">166</a> of file <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html">ObsAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                   {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keyword">using</span> Test_ = ObsAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  AuxIncr_ dx1(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  AuxIncr_ dx2(dx1);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// test *= and +=</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  dx2 += dx1;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  dx1 *= 2.0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  dx2 -= dx1;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  EXPECT(dx2.norm() &lt; 1e-8);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a61d505e4470ec5fcbe450bd08d62976b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61d505e4470ec5fcbe450bd08d62976b">&#9670;&nbsp;</a></span>testObsAuxIncrementTriangle()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testObsAuxIncrementTriangle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html#l00140">140</a> of file <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html">ObsAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                   {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keyword">using</span> Test_ = ObsAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  AuxIncr_ dx1(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx1);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  AuxIncr_ dx2(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx2);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// test triangle inequality</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">double</span> dot1 = dx1.norm();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  EXPECT(dot1 &gt; 0.0);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">double</span> dot2 = dx2.norm();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  EXPECT(dot2 &gt; 0.0);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  dx2 += dx1;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">double</span> dot3 = dx2.norm();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  EXPECT(dot3 &gt; 0.0);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  EXPECT(dot3 &lt;= dot1 + dot2);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af240ec42281a9eaee5c2c223b4d48a68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af240ec42281a9eaee5c2c223b4d48a68">&#9670;&nbsp;</a></span>testObsAuxIncrementZero()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testObsAuxIncrementZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html#l00204">204</a> of file <a class="el" href="test_2interface_2ObsAuxIncrement_8h_source.html">ObsAuxIncrement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                               {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keyword">using</span> Test_ = ObsAuxIncrementFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keyword">using</span> AuxIncr_ = <a class="code" href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  AuxIncr_ dx(Test_::obspace(), Test_::config());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  ObsAuxIncrementFixture&lt;MODEL&gt;::covariance().randomize(dx);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  EXPECT(dx.norm() &gt; 0.0);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// test zero</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  dx-&gt;zero();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  EXPECT(dx.norm() == 0.0);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0aedebe5fad02a9e8b3c6d711b1aeedc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aedebe5fad02a9e8b3c6d711b1aeedc">&#9670;&nbsp;</a></span>testStateConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testStateConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2State_8h_source.html#l00096">96</a> of file <a class="el" href="test_2interface_2State_8h_source.html">State.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                            {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keyword">using</span> Test_ = StateFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  EXPECT(Test_::xref().norm() == Test_::norm());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">double</span> norm = Test_::test().getDouble(<span class="stringliteral">&quot;norm&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">double</span> tol = Test_::test().getDouble(<span class="stringliteral">&quot;tolerance&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  EXPECT(std::abs(Test_::xref().norm() - norm) &lt; tol);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">const</span> util::DateTime vt(Test_::test().getString(<span class="stringliteral">&quot;date&quot;</span>));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  EXPECT(Test_::xref().validTime() == vt);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0997509de3f015586301962cc995466f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0997509de3f015586301962cc995466f">&#9670;&nbsp;</a></span>testStateCopyConstructor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void test::testStateCopyConstructor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2interface_2State_8h_source.html#l00112">112</a> of file <a class="el" href="test_2interface_2State_8h_source.html">State.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">using</span> Test_ = StateFixture&lt;MODEL&gt;;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">using</span> State_ = <a class="code" href="classoops_1_1State.html">oops::State&lt;MODEL&gt;</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  std::unique_ptr&lt;State_&gt; xx(<span class="keyword">new</span> State_(Test_::xref()));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  EXPECT(xx.get());</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  EXPECT(xx-&gt;norm() == Test_::norm());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">const</span> util::DateTime vt(Test_::test().getString(<span class="stringliteral">&quot;date&quot;</span>));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  EXPECT(xx-&gt;validTime() == vt);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  xx.reset();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  EXPECT(!xx.get());</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// Recomputing initial norm to make sure nothing bad happened</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  EXPECT(Test_::xref().norm() == Test_::norm());</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aclassoops_1_1Locations_html"><div class="ttname"><a href="classoops_1_1Locations.html">oops::Locations</a></div><div class="ttdoc">Encapsulates the observation locations.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2Locations_8h_source.html#l00037">Locations.h:37</a></div></div>
<div class="ttc" id="aclassoops_1_1Geometry_html"><div class="ttname"><a href="classoops_1_1Geometry.html">oops::Geometry</a></div><div class="ttdoc">Wrapper for geometry.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2Geometry_8h_source.html#l00037">Geometry.h:37</a></div></div>
<div class="ttc" id="aclassoops_1_1ModelAuxControl_html"><div class="ttname"><a href="classoops_1_1ModelAuxControl.html">oops::ModelAuxControl</a></div><div class="ttdoc">Encapsulates the auxiliary model space component of ControlVariable.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2ModelAuxControl_8h_source.html#l00048">ModelAuxControl.h:48</a></div></div>
<div class="ttc" id="aclassoops_1_1State_html_a075c8525fdc5c270359469661167fc82"><div class="ttname"><a href="classoops_1_1State.html#a075c8525fdc5c270359469661167fc82">oops::State::norm</a></div><div class="ttdeci">double norm() const</div><div class="ttdoc">L-2 norm.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2State_8h_source.html#l00253">State.h:253</a></div></div>
<div class="ttc" id="aclassoops_1_1PostProcessor_html"><div class="ttname"><a href="classoops_1_1PostProcessor.html">oops::PostProcessor</a></div><div class="ttdoc">Control model post processing.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcessor_8h_source.html#l00043">PostProcessor.h:43</a></div></div>
<div class="ttc" id="aclassoops_1_1ObsAuxIncrement_html"><div class="ttname"><a href="classoops_1_1ObsAuxIncrement.html">oops::ObsAuxIncrement</a></div><div class="ttdoc">Encapsulates auxiliary observation space components of ControlIncrement.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2ObsAuxIncrement_8h_source.html#l00052">ObsAuxIncrement.h:52</a></div></div>
<div class="ttc" id="anamespaceoops_html_a10d0ef2b4ed74b6ed2f499fa8c2b7059"><div class="ttname"><a href="namespaceoops.html#a10d0ef2b4ed74b6ed2f499fa8c2b7059">oops::is_close</a></div><div class="ttdeci">bool is_close(T a, T b, T epsilon)</div><div class="ttdef"><b>Definition:</b> <a href="Test_8h_source.html#l00089">Test.h:89</a></div></div>
<div class="ttc" id="aclassoops_1_1Increment_html"><div class="ttname"><a href="classoops_1_1Increment.html">oops::Increment</a></div><div class="ttdoc">Encapsulates model increment.</div><div class="ttdef"><b>Definition:</b> <a href="GeoVaLs_8h_source.html#l00032">GeoVaLs.h:32</a></div></div>
<div class="ttc" id="aclassoops_1_1State_html"><div class="ttname"><a href="classoops_1_1State.html">oops::State</a></div><div class="ttdoc">Encapsulates model state.</div><div class="ttdef"><b>Definition:</b> <a href="GeoVaLs_8h_source.html#l00034">GeoVaLs.h:34</a></div></div>
<div class="ttc" id="adot__product_8h_html_af0275315d135f0b993246c2ff4b1f40a"><div class="ttname"><a href="dot__product_8h.html#af0275315d135f0b993246c2ff4b1f40a">dot_product</a></div><div class="ttdeci">double dot_product(const T &amp;x, const T &amp;y)</div><div class="ttdoc">Syntactic sugar to let us use a more mathematical notation for dot products.</div><div class="ttdef"><b>Definition:</b> <a href="dot__product_8h_source.html#l00017">dot_product.h:17</a></div></div>
<div class="ttc" id="aclassoops_1_1ModelAuxIncrement_html"><div class="ttname"><a href="classoops_1_1ModelAuxIncrement.html">oops::ModelAuxIncrement</a></div><div class="ttdoc">Encapsulates the auxiliary model space component of ControlIncrement.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2ModelAuxIncrement_8h_source.html#l00045">ModelAuxIncrement.h:45</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
