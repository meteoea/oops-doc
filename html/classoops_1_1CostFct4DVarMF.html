<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OOPS Documentation: oops::CostFct4DVarMF&lt; MODEL &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OOPS Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceoops.html">oops</a></li><li class="navelem"><a class="el" href="classoops_1_1CostFct4DVarMF.html">CostFct4DVarMF</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classoops_1_1CostFct4DVarMF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oops::CostFct4DVarMF&lt; MODEL &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>4D-Var Cost Function in the ARPEGE  
 <a href="classoops_1_1CostFct4DVarMF.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for oops::CostFct4DVarMF&lt; MODEL &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF__inherit__graph.png" border="0" usemap="#oops_1_1CostFct4DVarMF_3_01MODEL_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="oops_1_1CostFct4DVarMF_3_01MODEL_01_4_inherit__map" id="oops_1_1CostFct4DVarMF_3_01MODEL_01_4_inherit__map">
<area shape="rect" title="4D&#45;Var Cost Function in the ARPEGE" alt="" coords="117,725,274,1140"/>
<area shape="rect" href="classoops_1_1CostFct4DVarHyb4D.html" title="4DVarHyb4D Cost Function in the ARPEGE" alt="" coords="5,1188,183,1456"/>
<area shape="rect" href="classoops_1_1CostFct4DVarTrajHR.html" title="4D&#45;Var Cost Function in the ARPEGE" alt="" coords="207,1203,386,1441"/>
<area shape="rect" href="classoops_1_1CostFunction.html" title="Abstract base class for a cost function." alt="" coords="108,131,283,677"/>
<area shape="rect" title=" " alt="" coords="146,5,245,83"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab4f24724380c63316f0762991693dc9c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ab4f24724380c63316f0762991693dc9c">CostFct4DVarMF</a> (const eckit::Configuration &amp;, const <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> &amp;, const <a class="el" href="classoops_1_1CostFct4DVarMF.html#adb80c766eb605d5ebc6e567afdeb8809">Model_</a> &amp;)</td></tr>
<tr class="separator:ab4f24724380c63316f0762991693dc9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9af8ce8e8eedc84e41dc9011053c0654"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a9af8ce8e8eedc84e41dc9011053c0654">~CostFct4DVarMF</a> ()</td></tr>
<tr class="separator:a9af8ce8e8eedc84e41dc9011053c0654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f335802ebc2b48d32270f8a12a27cc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a00f335802ebc2b48d32270f8a12a27cc">evaluate</a> (const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;, const eckit::Configuration &amp;config=eckit::LocalConfiguration(), <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt; post=<a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt;()) const override</td></tr>
<tr class="memdesc:a00f335802ebc2b48d32270f8a12a27cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the non-linear cost function.  <a href="classoops_1_1CostFct4DVarMF.html#a00f335802ebc2b48d32270f8a12a27cc">More...</a><br /></td></tr>
<tr class="separator:a00f335802ebc2b48d32270f8a12a27cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f6f4f1714c18c1fb9af0732a8f5792"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a02f6f4f1714c18c1fb9af0732a8f5792">linearize</a> (const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;, const eckit::Configuration &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt; post=<a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt;()) override</td></tr>
<tr class="memdesc:a02f6f4f1714c18c1fb9af0732a8f5792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the quadratic cost function. Specific linearization for ARPEGE 4D-Var.  <a href="classoops_1_1CostFct4DVarMF.html#a02f6f4f1714c18c1fb9af0732a8f5792">More...</a><br /></td></tr>
<tr class="separator:a02f6f4f1714c18c1fb9af0732a8f5792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b654233b92ced3da8862952cb03557c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a8b654233b92ced3da8862952cb03557c">runTL</a> (<a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> &amp;, <a class="el" href="classoops_1_1PostProcessorTL.html">PostProcessorTL</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt; &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt;, const bool idModel=false) const override</td></tr>
<tr class="memdesc:a8b654233b92ced3da8862952cb03557c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoops_1_1Run.html">Run</a> the tangent linear model.  <a href="classoops_1_1CostFct4DVarMF.html#a8b654233b92ced3da8862952cb03557c">More...</a><br /></td></tr>
<tr class="separator:a8b654233b92ced3da8862952cb03557c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5fe034e1c11fd04e8716bce861a7a20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ae5fe034e1c11fd04e8716bce861a7a20">runAD</a> (<a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> &amp;, <a class="el" href="classoops_1_1PostProcessorAD.html">PostProcessorAD</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt; &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt;, const bool idModel=false) const override</td></tr>
<tr class="memdesc:ae5fe034e1c11fd04e8716bce861a7a20"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoops_1_1Run.html">Run</a> the adjoint model.  <a href="classoops_1_1CostFct4DVarMF.html#ae5fe034e1c11fd04e8716bce861a7a20">More...</a><br /></td></tr>
<tr class="separator:ae5fe034e1c11fd04e8716bce861a7a20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b55061887aec3791dd8125eee7fda7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a40b55061887aec3791dd8125eee7fda7">zeroAD</a> (<a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> &amp;) const override</td></tr>
<tr class="memdesc:a40b55061887aec3791dd8125eee7fda7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nullify the increment prior to running the adjoint model.  <a href="classoops_1_1CostFct4DVarMF.html#a40b55061887aec3791dd8125eee7fda7">More...</a><br /></td></tr>
<tr class="separator:a40b55061887aec3791dd8125eee7fda7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299d2d78c12ec362264601bf7ecc1dfc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a299d2d78c12ec362264601bf7ecc1dfc">runNL</a> (<a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;xx, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt; &amp;pp) const override</td></tr>
<tr class="memdesc:a299d2d78c12ec362264601bf7ecc1dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model (HR)  <a href="classoops_1_1CostFct4DVarMF.html#a299d2d78c12ec362264601bf7ecc1dfc">More...</a><br /></td></tr>
<tr class="separator:a299d2d78c12ec362264601bf7ecc1dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff829a306be737410971cc74aa29750c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#aff829a306be737410971cc74aa29750c">runNL</a> (<a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;, const <a class="el" href="classoops_1_1CostFct4DVarMF.html#adb80c766eb605d5ebc6e567afdeb8809">Model_</a> &amp;model, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt; &amp;) override</td></tr>
<tr class="memdesc:aff829a306be737410971cc74aa29750c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model (Trajectory)  <a href="classoops_1_1CostFct4DVarMF.html#aff829a306be737410971cc74aa29750c">More...</a><br /></td></tr>
<tr class="separator:aff829a306be737410971cc74aa29750c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39128088d18168627d9be8f9f0fe3bba"><td class="memItemLeft" align="right" valign="top">const double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a39128088d18168627d9be8f9f0fe3bba">getCostJoJc</a> () const override</td></tr>
<tr class="memdesc:a39128088d18168627d9be8f9f0fe3bba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the JoJc cost function value.  <a href="classoops_1_1CostFct4DVarMF.html#a39128088d18168627d9be8f9f0fe3bba">More...</a><br /></td></tr>
<tr class="separator:a39128088d18168627d9be8f9f0fe3bba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bf02c9e1ceeb16874df7275ddefcbd1"><td class="memItemLeft" align="right" valign="top">const double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a9bf02c9e1ceeb16874df7275ddefcbd1">getCostJb</a> () const override</td></tr>
<tr class="memdesc:a9bf02c9e1ceeb16874df7275ddefcbd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Jb cost function value.  <a href="classoops_1_1CostFct4DVarMF.html#a9bf02c9e1ceeb16874df7275ddefcbd1">More...</a><br /></td></tr>
<tr class="separator:a9bf02c9e1ceeb16874df7275ddefcbd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoops_1_1CostFunction"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoops_1_1CostFunction')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction&lt; MODEL &gt;</a></td></tr>
<tr class="memitem:a0bcfda435fb7dd9cd18f94aa10ce60fb inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a0bcfda435fb7dd9cd18f94aa10ce60fb">CostFunction</a> (const eckit::Configuration &amp;, const <a class="el" href="classoops_1_1CostFunction.html#a1784037bdc70348117f81b08913e8168">Geometry_</a> &amp;, const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> &amp;)</td></tr>
<tr class="memdesc:a0bcfda435fb7dd9cd18f94aa10ce60fb inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a cost function.  <a href="classoops_1_1CostFunction.html#a0bcfda435fb7dd9cd18f94aa10ce60fb">More...</a><br /></td></tr>
<tr class="separator:a0bcfda435fb7dd9cd18f94aa10ce60fb inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3b5e70c15c97457d3d0ae6bc8f6332 inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a5e3b5e70c15c97457d3d0ae6bc8f6332">~CostFunction</a> ()</td></tr>
<tr class="memdesc:a5e3b5e70c15c97457d3d0ae6bc8f6332 inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a cost function.  <a href="classoops_1_1CostFunction.html#a5e3b5e70c15c97457d3d0ae6bc8f6332">More...</a><br /></td></tr>
<tr class="separator:a5e3b5e70c15c97457d3d0ae6bc8f6332 inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e13195b3ae645295dd42ce48424da56 inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a3e13195b3ae645295dd42ce48424da56">addIncrement</a> (<a class="el" href="classoops_1_1CostFunction.html#a9ee05b114f16bf79b51044fd6e5cc8f0">CtrlVar_</a> &amp;, const <a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt; post=<a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFunction.html#aa1c5896acf77139e7185946114d26511">Increment_</a> &gt;()) const</td></tr>
<tr class="memdesc:a3e13195b3ae645295dd42ce48424da56 inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add increment to the first guess.  <a href="classoops_1_1CostFunction.html#a3e13195b3ae645295dd42ce48424da56">More...</a><br /></td></tr>
<tr class="separator:a3e13195b3ae645295dd42ce48424da56 inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae129b06da634ee7e791d55199400d933 inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ae129b06da634ee7e791d55199400d933">resetLinearization</a> ()</td></tr>
<tr class="memdesc:ae129b06da634ee7e791d55199400d933 inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rest the quadratic cost function.  <a href="classoops_1_1CostFunction.html#ae129b06da634ee7e791d55199400d933">More...</a><br /></td></tr>
<tr class="separator:ae129b06da634ee7e791d55199400d933 inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ded191b42bf43d092a067752a97b47 inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#af4ded191b42bf43d092a067752a97b47">computeGradientFG</a> (<a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;) const</td></tr>
<tr class="memdesc:af4ded191b42bf43d092a067752a97b47 inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the cost function gradient at first guess (without Jb)  <a href="classoops_1_1CostFunction.html#af4ded191b42bf43d092a067752a97b47">More...</a><br /></td></tr>
<tr class="separator:af4ded191b42bf43d092a067752a97b47 inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e479579b5c025bd684223bfc4aed6fb inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a8e479579b5c025bd684223bfc4aed6fb">computeGradientFG</a> (const <a class="el" href="classoops_1_1CostFunction.html#a12923054863fe54fd144876b944de3ce">CtrlVec_</a> &amp;, <a class="el" href="classoops_1_1CostFunction.html#a8ea88f1ea9ca655822d51aeb3b69162f">CtrlInc_</a> &amp;) const</td></tr>
<tr class="memdesc:a8e479579b5c025bd684223bfc4aed6fb inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the cost function gradient at first guess (without Jb)  <a href="classoops_1_1CostFunction.html#a8e479579b5c025bd684223bfc4aed6fb">More...</a><br /></td></tr>
<tr class="separator:a8e479579b5c025bd684223bfc4aed6fb inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9048264d1b4e666d9f992910b02e5f80 inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a9048264d1b4e666d9f992910b02e5f80">checkpoint</a> (eckit::LocalConfiguration &amp;) const</td></tr>
<tr class="memdesc:a9048264d1b4e666d9f992910b02e5f80 inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checkpoint.  <a href="classoops_1_1CostFunction.html#a9048264d1b4e666d9f992910b02e5f80">More...</a><br /></td></tr>
<tr class="separator:a9048264d1b4e666d9f992910b02e5f80 inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d91975ee9b053fc7d69a376e3c2aa29 inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a3d91975ee9b053fc7d69a376e3c2aa29">restart</a> (const eckit::Configuration &amp;)</td></tr>
<tr class="memdesc:a3d91975ee9b053fc7d69a376e3c2aa29 inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart.  <a href="classoops_1_1CostFunction.html#a3d91975ee9b053fc7d69a376e3c2aa29">More...</a><br /></td></tr>
<tr class="separator:a3d91975ee9b053fc7d69a376e3c2aa29 inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31214b40b102ae7965c54354ec6cce45 inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a31214b40b102ae7965c54354ec6cce45">jb</a> () const</td></tr>
<tr class="memdesc:a31214b40b102ae7965c54354ec6cce45 inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access \( J_b\).  <a href="classoops_1_1CostFunction.html#a31214b40b102ae7965c54354ec6cce45">More...</a><br /></td></tr>
<tr class="separator:a31214b40b102ae7965c54354ec6cce45 inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dee360528ce876c3d1e4b7f217b802a inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">jterm</a> (const unsigned ii) const</td></tr>
<tr class="memdesc:a4dee360528ce876c3d1e4b7f217b802a inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access terms of the cost function other than \(J_b\).  <a href="classoops_1_1CostFunction.html#a4dee360528ce876c3d1e4b7f217b802a">More...</a><br /></td></tr>
<tr class="separator:a4dee360528ce876c3d1e4b7f217b802a inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acfb71d2502722de8f248bcbe1cf13f inherit pub_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a> () const</td></tr>
<tr class="memdesc:a3acfb71d2502722de8f248bcbe1cf13f inherit pub_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the numer of other cost function terms \(J_o, J_c, ..\).  <a href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">More...</a><br /></td></tr>
<tr class="separator:a3acfb71d2502722de8f248bcbe1cf13f inherit pub_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:ad3421d7225ee13dbbda107c59967358d"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> = <a class="el" href="classoops_1_1Increment.html">Increment</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:ad3421d7225ee13dbbda107c59967358d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0465daf778ea60b642c17dfdc5f3df67"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> = <a class="el" href="classoops_1_1ControlIncrement.html">ControlIncrement</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a0465daf778ea60b642c17dfdc5f3df67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed9a9b0b67d604ae3eb04c4a4685d04"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> = <a class="el" href="classoops_1_1ControlVariable.html">ControlVariable</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a1ed9a9b0b67d604ae3eb04c4a4685d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e9628c64a8f540f1841be827c865bd"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a80e9628c64a8f540f1841be827c865bd">CostFct_</a> = <a class="el" href="classoops_1_1CostFunction.html">CostFunction</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a80e9628c64a8f540f1841be827c865bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ec3f9b3f42c160be9d697b0b0f762d"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> = <a class="el" href="classoops_1_1Geometry.html">Geometry</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:ad9ec3f9b3f42c160be9d697b0b0f762d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e0c4230431691e8467ebfd3583ec3a"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> = <a class="el" href="classoops_1_1State.html">State</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:ac6e0c4230431691e8467ebfd3583ec3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb80c766eb605d5ebc6e567afdeb8809"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#adb80c766eb605d5ebc6e567afdeb8809">Model_</a> = <a class="el" href="classoops_1_1Model.html">Model</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:adb80c766eb605d5ebc6e567afdeb8809"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71351975edcfaee429854c8700712834"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a71351975edcfaee429854c8700712834">Variables_</a> = <a class="el" href="classoops_1_1Variables.html">Variables</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a71351975edcfaee429854c8700712834"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ccc76ec8f4e4d592c2612771a13bcdf"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a4ccc76ec8f4e4d592c2612771a13bcdf">Advector_</a> = <a class="el" href="classoops_1_1AdvectorHandler.html">AdvectorHandler</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a4ccc76ec8f4e4d592c2612771a13bcdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf49059361edb2548fc39848e5b73d86"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#aaf49059361edb2548fc39848e5b73d86">JqTerm_</a> = <a class="el" href="classoops_1_1JqTerm.html">JqTerm</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:aaf49059361edb2548fc39848e5b73d86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2408cc69c0e08f7d35b927a4a366fe22"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a2408cc69c0e08f7d35b927a4a366fe22">TrajectorySaver_</a> = <a class="el" href="classoops_1_1TrajectorySaverMF.html">TrajectorySaverMF</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a2408cc69c0e08f7d35b927a4a366fe22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab95508ae4bc396c30e8b3316c456cdd3"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ab95508ae4bc396c30e8b3316c456cdd3">WeightedDiff_</a> = <a class="el" href="classoops_1_1WeightedDiff.html">WeightedDiff</a>&lt; MODEL, <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a>, <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt;</td></tr>
<tr class="separator:ab95508ae4bc396c30e8b3316c456cdd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a949b93cb5d1a70ee4c2bdbe93e9bdaa1"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a949b93cb5d1a70ee4c2bdbe93e9bdaa1">WeightedMean_</a> = <a class="el" href="classoops_1_1DFIProcessor.html">DFIProcessor</a>&lt; MODEL &gt;</td></tr>
<tr class="separator:a949b93cb5d1a70ee4c2bdbe93e9bdaa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a0a6b2a4d0e8f0575b0c04a0d817c085c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a0a6b2a4d0e8f0575b0c04a0d817c085c">addIncr</a> (<a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;, const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> &amp;, <a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt; &amp;) const override</td></tr>
<tr class="memdesc:a0a6b2a4d0e8f0575b0c04a0d817c085c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add increment to the first guess ( with FullPos change of resolution )  <a href="classoops_1_1CostFct4DVarMF.html#a0a6b2a4d0e8f0575b0c04a0d817c085c">More...</a><br /></td></tr>
<tr class="separator:a0a6b2a4d0e8f0575b0c04a0d817c085c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a4a40938eb6225b745aef225a7aa4af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoops_1_1CostJbState.html">CostJbState</a>&lt; MODEL &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a1a4a40938eb6225b745aef225a7aa4af">newJb</a> (const eckit::Configuration &amp;, const <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> &amp;, const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;) const override</td></tr>
<tr class="memdesc:a1a4a40938eb6225b745aef225a7aa4af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the \(J_b, J_q\) term of the cost function.  <a href="classoops_1_1CostFct4DVarMF.html#a1a4a40938eb6225b745aef225a7aa4af">More...</a><br /></td></tr>
<tr class="separator:a1a4a40938eb6225b745aef225a7aa4af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b1d97e80575d7ddd027700e36b25b0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoops_1_1CostJo.html">CostJo</a>&lt; MODEL &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a3b1d97e80575d7ddd027700e36b25b0a">newJo</a> (const eckit::Configuration &amp;) const override</td></tr>
<tr class="memdesc:a3b1d97e80575d7ddd027700e36b25b0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the \(J_o\) term of the cost function.  <a href="classoops_1_1CostFct4DVarMF.html#a3b1d97e80575d7ddd027700e36b25b0a">More...</a><br /></td></tr>
<tr class="separator:a3b1d97e80575d7ddd027700e36b25b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9547dce8273ee934b0cdcb18a1461f85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoops_1_1CostTermBase.html">CostTermBase</a>&lt; MODEL &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a9547dce8273ee934b0cdcb18a1461f85">newJc</a> (const eckit::Configuration &amp;, const <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> &amp;) const override</td></tr>
<tr class="memdesc:a9547dce8273ee934b0cdcb18a1461f85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create other terms of the cost function \(J_c, ..\).  <a href="classoops_1_1CostFct4DVarMF.html#a9547dce8273ee934b0cdcb18a1461f85">More...</a><br /></td></tr>
<tr class="separator:a9547dce8273ee934b0cdcb18a1461f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa18ec114b6722de120d590a1d9b3deff"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#aa18ec114b6722de120d590a1d9b3deff">costJoJc_</a></td></tr>
<tr class="separator:aa18ec114b6722de120d590a1d9b3deff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f47053b5a3e8f3fca5f0832e54a6eb3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a5f47053b5a3e8f3fca5f0832e54a6eb3">costJb_</a></td></tr>
<tr class="separator:a5f47053b5a3e8f3fca5f0832e54a6eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c1844e51d3d78f1f84c398227b95ae"><td class="memItemLeft" align="right" valign="top">util::Duration&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a></td></tr>
<tr class="separator:a76c1844e51d3d78f1f84c398227b95ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73cc69ea611e9f6605951da639bb452f"><td class="memItemLeft" align="right" valign="top">util::DateTime&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a></td></tr>
<tr class="separator:a73cc69ea611e9f6605951da639bb452f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d38395aafab2f4a0f01370cc0a9ce37"><td class="memItemLeft" align="right" valign="top">util::DateTime&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">windowEnd_</a></td></tr>
<tr class="separator:a2d38395aafab2f4a0f01370cc0a9ce37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c7093b0eb2c15c3e32c801efc6cbb8"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">geom_</a></td></tr>
<tr class="separator:ac7c7093b0eb2c15c3e32c801efc6cbb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3af8ff8aff5ab89b00dd84808be6aaa"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a71351975edcfaee429854c8700712834">Variables_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3af8ff8aff5ab89b00dd84808be6aaa">ctlvars_</a></td></tr>
<tr class="separator:ad3af8ff8aff5ab89b00dd84808be6aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9dbc320847cc239fafd5b1313bbf15e"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9dbc320847cc239fafd5b1313bbf15e">fglr_</a></td></tr>
<tr class="separator:ad9dbc320847cc239fafd5b1313bbf15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d525c2e1cb71c2a99423596b9061023"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a0d525c2e1cb71c2a99423596b9061023">biasDFI_</a></td></tr>
<tr class="memdesc:a0d525c2e1cb71c2a99423596b9061023"><td class="mdescLeft">&#160;</td><td class="mdescRight">biasDFI calculated in the first trajectory and used at the end  <a href="classoops_1_1CostFct4DVarMF.html#a0d525c2e1cb71c2a99423596b9061023">More...</a><br /></td></tr>
<tr class="separator:a0d525c2e1cb71c2a99423596b9061023"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_classoops_1_1CostFunction"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classoops_1_1CostFunction')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction&lt; MODEL &gt;</a></td></tr>
<tr class="memitem:acf056c68294bc35901fd5eaec230adcf inherit pub_static_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">static const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#acf056c68294bc35901fd5eaec230adcf">classname</a> ()</td></tr>
<tr class="separator:acf056c68294bc35901fd5eaec230adcf inherit pub_static_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classoops_1_1CostFunction"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoops_1_1CostFunction')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classoops_1_1CostFunction.html">oops::CostFunction&lt; MODEL &gt;</a></td></tr>
<tr class="memitem:a56903c9685b92ca9ca3fe86fef575b75 inherit pro_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a56903c9685b92ca9ca3fe86fef575b75">setupTerms</a> (const eckit::Configuration &amp;)</td></tr>
<tr class="memdesc:a56903c9685b92ca9ca3fe86fef575b75 inherit pro_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up terms of the cost function \(J_b, J_q, J_o, J_c, ..\).  <a href="classoops_1_1CostFunction.html#a56903c9685b92ca9ca3fe86fef575b75">More...</a><br /></td></tr>
<tr class="separator:a56903c9685b92ca9ca3fe86fef575b75 inherit pro_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f4f68fcccc83a0bba4809bf8c3f627 inherit pro_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#af2c79bedb948f2b6ad9866d7fd9c6b73">Model_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ab7f4f68fcccc83a0bba4809bf8c3f627">getModel</a> () const</td></tr>
<tr class="memdesc:ab7f4f68fcccc83a0bba4809bf8c3f627 inherit pro_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access the non-linear model.  <a href="classoops_1_1CostFunction.html#ab7f4f68fcccc83a0bba4809bf8c3f627">More...</a><br /></td></tr>
<tr class="separator:ab7f4f68fcccc83a0bba4809bf8c3f627 inherit pro_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae32f3ea0616c66080e198dff2b0038af inherit pro_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ae32f3ea0616c66080e198dff2b0038af">getTLM</a> (const unsigned isub=0) const</td></tr>
<tr class="memdesc:ae32f3ea0616c66080e198dff2b0038af inherit pro_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access the linear model.  <a href="classoops_1_1CostFunction.html#ae32f3ea0616c66080e198dff2b0038af">More...</a><br /></td></tr>
<tr class="separator:ae32f3ea0616c66080e198dff2b0038af inherit pro_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab990f92a2ee09606884854e35ca67024 inherit pro_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ab990f92a2ee09606884854e35ca67024">recentreBackground</a> (const eckit::Configuration &amp;)</td></tr>
<tr class="memdesc:ab990f92a2ee09606884854e35ca67024 inherit pro_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-centre the background.  <a href="classoops_1_1CostFunction.html#ab990f92a2ee09606884854e35ca67024">More...</a><br /></td></tr>
<tr class="separator:ab990f92a2ee09606884854e35ca67024 inherit pro_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7462cc85a443a23ba769995acc5d5bc0 inherit pro_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoops_1_1CostFunction.html#ad912c40552a91737b416a030955a6adb">CostBase_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">getJterm</a> (const unsigned ii) const</td></tr>
<tr class="memdesc:a7462cc85a443a23ba769995acc5d5bc0 inherit pro_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non const access to JTerms for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions.  <a href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">More...</a><br /></td></tr>
<tr class="separator:a7462cc85a443a23ba769995acc5d5bc0 inherit pro_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8de01ffb54d775a6a7e1630c341d7ab inherit pro_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoops_1_1CostFunction.html#a0c3eed43284eb0c7f12af9ecb738eba3">JbTotal_</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#ac8de01ffb54d775a6a7e1630c341d7ab">getJb</a> () const</td></tr>
<tr class="memdesc:ac8de01ffb54d775a6a7e1630c341d7ab inherit pro_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non const access to Jb for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions <br  />
  <a href="classoops_1_1CostFunction.html#ac8de01ffb54d775a6a7e1630c341d7ab">More...</a><br /></td></tr>
<tr class="separator:ac8de01ffb54d775a6a7e1630c341d7ab inherit pro_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3daac3ea30f0a1145118234a85bb6e inherit pro_methods_classoops_1_1CostFunction"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classoops_1_1CostFunction.html#a640206ef3ebb11edbfc1ae92c4a726c5">LinearModel_</a> &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoops_1_1CostFunction.html#a7f3daac3ea30f0a1145118234a85bb6e">getTLMs</a> ()</td></tr>
<tr class="memdesc:a7f3daac3ea30f0a1145118234a85bb6e inherit pro_methods_classoops_1_1CostFunction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non const access to TL <a class="el" href="classoops_1_1Model.html" title="Encapsulates the nonlinear forecast model.">Model</a> for <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be" title="Linearise the cost function: set up the quadratic cost function.">linearize()</a> method in concrete cost-functions <br  />
  <a href="classoops_1_1CostFunction.html#a7f3daac3ea30f0a1145118234a85bb6e">More...</a><br /></td></tr>
<tr class="separator:a7f3daac3ea30f0a1145118234a85bb6e inherit pro_methods_classoops_1_1CostFunction"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename MODEL&gt;<br />
class oops::CostFct4DVarMF&lt; MODEL &gt;</h3>

<p>4D-Var Cost Function in the ARPEGE </p>
<p>This class implements a specific linearize method for ARPEGE. The model trajectory is calculated at low resolution and the changes of resolution are made with FullPos </p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00054">54</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a4ccc76ec8f4e4d592c2612771a13bcdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ccc76ec8f4e4d592c2612771a13bcdf">&#9670;&nbsp;</a></span>Advector_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#a4ccc76ec8f4e4d592c2612771a13bcdf">Advector_</a> =  <a class="el" href="classoops_1_1AdvectorHandler.html">AdvectorHandler</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00063">63</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="a80e9628c64a8f540f1841be827c865bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80e9628c64a8f540f1841be827c865bd">&#9670;&nbsp;</a></span>CostFct_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#a80e9628c64a8f540f1841be827c865bd">CostFct_</a> =  <a class="el" href="classoops_1_1CostFunction.html">CostFunction</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00058">58</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="a0465daf778ea60b642c17dfdc5f3df67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0465daf778ea60b642c17dfdc5f3df67">&#9670;&nbsp;</a></span>CtrlInc_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> =  <a class="el" href="classoops_1_1ControlIncrement.html">ControlIncrement</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00056">56</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="a1ed9a9b0b67d604ae3eb04c4a4685d04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed9a9b0b67d604ae3eb04c4a4685d04">&#9670;&nbsp;</a></span>CtrlVar_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> =  <a class="el" href="classoops_1_1ControlVariable.html">ControlVariable</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00057">57</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="ad9ec3f9b3f42c160be9d697b0b0f762d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9ec3f9b3f42c160be9d697b0b0f762d">&#9670;&nbsp;</a></span>Geometry_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> =  <a class="el" href="classoops_1_1Geometry.html">Geometry</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00059">59</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="ad3421d7225ee13dbbda107c59967358d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3421d7225ee13dbbda107c59967358d">&#9670;&nbsp;</a></span>Increment_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> =  <a class="el" href="classoops_1_1Increment.html">Increment</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00055">55</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="aaf49059361edb2548fc39848e5b73d86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf49059361edb2548fc39848e5b73d86">&#9670;&nbsp;</a></span>JqTerm_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#aaf49059361edb2548fc39848e5b73d86">JqTerm_</a> =  <a class="el" href="classoops_1_1JqTerm.html">JqTerm</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00064">64</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="adb80c766eb605d5ebc6e567afdeb8809"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb80c766eb605d5ebc6e567afdeb8809">&#9670;&nbsp;</a></span>Model_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#adb80c766eb605d5ebc6e567afdeb8809">Model_</a> =  <a class="el" href="classoops_1_1Model.html">Model</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00061">61</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="ac6e0c4230431691e8467ebfd3583ec3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6e0c4230431691e8467ebfd3583ec3a">&#9670;&nbsp;</a></span>State_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> =  <a class="el" href="classoops_1_1State.html">State</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00060">60</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="a2408cc69c0e08f7d35b927a4a366fe22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2408cc69c0e08f7d35b927a4a366fe22">&#9670;&nbsp;</a></span>TrajectorySaver_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#a2408cc69c0e08f7d35b927a4a366fe22">TrajectorySaver_</a> =  <a class="el" href="classoops_1_1TrajectorySaverMF.html">TrajectorySaverMF</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00065">65</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="a71351975edcfaee429854c8700712834"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71351975edcfaee429854c8700712834">&#9670;&nbsp;</a></span>Variables_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#a71351975edcfaee429854c8700712834">Variables_</a> =  <a class="el" href="classoops_1_1Variables.html">Variables</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00062">62</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="ab95508ae4bc396c30e8b3316c456cdd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab95508ae4bc396c30e8b3316c456cdd3">&#9670;&nbsp;</a></span>WeightedDiff_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#ab95508ae4bc396c30e8b3316c456cdd3">WeightedDiff_</a> =  <a class="el" href="classoops_1_1WeightedDiff.html">WeightedDiff</a>&lt;MODEL, <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a>, <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a>&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00066">66</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="a949b93cb5d1a70ee4c2bdbe93e9bdaa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a949b93cb5d1a70ee4c2bdbe93e9bdaa1">&#9670;&nbsp;</a></span>WeightedMean_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html#a949b93cb5d1a70ee4c2bdbe93e9bdaa1">WeightedMean_</a> =  <a class="el" href="classoops_1_1DFIProcessor.html">DFIProcessor</a>&lt;MODEL&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00067">67</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab4f24724380c63316f0762991693dc9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4f24724380c63316f0762991693dc9c">&#9670;&nbsp;</a></span>CostFct4DVarMF()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::<a class="el" href="classoops_1_1CostFct4DVarMF.html">CostFct4DVarMF</a> </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> &amp;&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#adb80c766eb605d5ebc6e567afdeb8809">Model_</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create J components \(J_b\) , \(J_o\), \(J_c\) ...</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00143">143</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    : <a class="code" href="classoops_1_1CostFunction.html#a0bcfda435fb7dd9cd18f94aa10ce60fb">CostFunction&lt;MODEL&gt;::CostFunction</a>(config, geom, model),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">geom_</a>(geom),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <a class="code" href="classoops_1_1CostFct4DVarMF.html#ad3af8ff8aff5ab89b00dd84808be6aaa">ctlvars_</a>(config) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFct4DVarMF:CostFct4DVarMF&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a> = util::Duration(config.getString(<span class="stringliteral">&quot;window_length&quot;</span>));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a> = util::DateTime(config.getString(<span class="stringliteral">&quot;window_begin&quot;</span>));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">windowEnd_</a> = <a class="code" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a> + <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a56903c9685b92ca9ca3fe86fef575b75">setupTerms</a>(config);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFct4DVarMF constructed&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFunction_8h_source.html#l00317">oops::CostFunction&lt; MODEL &gt;::setupTerms()</a>, <a class="el" href="CostFct4DVarMF_8h_source.html#l00129">oops::CostFct4DVarMF&lt; MODEL &gt;::windowBegin_</a>, <a class="el" href="CostFct4DVarMF_8h_source.html#l00130">oops::CostFct4DVarMF&lt; MODEL &gt;::windowEnd_</a>, and <a class="el" href="CostFct4DVarMF_8h_source.html#l00128">oops::CostFct4DVarMF&lt; MODEL &gt;::windowLength_</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_ab4f24724380c63316f0762991693dc9c_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_ab4f24724380c63316f0762991693dc9c_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_ab4f24724380c63316f0762991693dc9c_cgraph" id="classoops_1_1CostFct4DVarMF_ab4f24724380c63316f0762991693dc9c_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,163,65"/>
<area shape="rect" href="classoops_1_1CostFunction.html#a56903c9685b92ca9ca3fe86fef575b75" title="Set up terms of the cost function ." alt="" coords="211,23,344,65"/>
<area shape="rect" href="classoops_1_1CostJo.html#a6fc72d99578f3d4ce6244e520c25c905" title="Access observation spaces." alt="" coords="408,5,567,32"/>
<area shape="rect" href="classoops_1_1CostJo.html#a3e8ca24a08b0dfc2e3ff9c280036d701" title="Set xb." alt="" coords="392,56,583,83"/>
</map>
</div>

</div>
</div>
<a id="a9af8ce8e8eedc84e41dc9011053c0654"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9af8ce8e8eedc84e41dc9011053c0654">&#9670;&nbsp;</a></span>~CostFct4DVarMF()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::~<a class="el" href="classoops_1_1CostFct4DVarMF.html">CostFct4DVarMF</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00072">72</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0a6b2a4d0e8f0575b0c04a0d817c085c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a6b2a4d0e8f0575b0c04a0d817c085c">&#9670;&nbsp;</a></span>addIncr()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::addIncr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>xfghr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname"><em>dxlr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt; &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add increment to the first guess ( with FullPos change of resolution ) </p>
<p>\(x_{hr}^{g} = {fullpos}_{l2h}(x_{lr}^{g})\)</p>
<p>\(x_{hr}^{a} = {fullpos}_{l2h}(x_{lr}^{g} + {\delta x}_{lr})\)</p>
<p>\({\delta x}_{hr} = x_{hr}^{a} - x_{hr}^{g}\)</p>
<p>\(x_{hr}^{g} += {\delta x}_{hr}\)</p>

<p>Implements <a class="el" href="classoops_1_1CostFunction.html#ac09a7ac7491959d035da33317c994c4e">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a22c1ae6b8c0ca291fbc468567d126b90">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00454">454</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                                       {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  ASSERT(xfghr.state().checkStatesNumber(1));</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> fghr(<a class="code" href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">geom_</a>, *<a class="code" href="classoops_1_1CostFct4DVarMF.html#ad9dbc320847cc239fafd5b1313bbf15e">fglr_</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  (*fglr_) += dxlr.state()[0];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> xahr(<a class="code" href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">geom_</a>, *<a class="code" href="classoops_1_1CostFct4DVarMF.html#ad9dbc320847cc239fafd5b1313bbf15e">fglr_</a>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> dxhr(<a class="code" href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">geom_</a>, dxlr.state()[0]);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  dxhr.diff(xahr, fghr);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  xfghr.state()[0] += dxhr;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="State4D_8h_source.html#l00058">oops::State4D&lt; MODEL &gt;::checkStatesNumber()</a>, <a class="el" href="oops_2interface_2Increment_8h_source.html#l00248">oops::Increment&lt; MODEL &gt;::diff()</a>, <a class="el" href="ControlVariable_8h_source.html#l00131">oops::ControlVariable&lt; MODEL &gt;::state()</a>, and <a class="el" href="ControlIncrement_8h_source.html#l00145">oops::ControlIncrement&lt; MODEL &gt;::state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_a0a6b2a4d0e8f0575b0c04a0d817c085c_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_a0a6b2a4d0e8f0575b0c04a0d817c085c_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_a0a6b2a4d0e8f0575b0c04a0d817c085c_cgraph" id="classoops_1_1CostFct4DVarMF_a0a6b2a4d0e8f0575b0c04a0d817c085c_cgraph">
<area shape="rect" title="Add increment to the first guess ( with FullPos change of resolution )" alt="" coords="5,93,163,135"/>
<area shape="rect" href="classoops_1_1State4D.html#aa91b6d67d3eeb16575b479c7008c1f3c" title="Get model space control variable." alt="" coords="211,5,393,47"/>
<area shape="rect" href="classoops_1_1Increment.html#a09e5a764457558dfc8034241edecb4d8" title="Compute increment as a difference between two States." alt="" coords="233,71,371,98"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#ae32877503a550f7d6d59b307e9da310a" title="Returns a 4D state component of the control variable." alt="" coords="230,123,374,164"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a3e7a0c18fd7fb27befb798c8e1af4a6f" title="Get state control increment." alt="" coords="225,188,379,229"/>
<area shape="rect" href="classoops_1_1State.html#a604088ba96bafab8955158221be192f8" title="Return a reference to the model specific state." alt="" coords="441,71,564,98"/>
</map>
</div>

</div>
</div>
<a id="a00f335802ebc2b48d32270f8a12a27cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00f335802ebc2b48d32270f8a12a27cc">&#9670;&nbsp;</a></span>evaluate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::evaluate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>fguess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>config</em> = <code>eckit::LocalConfiguration()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em> = <code><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt;<a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a>&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate the non-linear cost function. </p>
<ol type="1">
<li>Setup DFI</li>
<li>Call standard J.evaluate()</li>
<li><p class="startli">Write analysis state in the middle of the window, filtered with incremental DFI</p>
<p class="startli">\(\widetilde{x}^{a}=DFI(x^{a})\)</p>
<p class="startli">\(x_{+3h}^{a}=x_{+3h}^{b}+(\widetilde{x}^{a}-\widetilde{x}^{b}) =x_{+3h}^{b}+\widetilde{\delta x}\)</p>
<p class="startli">\(x_{+3h}^{a}=\widetilde{x}^{a}+(x_{+3h}^{b}-\widetilde{x}^{b}) =x^{b}+biasDFI\)</p>
</li>
</ol>

<p>Reimplemented from <a class="el" href="classoops_1_1CostFunction.html#a7dfe7e1cc401e3206e0a0db086f43c72">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a112fb52065fabbc128a608246f6fb245">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00161">161</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                                       {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFct4DVarMF::evaluate start&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  PostProcessor&lt;State_&gt; pp(post);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  std::shared_ptr&lt;WeightedMean_&gt; pdfi;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">if</span> (config.has(<span class="stringliteral">&quot;dfi&quot;</span>)) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">const</span> eckit::LocalConfiguration dfiConf(config, <span class="stringliteral">&quot;dfi&quot;</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">const</span> util::Duration dfispan(dfiConf.getString(<span class="stringliteral">&quot;filter_span&quot;</span>));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">const</span> util::DateTime dfitime(fguess.state()[0].validTime() + dfispan / 2);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    pdfi.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#a949b93cb5d1a70ee4c2bdbe93e9bdaa1">WeightedMean_</a>(dfitime, dfispan, <a class="code" href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">geom_</a>, dfiConf));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    pp.enrollProcessor(pdfi);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordtype">double</span> zzz = this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a7dfe7e1cc401e3206e0a0db086f43c72">CostFunction&lt;MODEL&gt;::evaluate</a>(fguess, config, pp);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">if</span> (config.has(<span class="stringliteral">&quot;dfi&quot;</span>)) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">const</span> eckit::LocalConfiguration dfiConf(config, <span class="stringliteral">&quot;dfi&quot;</span>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    std::unique_ptr&lt;State_&gt; xdfi(pdfi-&gt;releaseMean());</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    (*xdfi) += (*biasDFI_);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    Log::info() &lt;&lt; <span class="stringliteral">&quot;CostFunction: Write filtered analysis in the middle of the window.&quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    xdfi-&gt;write(eckit::LocalConfiguration(dfiConf, <span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  Log::trace() &lt;&lt; <span class="stringliteral">&quot;CostFct4DVarMF::evaluate done&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">return</span> zzz;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="PostProcessor_8h_source.html#l00055">oops::PostProcessor&lt; FLDS &gt;::enrollProcessor()</a>, <a class="el" href="CostFunction_8h_source.html#l00353">oops::CostFunction&lt; MODEL &gt;::evaluate()</a>, and <a class="el" href="ControlVariable_8h_source.html#l00131">oops::ControlVariable&lt; MODEL &gt;::state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_a00f335802ebc2b48d32270f8a12a27cc_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_a00f335802ebc2b48d32270f8a12a27cc_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_a00f335802ebc2b48d32270f8a12a27cc_cgraph" id="classoops_1_1CostFct4DVarMF_a00f335802ebc2b48d32270f8a12a27cc_cgraph">
<area shape="rect" title="Evaluate the non&#45;linear cost function." alt="" coords="5,35,163,76"/>
<area shape="rect" href="classoops_1_1PostProcessor.html#a2e1e3cbf40ede8e32a372d8b5b2c270d" title="Adds a post processor to the vector of post&#45;processors." alt="" coords="403,5,545,47"/>
<area shape="rect" href="classoops_1_1CostFunction.html#a7dfe7e1cc401e3206e0a0db086f43c72" title="Evaluate the non&#45;linear cost function." alt="" coords="216,35,349,76"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#ae32877503a550f7d6d59b307e9da310a" title="Returns a 4D state component of the control variable." alt="" coords="211,100,355,141"/>
</map>
</div>

</div>
</div>
<a id="a9bf02c9e1ceeb16874df7275ddefcbd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bf02c9e1ceeb16874df7275ddefcbd1">&#9670;&nbsp;</a></span>getCostJb()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double&amp; <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::getCostJb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the Jb cost function value. </p>

<p>Reimplemented from <a class="el" href="classoops_1_1CostFunction.html#a76653e44e1af57818b2086f32e15b262">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a46ca065ed8dea4b536d5297201686e07">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00106">106</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#a5f47053b5a3e8f3fca5f0832e54a6eb3">costJb_</a>;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFct4DVarMF_8h_source.html#l00126">oops::CostFct4DVarMF&lt; MODEL &gt;::costJb_</a>.</p>

</div>
</div>
<a id="a39128088d18168627d9be8f9f0fe3bba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39128088d18168627d9be8f9f0fe3bba">&#9670;&nbsp;</a></span>getCostJoJc()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double&amp; <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::getCostJoJc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the JoJc cost function value. </p>

<p>Reimplemented from <a class="el" href="classoops_1_1CostFunction.html#a2fd72c73930710b8b354ff36124555e5">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a96f6cd884d8a7d7de0ceff8faef9be58">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00103">103</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#aa18ec114b6722de120d590a1d9b3deff">costJoJc_</a>;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CostFct4DVarMF_8h_source.html#l00125">oops::CostFct4DVarMF&lt; MODEL &gt;::costJoJc_</a>.</p>

</div>
</div>
<a id="a02f6f4f1714c18c1fb9af0732a8f5792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f6f4f1714c18c1fb9af0732a8f5792">&#9670;&nbsp;</a></span>linearize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::linearize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>fguess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>innerConf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em> = <code><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt;<a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a>&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set up the quadratic cost function. Specific linearization for ARPEGE 4D-Var. </p>
<p>This method sets up the quadratic cost function by linearizing the non-linear cost function in the specific case of ARPEGE</p>
<p>Jo, Jc, .. (jterms_) terms of the cost function call their 'initialize' methods which return post-processors. These are subsequently attached to the non-linear trajectory and do their post-processing prior/during/after the trajectory evaluation; once the non-linear trajectory is completed, the terms of the cost function call their 'finalize' method which makes further use of the output acquired by the post-processors during the trajectory.</p>
<p>E.g. the 'initialize' method of the Jo term of the cost functions returns an <a class="el" href="classoops_1_1Observer.html" title="Computes .">Observer</a> post-processor. Its task is to compute model equivalents at observation locations. Once the trajectory evaluation is completed, the 'finalize' method is called to compute departures, perform screening if requested, set up the observation error covariance and print diagnostics.</p>
<p>If required, a DFI bias is calculated.</p>
<p>Prior to the computation of the linearisation trajectory by the <a class="el" href="classoops_1_1TrajectorySaver.html">TrajectorySaver</a>, the Jb, Jo, Jc, .. terms of the cost function call their 'initializeTraj' methods which return post-processors. These are subsequently enrolled into the <a class="el" href="classoops_1_1TrajectorySaver.html">TrajectorySaver</a> and attached to the linearisation trajectory computation. Once the linearisation trajectory computation is completed, the terms of the cost function call the 'finalizeTraj' method which makes further use of the output acquired by the post-processors during the computation of the linearisation trajectory.</p>
<p>E.g. the 'initializeTraj' method of the Jo term of the cost function sets up the linear observation operator and returns an <a class="el" href="classoops_1_1Observer.html" title="Computes .">Observer</a> post-processor. Its task is to compute the linearisation for the linear observation operator. Once the linearisation trajectory computation is completed, the 'finailzeTraj' method is called to compute the departures and print diagnostics.</p>
<ol type="1">
<li>Read inner loop configuration</li>
<li>Prepare DFI if required If needed, the background +3H is written</li>
<li><a class="el" href="classoops_1_1Run.html">Run</a> non linear model at high resolution with screening, if required Calculate non linear Jo (without Jc)</li>
<li><p class="startli">Put filter aside for usage after the final trajectory (biasDFI)</p>
<p class="startli">\(\widetilde{x}^{b}=DFI(x^{b})\)</p>
<p class="startli">\(biasDFI=x_{+3h}^{b}-\widetilde{x}^{b}\)</p>
</li>
<li>Calculate first guess at low resolution with FullPos</li>
<li><p class="startli"><a class="el" href="classoops_1_1Run.html">Run</a> NL model at low resolution. The <a class="el" href="classoops_1_1PostProcessor.html" title="Control model post processing.">PostProcessor</a> object contains:</p>
<p class="startli">Only horizontal interpolation of observation operators <a class="el" href="classoops_1_1Model.html" title="Encapsulates the nonlinear forecast model.">Model</a> trajectory saver <a class="el" href="classoops_1_1Advector.html" title="Advection operator.">Advector</a> builder in the case of Hybrid4D, the wind fields at each timeslot of the 4D <a class="el" href="classoops_1_1ControlVariable.html" title="Control Variable.">ControlVariable</a> is given to the <a class="el" href="classoops_1_1Advector.html" title="Advection operator.">Advector</a> object.</p>
</li>
<li>Calculate Jb value</li>
<li>Print cost function value</li>
</ol>

<p>Reimplemented from <a class="el" href="classoops_1_1CostFunction.html#a9f5436014c826918c0593d55f07df3be">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="classoops_1_1CostFct4DVarTrajHR.html#a7c4ae909393cb470512d124e967ed585">oops::CostFct4DVarTrajHR&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00205">205</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                                                  {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keyword">const</span> eckit::LocalConfiguration resConf(innerConf, <span class="stringliteral">&quot;resolution&quot;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keyword">const</span> eckit::LocalConfiguration tlmConf(innerConf, <span class="stringliteral">&quot;linearmodel&quot;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  std::unique_ptr&lt;eckit::LocalConfiguration&gt; dfiConf;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keyword">const</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> lowres(resConf);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  std::shared_ptr&lt;WeightedDiff_&gt; pdfi;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  std::unique_ptr&lt;WeightingFct&gt; wfct;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  PostProcessor&lt;State_&gt; pp(post);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  pp.enrollProcessor(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">getJterm</a>(0).initialize(fguess, innerConf));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">if</span> (innerConf.has(<span class="stringliteral">&quot;screening.dfi&quot;</span>)) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    dfiConf.reset(<span class="keyword">new</span> eckit::LocalConfiguration(innerConf, <span class="stringliteral">&quot;screening.dfi&quot;</span>));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">const</span> util::Duration dfispan(dfiConf-&gt;getString(<span class="stringliteral">&quot;filter_span&quot;</span>));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keyword">const</span> util::DateTime dfitime(fguess.state()[0].validTime() + dfispan / 2);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    wfct.reset(<span class="keyword">new</span> DolphChebyshev(*dfiConf));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    pdfi.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#ab95508ae4bc396c30e8b3316c456cdd3">WeightedDiff_</a>(dfitime, dfispan, <a class="code" href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">geom_</a>, *dfiConf, util::Duration(0), *wfct));</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    pp.enrollProcessor(pdfi);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (dfiConf-&gt;has(<span class="stringliteral">&quot;output&quot;</span>)) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keyword">const</span> eckit::LocalConfiguration outConfig(*dfiConf, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      pp.enrollProcessor(<span class="keyword">new</span> StateWriter&lt;State_&gt;(fguess.state()[0].validTime(), outConfig));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">if</span> (innerConf.has(<span class="stringliteral">&quot;low_resolution_model&quot;</span>)) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> fghr(fguess);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    this-&gt;<a class="code" href="classoops_1_1CostFct4DVarMF.html#a299d2d78c12ec362264601bf7ecc1dfc">runNL</a>(fghr, pp);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classoops_1_1CostFct4DVarMF.html#aa18ec114b6722de120d590a1d9b3deff">costJoJc_</a> = this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">getJterm</a>(0).<a class="code" href="classoops_1_1CostTermBase.html#a57e653ebb4c983b00a50c6b7fa50b8aa">finalize</a>(innerConf);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (innerConf.has(<span class="stringliteral">&quot;screening.dfi&quot;</span>)) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classoops_1_1CostFct4DVarMF.html#a0d525c2e1cb71c2a99423596b9061023">biasDFI_</a>.reset(pdfi-&gt;releaseDiff());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    (*biasDFI_) *= -1.0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  std::unique_ptr&lt;CtrlVar_&gt; fglr;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  std::unique_ptr&lt;Model_&gt; lowResolModel;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">if</span> (innerConf.has(<span class="stringliteral">&quot;low_resolution_model&quot;</span>)) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    PostProcessor&lt;State_&gt; no_post;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keyword">const</span> eckit::LocalConfiguration modelConfig(innerConf,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                <span class="stringliteral">&quot;low_resolution_model&quot;</span>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    lowResolModel.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#adb80c766eb605d5ebc6e567afdeb8809">Model_</a>(lowres, modelConfig));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    malloc_trim(0);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    fglr.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a>(lowres, fguess));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    lowResolModel-&gt;forecast(fglr-&gt;state()[0], fglr-&gt;modVar(), util::Duration(0),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                            no_post);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    fglr.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a>(fguess));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// 6. Setup trajectory calculation at low resolution</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  PostProcessor&lt;State_&gt; pplr(post);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  std::shared_ptr&lt;JqTerm_&gt; jq(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#ac8de01ffb54d775a6a7e1630c341d7ab">getJb</a>().initializeTraj(*fglr, lowres, innerConf));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  pplr.enrollProcessor(jq);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iterm=0; iterm &lt; this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a>(); ++iterm) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    pplr.enrollProcessor(this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">getJterm</a>(iterm).<a class="code" href="classoops_1_1CostTermBase.html#a0179c6c57603aaf9b2d193ed189c2a52">initializeTraj</a>(*fglr, lowres, innerConf));</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  std::shared_ptr&lt;TrajectorySaver_ &gt; trajectorySaver(</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keyword">new</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#a2408cc69c0e08f7d35b927a4a366fe22">TrajectorySaver_</a>(fglr-&gt;state()[0], fglr-&gt;modVar(), lowres,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          this-&gt;getTLMs(), tlmConf));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  pplr.enrollProcessor(trajectorySaver);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  std::shared_ptr&lt;Advector_ &gt; advector = <a class="code" href="classoops_1_1AdvectorHandler.html#a7cf7b5f1529c5417c8c3c13ae20526ed">Advector_::get</a>();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> (advector) pplr.enrollProcessor(advector);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span> (innerConf.has(<span class="stringliteral">&quot;low_resolution_model&quot;</span>)) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    util::LogbookWriter&lt;std::string&gt; log(<span class="stringliteral">&quot;MF4DVarTrajectory&quot;</span>,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                         <span class="stringliteral">&quot;onlyHorizInterpol&quot;</span>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    this-&gt;<a class="code" href="classoops_1_1CostFct4DVarMF.html#a299d2d78c12ec362264601bf7ecc1dfc">runNL</a>(*fglr, *lowResolModel, pplr);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> x0(*fglr);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    this-&gt;<a class="code" href="classoops_1_1CostFct4DVarMF.html#a299d2d78c12ec362264601bf7ecc1dfc">runNL</a>(x0, pplr);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#a5f47053b5a3e8f3fca5f0832e54a6eb3">costJb_</a> = this-&gt;<a class="code" href="classoops_1_1CostFunction.html#ac8de01ffb54d775a6a7e1630c341d7ab">getJb</a>().<a class="code" href="classoops_1_1CostJbTotal.html#add261887551c52f893e6485e3c84be29">finalizeTraj</a>(jq.get(), innerConf);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">if</span> (innerConf.has(<span class="stringliteral">&quot;low_resolution_model&quot;</span>)) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">double</span> costJoJc = 0.0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">/* Do not change Jo.gradFG */</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iterm=1; iterm &lt; this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a>(); ++iterm) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      costJoJc += this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">getJterm</a>(iterm).<a class="code" href="classoops_1_1CostTermBase.html#a9978e5ad0a907e52ab609f26fc3b89e6">finalizeTraj</a>(innerConf);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="classoops_1_1CostFct4DVarMF.html#aa18ec114b6722de120d590a1d9b3deff">costJoJc_</a> = 0.0;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iterm=0; iterm &lt; this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">nterms</a>(); ++iterm) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <a class="code" href="classoops_1_1CostFct4DVarMF.html#aa18ec114b6722de120d590a1d9b3deff">costJoJc_</a> += this-&gt;<a class="code" href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">getJterm</a>(iterm).<a class="code" href="classoops_1_1CostTermBase.html#a9978e5ad0a907e52ab609f26fc3b89e6">finalizeTraj</a>(innerConf);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordtype">double</span> costJ = <a class="code" href="classoops_1_1CostFct4DVarMF.html#a5f47053b5a3e8f3fca5f0832e54a6eb3">costJb_</a> + <a class="code" href="classoops_1_1CostFct4DVarMF.html#aa18ec114b6722de120d590a1d9b3deff">costJoJc_</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  Log::test() &lt;&lt; <span class="stringliteral">&quot;CostFunction: Nonlinear J = &quot;</span> &lt;&lt; costJ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">return</span> costJ;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="PostProcessor_8h_source.html#l00055">oops::PostProcessor&lt; FLDS &gt;::enrollProcessor()</a>, and <a class="el" href="ControlVariable_8h_source.html#l00131">oops::ControlVariable&lt; MODEL &gt;::state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_a02f6f4f1714c18c1fb9af0732a8f5792_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_a02f6f4f1714c18c1fb9af0732a8f5792_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_a02f6f4f1714c18c1fb9af0732a8f5792_cgraph" id="classoops_1_1CostFct4DVarMF_a02f6f4f1714c18c1fb9af0732a8f5792_cgraph">
<area shape="rect" title="Set up the quadratic cost function. Specific linearization for ARPEGE 4D&#45;Var." alt="" coords="5,39,163,80"/>
<area shape="rect" href="classoops_1_1PostProcessor.html#a2e1e3cbf40ede8e32a372d8b5b2c270d" title="Adds a post processor to the vector of post&#45;processors." alt="" coords="211,5,354,47"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#ae32877503a550f7d6d59b307e9da310a" title="Returns a 4D state component of the control variable." alt="" coords="211,71,355,112"/>
</map>
</div>

</div>
</div>
<a id="a1a4a40938eb6225b745aef225a7aa4af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a4a40938eb6225b745aef225a7aa4af">&#9670;&nbsp;</a></span>newJb()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoops_1_1CostJbState.html">CostJbState</a>&lt; MODEL &gt; * <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::newJb </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>jbConf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> &amp;&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>xb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create the \(J_b, J_q\) term of the cost function. </p>

<p>Implements <a class="el" href="classoops_1_1CostFunction.html#a77d9df27308e186f507bcffba3d55c13">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00364">364</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                              {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  ASSERT(xb.state().checkStatesNumber(1));</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> CostJb3D&lt;MODEL&gt;(jbConf, geom, <a class="code" href="classoops_1_1CostFct4DVarMF.html#ad3af8ff8aff5ab89b00dd84808be6aaa">ctlvars_</a>, <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a>,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                             xb.state()[0]);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="State4D_8h_source.html#l00058">oops::State4D&lt; MODEL &gt;::checkStatesNumber()</a>, and <a class="el" href="ControlVariable_8h_source.html#l00131">oops::ControlVariable&lt; MODEL &gt;::state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_a1a4a40938eb6225b745aef225a7aa4af_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_a1a4a40938eb6225b745aef225a7aa4af_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_a1a4a40938eb6225b745aef225a7aa4af_cgraph" id="classoops_1_1CostFct4DVarMF_a1a4a40938eb6225b745aef225a7aa4af_cgraph">
<area shape="rect" title="Create the &#160;term of the cost function." alt="" coords="5,39,163,80"/>
<area shape="rect" href="classoops_1_1State4D.html#aa91b6d67d3eeb16575b479c7008c1f3c" title="Get model space control variable." alt="" coords="211,5,393,47"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#ae32877503a550f7d6d59b307e9da310a" title="Returns a 4D state component of the control variable." alt="" coords="230,71,374,112"/>
</map>
</div>

</div>
</div>
<a id="a9547dce8273ee934b0cdcb18a1461f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9547dce8273ee934b0cdcb18a1461f85">&#9670;&nbsp;</a></span>newJc()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoops_1_1CostTermBase.html">CostTermBase</a>&lt; MODEL &gt; * <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::newJc </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>jcConf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a> &amp;&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create other terms of the cost function \(J_c, ..\). </p>

<p>Implements <a class="el" href="classoops_1_1CostFunction.html#aed46ad6149d43bbb7f9f1e4e1c5677b5">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00384">384</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                                                   {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keyword">const</span> eckit::LocalConfiguration jcdfi(jcConf, <span class="stringliteral">&quot;jcdfi&quot;</span>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keyword">const</span> util::DateTime vt(<a class="code" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a> + <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a> / 2);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> CostJcDFI&lt;MODEL&gt;(jcdfi, geom, vt, <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b1d97e80575d7ddd027700e36b25b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b1d97e80575d7ddd027700e36b25b0a">&#9670;&nbsp;</a></span>newJo()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoops_1_1CostJo.html">CostJo</a>&lt; MODEL &gt; * <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::newJo </td>
          <td>(</td>
          <td class="paramtype">const eckit::Configuration &amp;&#160;</td>
          <td class="paramname"><em>joConf</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create the \(J_o\) term of the cost function. </p>

<p>Implements <a class="el" href="classoops_1_1CostFunction.html#ad2c9c1bf8905241260af5738cfc278e4">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00375">375</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                            {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">const</span> util::Duration tslot(joConf.getString(<span class="stringliteral">&quot;timeslot&quot;</span>));</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> CostJo&lt;MODEL&gt;(joConf, <a class="code" href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">geom_</a>, <a class="code" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a>, <a class="code" href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">windowEnd_</a>, tslot);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5fe034e1c11fd04e8716bce861a7a20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5fe034e1c11fd04e8716bce861a7a20">&#9670;&nbsp;</a></span>runAD()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::runAD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessorAD.html">PostProcessorAD</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>cost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>idModel</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classoops_1_1Run.html">Run</a> the adjoint model. </p>

<p>Implements <a class="el" href="classoops_1_1CostFunction.html#a3e40a4b04c5c45124eb166fb5406cb32">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00441">441</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                                            {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  ASSERT(dx.state()[0].validTime() == <a class="code" href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">windowEnd_</a>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#ae32f3ea0616c66080e198dff2b0038af">CostFct_::getTLM</a>().<a class="code" href="classoops_1_1LinearModel.html#abed64b693e5ca135a5e5fd036ec35113">forecastAD</a>(dx.state()[0], dx.modVar(), <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a>, post,</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                cost, idModel);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  ASSERT(dx.state()[0].validTime() == <a class="code" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ControlIncrement_8h_source.html#l00150">oops::ControlIncrement&lt; MODEL &gt;::modVar()</a>, and <a class="el" href="ControlIncrement_8h_source.html#l00145">oops::ControlIncrement&lt; MODEL &gt;::state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_ae5fe034e1c11fd04e8716bce861a7a20_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_ae5fe034e1c11fd04e8716bce861a7a20_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_ae5fe034e1c11fd04e8716bce861a7a20_cgraph" id="classoops_1_1CostFct4DVarMF_ae5fe034e1c11fd04e8716bce861a7a20_cgraph">
<area shape="rect" title="Run the adjoint model." alt="" coords="5,39,163,80"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a45b19fa6afbc1d393f30368705c5264c" title="Get augmented model control increment." alt="" coords="211,5,365,47"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a3e7a0c18fd7fb27befb798c8e1af4a6f" title="Get state control increment." alt="" coords="211,71,365,112"/>
</map>
</div>

</div>
</div>
<a id="aff829a306be737410971cc74aa29750c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff829a306be737410971cc74aa29750c">&#9670;&nbsp;</a></span>runNL() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::runNL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#adb80c766eb605d5ebc6e567afdeb8809">Model_</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model (Trajectory) </p>

<p>Reimplemented from <a class="el" href="classoops_1_1CostFunction.html#ad378d566ae9c105bef1ab7c9206369ba">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00406">406</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                                               {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  ASSERT(xx.state().checkStatesNumber(1));</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  ASSERT(xx.state()[0].validTime() == <a class="code" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#ad9dbc320847cc239fafd5b1313bbf15e">fglr_</a>.reset(<span class="keyword">new</span> <a class="code" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a>(xx.state()[0]));</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> x0(xx.state()[0]);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  model.forecast(x0, xx.modVar(), <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a>, post);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  ASSERT(x0.validTime() == <a class="code" href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">windowEnd_</a>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="State4D_8h_source.html#l00058">oops::State4D&lt; MODEL &gt;::checkStatesNumber()</a>, <a class="el" href="oops_2interface_2Model_8h_source.html#l00116">oops::Model&lt; MODEL &gt;::forecast()</a>, <a class="el" href="ControlVariable_8h_source.html#l00137">oops::ControlVariable&lt; MODEL &gt;::modVar()</a>, <a class="el" href="ControlVariable_8h_source.html#l00131">oops::ControlVariable&lt; MODEL &gt;::state()</a>, and <a class="el" href="oops_2interface_2State_8h_source.html#l00095">oops::State&lt; MODEL &gt;::validTime()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_aff829a306be737410971cc74aa29750c_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_aff829a306be737410971cc74aa29750c_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_aff829a306be737410971cc74aa29750c_cgraph" id="classoops_1_1CostFct4DVarMF_aff829a306be737410971cc74aa29750c_cgraph">
<area shape="rect" title="Run the non&#45;linear model (Trajectory)" alt="" coords="5,187,163,228"/>
<area shape="rect" href="classoops_1_1State4D.html#aa91b6d67d3eeb16575b479c7008c1f3c" title="Get model space control variable." alt="" coords="211,77,393,119"/>
<area shape="rect" href="classoops_1_1Model.html#ac53afddeb4398d3f4ffd8ac5148ed6d0" title="Run the forecast." alt="" coords="230,143,374,170"/>
<area shape="rect" href="classoops_1_1State.html#a8cd064dfcc43549efd2c9d5b7af13b75" title="Time." alt="" coords="441,202,591,229"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#a08f7e7049122bfabb08770b9724bf094" title="Returns the auxiliary model space component of the control variable." alt="" coords="230,245,374,287"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#ae32877503a550f7d6d59b307e9da310a" title="Returns a 4D state component of the control variable." alt="" coords="230,311,374,352"/>
<area shape="rect" href="classoops_1_1PostProcessor.html#a8db30741ea49ed67b0c46854a7f04a13" title="Calls finalize method of individual processors." alt="" coords="445,5,587,47"/>
<area shape="rect" href="classoops_1_1PostProcessor.html#aa808950cbd22263adc02298a85f0750d" title="Calls initialize method of individual processors." alt="" coords="445,71,587,112"/>
<area shape="rect" href="classoops_1_1PostProcessor.html#a56e0ecddea8c1b537abe58dffec69c69" title="Calls process method of individual processors." alt="" coords="445,136,587,177"/>
</map>
</div>

</div>
</div>
<a id="a299d2d78c12ec362264601bf7ecc1dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299d2d78c12ec362264601bf7ecc1dfc">&#9670;&nbsp;</a></span>runNL() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::runNL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">CtrlVar_</a> &amp;&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>pp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classoops_1_1Run.html">Run</a> the non-linear model (HR) </p>

<p>Implements <a class="el" href="classoops_1_1CostFunction.html#a153033622acd13037540d9fed73d4924">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00394">394</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                                                     {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  ASSERT(xx.state().checkStatesNumber(1));</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  ASSERT(xx.state()[0].validTime() == <a class="code" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#ab7f4f68fcccc83a0bba4809bf8c3f627">CostFct_::getModel</a>().<a class="code" href="classoops_1_1Model.html#ac53afddeb4398d3f4ffd8ac5148ed6d0">forecast</a>(xx.state()[0], xx.modVar(), <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a>,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                post);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  ASSERT(xx.state()[0].validTime() == <a class="code" href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">windowEnd_</a>);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="State4D_8h_source.html#l00058">oops::State4D&lt; MODEL &gt;::checkStatesNumber()</a>, <a class="el" href="ControlVariable_8h_source.html#l00137">oops::ControlVariable&lt; MODEL &gt;::modVar()</a>, and <a class="el" href="ControlVariable_8h_source.html#l00131">oops::ControlVariable&lt; MODEL &gt;::state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_a299d2d78c12ec362264601bf7ecc1dfc_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_a299d2d78c12ec362264601bf7ecc1dfc_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_a299d2d78c12ec362264601bf7ecc1dfc_cgraph" id="classoops_1_1CostFct4DVarMF_a299d2d78c12ec362264601bf7ecc1dfc_cgraph">
<area shape="rect" title="Run the non&#45;linear model (HR)" alt="" coords="5,71,163,112"/>
<area shape="rect" href="classoops_1_1State4D.html#aa91b6d67d3eeb16575b479c7008c1f3c" title="Get model space control variable." alt="" coords="211,5,393,47"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#a08f7e7049122bfabb08770b9724bf094" title="Returns the auxiliary model space component of the control variable." alt="" coords="230,71,374,112"/>
<area shape="rect" href="classoops_1_1ControlVariable.html#ae32877503a550f7d6d59b307e9da310a" title="Returns a 4D state component of the control variable." alt="" coords="230,136,374,177"/>
</map>
</div>

</div>
</div>
<a id="a8b654233b92ced3da8862952cb03557c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b654233b92ced3da8862952cb03557c">&#9670;&nbsp;</a></span>runTL()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::runTL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessorTL.html">PostProcessorTL</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>cost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoops_1_1PostProcessor.html">PostProcessor</a>&lt; <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a> &gt;&#160;</td>
          <td class="paramname"><em>post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>idModel</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classoops_1_1Run.html">Run</a> the tangent linear model. </p>

<p>Implements <a class="el" href="classoops_1_1CostFunction.html#ad83281587aa637c33be0f28fc30373be">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00419">419</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                                            {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  ASSERT(dx.state()[0].validTime() == <a class="code" href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">windowBegin_</a>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="classoops_1_1CostFunction.html#ae32f3ea0616c66080e198dff2b0038af">CostFct_::getTLM</a>().<a class="code" href="classoops_1_1LinearModel.html#aed32a45374b383770ff968fe8172d724">forecastTL</a>(dx.state()[0], dx.modVar(), <a class="code" href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">windowLength_</a>, post,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                cost, idModel);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  ASSERT(dx.state()[0].validTime() == <a class="code" href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">windowEnd_</a>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ControlIncrement_8h_source.html#l00150">oops::ControlIncrement&lt; MODEL &gt;::modVar()</a>, and <a class="el" href="ControlIncrement_8h_source.html#l00145">oops::ControlIncrement&lt; MODEL &gt;::state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_a8b654233b92ced3da8862952cb03557c_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_a8b654233b92ced3da8862952cb03557c_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_a8b654233b92ced3da8862952cb03557c_cgraph" id="classoops_1_1CostFct4DVarMF_a8b654233b92ced3da8862952cb03557c_cgraph">
<area shape="rect" title="Run the tangent linear model." alt="" coords="5,39,163,80"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a45b19fa6afbc1d393f30368705c5264c" title="Get augmented model control increment." alt="" coords="211,5,365,47"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a3e7a0c18fd7fb27befb798c8e1af4a6f" title="Get state control increment." alt="" coords="211,71,365,112"/>
</map>
</div>

</div>
</div>
<a id="a40b55061887aec3791dd8125eee7fda7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40b55061887aec3791dd8125eee7fda7">&#9670;&nbsp;</a></span>zeroAD()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::zeroAD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoops_1_1CostFct4DVarMF.html#a0465daf778ea60b642c17dfdc5f3df67">CtrlInc_</a> &amp;&#160;</td>
          <td class="paramname"><em>dx</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Nullify the increment prior to running the adjoint model. </p>

<p>Implements <a class="el" href="classoops_1_1CostFunction.html#a04e734ad4bf35fec87331ba5bddf4cb0">oops::CostFunction&lt; MODEL &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00432">432</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                                     {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  dx.state()[0].zero(<a class="code" href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">windowEnd_</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  dx.modVar().zero();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  dx.obsVar().zero();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ControlIncrement_8h_source.html#l00150">oops::ControlIncrement&lt; MODEL &gt;::modVar()</a>, <a class="el" href="ControlIncrement_8h_source.html#l00155">oops::ControlIncrement&lt; MODEL &gt;::obsVar()</a>, <a class="el" href="ControlIncrement_8h_source.html#l00145">oops::ControlIncrement&lt; MODEL &gt;::state()</a>, <a class="el" href="ObsAuxIncrements_8h_source.html#l00175">oops::ObsAuxIncrements&lt; MODEL &gt;::zero()</a>, <a class="el" href="oops_2interface_2ModelAuxIncrement_8h_source.html#l00177">oops::ModelAuxIncrement&lt; MODEL &gt;::zero()</a>, and <a class="el" href="Increment4D_8h_source.html#l00207">oops::Increment4D&lt; MODEL &gt;::zero()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classoops_1_1CostFct4DVarMF_a40b55061887aec3791dd8125eee7fda7_cgraph.png" border="0" usemap="#classoops_1_1CostFct4DVarMF_a40b55061887aec3791dd8125eee7fda7_cgraph" alt=""/></div>
<map name="classoops_1_1CostFct4DVarMF_a40b55061887aec3791dd8125eee7fda7_cgraph" id="classoops_1_1CostFct4DVarMF_a40b55061887aec3791dd8125eee7fda7_cgraph">
<area shape="rect" title="Nullify the increment prior to running the adjoint model." alt="" coords="5,169,163,211"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a45b19fa6afbc1d393f30368705c5264c" title="Get augmented model control increment." alt="" coords="219,5,373,47"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a8ca2b37a736bca34976b032468669b81" title="Get augmented observation control increment." alt="" coords="219,71,373,112"/>
<area shape="rect" href="classoops_1_1ControlIncrement.html#a3e7a0c18fd7fb27befb798c8e1af4a6f" title="Get state control increment." alt="" coords="219,136,373,177"/>
<area shape="rect" href="classoops_1_1ObsAuxIncrements.html#ad32962e51a7fc2e95e80e81f652ac751" title=" " alt="" coords="213,201,379,243"/>
<area shape="rect" href="classoops_1_1ModelAuxIncrement.html#aab3ae4b1e754aaab3a984bc6fd5fc50b" title=" " alt="" coords="211,267,381,308"/>
<area shape="rect" href="classoops_1_1Increment4D.html#a6cb42404f5d669e782c15458cbbd49a3" title=" " alt="" coords="216,333,376,359"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0d525c2e1cb71c2a99423596b9061023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d525c2e1cb71c2a99423596b9061023">&#9670;&nbsp;</a></span>biasDFI_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">Increment_</a>&gt; <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::biasDFI_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>biasDFI calculated in the first trajectory and used at the end </p>

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00137">137</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="a5f47053b5a3e8f3fca5f0832e54a6eb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f47053b5a3e8f3fca5f0832e54a6eb3">&#9670;&nbsp;</a></span>costJb_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::costJb_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00126">126</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFct4DVarMF_8h_source.html#l00106">oops::CostFct4DVarMF&lt; MODEL &gt;::getCostJb()</a>.</p>

</div>
</div>
<a id="aa18ec114b6722de120d590a1d9b3deff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa18ec114b6722de120d590a1d9b3deff">&#9670;&nbsp;</a></span>costJoJc_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::costJoJc_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00125">125</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFct4DVarMF_8h_source.html#l00103">oops::CostFct4DVarMF&lt; MODEL &gt;::getCostJoJc()</a>.</p>

</div>
</div>
<a id="ad3af8ff8aff5ab89b00dd84808be6aaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3af8ff8aff5ab89b00dd84808be6aaa">&#9670;&nbsp;</a></span>ctlvars_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#a71351975edcfaee429854c8700712834">Variables_</a> <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::ctlvars_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00132">132</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="ad9dbc320847cc239fafd5b1313bbf15e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9dbc320847cc239fafd5b1313bbf15e">&#9670;&nbsp;</a></span>fglr_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">State_</a>&gt; <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::fglr_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00134">134</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="ac7c7093b0eb2c15c3e32c801efc6cbb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7c7093b0eb2c15c3e32c801efc6cbb8">&#9670;&nbsp;</a></span>geom_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">Geometry_</a>&amp; <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::geom_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00131">131</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

</div>
</div>
<a id="a73cc69ea611e9f6605951da639bb452f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73cc69ea611e9f6605951da639bb452f">&#9670;&nbsp;</a></span>windowBegin_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">util::DateTime <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::windowBegin_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00129">129</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFct4DVarMF_8h_source.html#l00143">oops::CostFct4DVarMF&lt; MODEL &gt;::CostFct4DVarMF()</a>.</p>

</div>
</div>
<a id="a2d38395aafab2f4a0f01370cc0a9ce37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d38395aafab2f4a0f01370cc0a9ce37">&#9670;&nbsp;</a></span>windowEnd_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">util::DateTime <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::windowEnd_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00130">130</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFct4DVarMF_8h_source.html#l00143">oops::CostFct4DVarMF&lt; MODEL &gt;::CostFct4DVarMF()</a>.</p>

</div>
</div>
<a id="a76c1844e51d3d78f1f84c398227b95ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76c1844e51d3d78f1f84c398227b95ae">&#9670;&nbsp;</a></span>windowLength_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MODEL &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">util::Duration <a class="el" href="classoops_1_1CostFct4DVarMF.html">oops::CostFct4DVarMF</a>&lt; MODEL &gt;::windowLength_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CostFct4DVarMF_8h_source.html#l00128">128</a> of file <a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="CostFct4DVarMF_8h_source.html#l00143">oops::CostFct4DVarMF&lt; MODEL &gt;::CostFct4DVarMF()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/oops/assimilation/<a class="el" href="CostFct4DVarMF_8h_source.html">CostFct4DVarMF.h</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclassoops_1_1CostJbTotal_html_add261887551c52f893e6485e3c84be29"><div class="ttname"><a href="classoops_1_1CostJbTotal.html#add261887551c52f893e6485e3c84be29">oops::CostJbTotal::finalizeTraj</a></div><div class="ttdeci">double finalizeTraj(JqTerm_ *, const eckit::Configuration &amp;)</div><div class="ttdoc">Various computations after the linearisation trajectory computation.</div><div class="ttdef"><b>Definition:</b> <a href="CostJbTotal_8h_source.html#l00366">CostJbTotal.h:366</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_aa18ec114b6722de120d590a1d9b3deff"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#aa18ec114b6722de120d590a1d9b3deff">oops::CostFct4DVarMF::costJoJc_</a></div><div class="ttdeci">double costJoJc_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00125">CostFct4DVarMF.h:125</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a0179c6c57603aaf9b2d193ed189c2a52"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a0179c6c57603aaf9b2d193ed189c2a52">oops::CostTermBase::initializeTraj</a></div><div class="ttdeci">virtual PostPtr_ initializeTraj(const ControlVariable&lt; MODEL &gt; &amp;, const Geometry_ &amp;, const eckit::Configuration &amp;)=0</div></div>
<div class="ttc" id="aclassoops_1_1AdvectorHandler_html_a7cf7b5f1529c5417c8c3c13ae20526ed"><div class="ttname"><a href="classoops_1_1AdvectorHandler.html#a7cf7b5f1529c5417c8c3c13ae20526ed">oops::AdvectorHandler::get</a></div><div class="ttdeci">static std::shared_ptr&lt; AdvectorHandler &gt; get()</div><div class="ttdef"><b>Definition:</b> <a href="AdvectorHandler_8h_source.html#l00061">AdvectorHandler.h:61</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_ae32f3ea0616c66080e198dff2b0038af"><div class="ttname"><a href="classoops_1_1CostFunction.html#ae32f3ea0616c66080e198dff2b0038af">oops::CostFunction::getTLM</a></div><div class="ttdeci">const LinearModel_ &amp; getTLM(const unsigned isub=0) const</div><div class="ttdoc">Access the linear model.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00167">CostFunction.h:167</a></div></div>
<div class="ttc" id="aclassoops_1_1LinearModel_html_abed64b693e5ca135a5e5fd036ec35113"><div class="ttname"><a href="classoops_1_1LinearModel.html#abed64b693e5ca135a5e5fd036ec35113">oops::LinearModel::forecastAD</a></div><div class="ttdeci">void forecastAD(Increment_ &amp;, ModelAuxIncr_ &amp;, const util::Duration &amp;, PostProcessor&lt; Increment_ &gt; post=PostProcessor&lt; Increment_ &gt;(), PostProcessorAD&lt; Increment_ &gt; cost=PostProcessorAD&lt; Increment_ &gt;(), const bool idmodel=false) const</div><div class="ttdoc">Run the adjoint forecast.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2LinearModel_8h_source.html#l00209">LinearModel.h:209</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a5f47053b5a3e8f3fca5f0832e54a6eb3"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a5f47053b5a3e8f3fca5f0832e54a6eb3">oops::CostFct4DVarMF::costJb_</a></div><div class="ttdeci">double costJb_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00126">CostFct4DVarMF.h:126</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_ac6e0c4230431691e8467ebfd3583ec3a"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#ac6e0c4230431691e8467ebfd3583ec3a">oops::CostFct4DVarMF::State_</a></div><div class="ttdeci">State&lt; MODEL &gt; State_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00060">CostFct4DVarMF.h:60</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a0d525c2e1cb71c2a99423596b9061023"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a0d525c2e1cb71c2a99423596b9061023">oops::CostFct4DVarMF::biasDFI_</a></div><div class="ttdeci">std::unique_ptr&lt; Increment_ &gt; biasDFI_</div><div class="ttdoc">biasDFI calculated in the first trajectory and used at the end</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00137">CostFct4DVarMF.h:137</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a3acfb71d2502722de8f248bcbe1cf13f"><div class="ttname"><a href="classoops_1_1CostFunction.html#a3acfb71d2502722de8f248bcbe1cf13f">oops::CostFunction::nterms</a></div><div class="ttdeci">unsigned nterms() const</div><div class="ttdoc">Return the numer of other cost function terms .</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00153">CostFunction.h:153</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a2d38395aafab2f4a0f01370cc0a9ce37"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a2d38395aafab2f4a0f01370cc0a9ce37">oops::CostFct4DVarMF::windowEnd_</a></div><div class="ttdeci">util::DateTime windowEnd_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00130">CostFct4DVarMF.h:130</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_adb80c766eb605d5ebc6e567afdeb8809"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#adb80c766eb605d5ebc6e567afdeb8809">oops::CostFct4DVarMF::Model_</a></div><div class="ttdeci">Model&lt; MODEL &gt; Model_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00061">CostFct4DVarMF.h:61</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a0bcfda435fb7dd9cd18f94aa10ce60fb"><div class="ttname"><a href="classoops_1_1CostFunction.html#a0bcfda435fb7dd9cd18f94aa10ce60fb">oops::CostFunction::CostFunction</a></div><div class="ttdeci">CostFunction(const eckit::Configuration &amp;, const Geometry_ &amp;, const Model_ &amp;)</div><div class="ttdoc">Construct a cost function.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00299">CostFunction.h:299</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a7462cc85a443a23ba769995acc5d5bc0"><div class="ttname"><a href="classoops_1_1CostFunction.html#a7462cc85a443a23ba769995acc5d5bc0">oops::CostFunction::getJterm</a></div><div class="ttdeci">CostBase_ &amp; getJterm(const unsigned ii) const</div><div class="ttdoc">Non const access to JTerms for linearize() method in concrete cost-functions.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00174">CostFunction.h:174</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_ad3af8ff8aff5ab89b00dd84808be6aaa"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#ad3af8ff8aff5ab89b00dd84808be6aaa">oops::CostFct4DVarMF::ctlvars_</a></div><div class="ttdeci">const Variables_ ctlvars_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00132">CostFct4DVarMF.h:132</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_ac8de01ffb54d775a6a7e1630c341d7ab"><div class="ttname"><a href="classoops_1_1CostFunction.html#ac8de01ffb54d775a6a7e1630c341d7ab">oops::CostFunction::getJb</a></div><div class="ttdeci">JbTotal_ &amp; getJb() const</div><div class="ttdoc">Non const access to Jb for linearize() method in concrete cost-functions</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00177">CostFunction.h:177</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a76c1844e51d3d78f1f84c398227b95ae"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a76c1844e51d3d78f1f84c398227b95ae">oops::CostFct4DVarMF::windowLength_</a></div><div class="ttdeci">util::Duration windowLength_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00128">CostFct4DVarMF.h:128</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_ab7f4f68fcccc83a0bba4809bf8c3f627"><div class="ttname"><a href="classoops_1_1CostFunction.html#ab7f4f68fcccc83a0bba4809bf8c3f627">oops::CostFunction::getModel</a></div><div class="ttdeci">const Model_ &amp; getModel() const</div><div class="ttdoc">Access the non-linear model.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00165">CostFunction.h:165</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a949b93cb5d1a70ee4c2bdbe93e9bdaa1"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a949b93cb5d1a70ee4c2bdbe93e9bdaa1">oops::CostFct4DVarMF::WeightedMean_</a></div><div class="ttdeci">DFIProcessor&lt; MODEL &gt; WeightedMean_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00067">CostFct4DVarMF.h:67</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a2408cc69c0e08f7d35b927a4a366fe22"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a2408cc69c0e08f7d35b927a4a366fe22">oops::CostFct4DVarMF::TrajectorySaver_</a></div><div class="ttdeci">TrajectorySaverMF&lt; MODEL &gt; TrajectorySaver_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00065">CostFct4DVarMF.h:65</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_ad3421d7225ee13dbbda107c59967358d"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#ad3421d7225ee13dbbda107c59967358d">oops::CostFct4DVarMF::Increment_</a></div><div class="ttdeci">Increment&lt; MODEL &gt; Increment_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00055">CostFct4DVarMF.h:55</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a299d2d78c12ec362264601bf7ecc1dfc"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a299d2d78c12ec362264601bf7ecc1dfc">oops::CostFct4DVarMF::runNL</a></div><div class="ttdeci">void runNL(CtrlVar_ &amp;xx, PostProcessor&lt; State_ &gt; &amp;pp) const override</div><div class="ttdoc">Run the non-linear model (HR)</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00394">CostFct4DVarMF.h:394</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a56903c9685b92ca9ca3fe86fef575b75"><div class="ttname"><a href="classoops_1_1CostFunction.html#a56903c9685b92ca9ca3fe86fef575b75">oops::CostFunction::setupTerms</a></div><div class="ttdeci">void setupTerms(const eckit::Configuration &amp;)</div><div class="ttdoc">Set up terms of the cost function .</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00317">CostFunction.h:317</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_ad9ec3f9b3f42c160be9d697b0b0f762d"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#ad9ec3f9b3f42c160be9d697b0b0f762d">oops::CostFct4DVarMF::Geometry_</a></div><div class="ttdeci">Geometry&lt; MODEL &gt; Geometry_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00059">CostFct4DVarMF.h:59</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a73cc69ea611e9f6605951da639bb452f"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a73cc69ea611e9f6605951da639bb452f">oops::CostFct4DVarMF::windowBegin_</a></div><div class="ttdeci">util::DateTime windowBegin_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00129">CostFct4DVarMF.h:129</a></div></div>
<div class="ttc" id="aclassoops_1_1Model_html_ac53afddeb4398d3f4ffd8ac5148ed6d0"><div class="ttname"><a href="classoops_1_1Model.html#ac53afddeb4398d3f4ffd8ac5148ed6d0">oops::Model::forecast</a></div><div class="ttdeci">void forecast(State_ &amp;, const ModelAux_ &amp;, const util::Duration &amp;, PostProcessor&lt; State_ &gt; &amp;) const</div><div class="ttdoc">Run the forecast.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2Model_8h_source.html#l00116">Model.h:116</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFunction_html_a7dfe7e1cc401e3206e0a0db086f43c72"><div class="ttname"><a href="classoops_1_1CostFunction.html#a7dfe7e1cc401e3206e0a0db086f43c72">oops::CostFunction::evaluate</a></div><div class="ttdeci">virtual double evaluate(const CtrlVar_ &amp;, const eckit::Configuration &amp;config=eckit::LocalConfiguration(), PostProcessor&lt; State_ &gt; post=PostProcessor&lt; State_ &gt;()) const</div><div class="ttdoc">Evaluate the non-linear cost function.</div><div class="ttdef"><b>Definition:</b> <a href="CostFunction_8h_source.html#l00353">CostFunction.h:353</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_ab95508ae4bc396c30e8b3316c456cdd3"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#ab95508ae4bc396c30e8b3316c456cdd3">oops::CostFct4DVarMF::WeightedDiff_</a></div><div class="ttdeci">WeightedDiff&lt; MODEL, Increment_, State_ &gt; WeightedDiff_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00066">CostFct4DVarMF.h:66</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_ad9dbc320847cc239fafd5b1313bbf15e"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#ad9dbc320847cc239fafd5b1313bbf15e">oops::CostFct4DVarMF::fglr_</a></div><div class="ttdeci">std::unique_ptr&lt; State_ &gt; fglr_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00134">CostFct4DVarMF.h:134</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_a1ed9a9b0b67d604ae3eb04c4a4685d04"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#a1ed9a9b0b67d604ae3eb04c4a4685d04">oops::CostFct4DVarMF::CtrlVar_</a></div><div class="ttdeci">ControlVariable&lt; MODEL &gt; CtrlVar_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00057">CostFct4DVarMF.h:57</a></div></div>
<div class="ttc" id="aclassoops_1_1LinearModel_html_aed32a45374b383770ff968fe8172d724"><div class="ttname"><a href="classoops_1_1LinearModel.html#aed32a45374b383770ff968fe8172d724">oops::LinearModel::forecastTL</a></div><div class="ttdeci">void forecastTL(Increment_ &amp;, const ModelAuxIncr_ &amp;, const util::Duration &amp;, PostProcessor&lt; Increment_ &gt; post=PostProcessor&lt; Increment_ &gt;(), PostProcessorTL&lt; Increment_ &gt; cost=PostProcessorTL&lt; Increment_ &gt;(), const bool idmodel=false) const</div><div class="ttdoc">Run the tangent linear forecast.</div><div class="ttdef"><b>Definition:</b> <a href="oops_2interface_2LinearModel_8h_source.html#l00163">LinearModel.h:163</a></div></div>
<div class="ttc" id="aclassoops_1_1CostFct4DVarMF_html_ac7c7093b0eb2c15c3e32c801efc6cbb8"><div class="ttname"><a href="classoops_1_1CostFct4DVarMF.html#ac7c7093b0eb2c15c3e32c801efc6cbb8">oops::CostFct4DVarMF::geom_</a></div><div class="ttdeci">const Geometry_ &amp; geom_</div><div class="ttdef"><b>Definition:</b> <a href="CostFct4DVarMF_8h_source.html#l00131">CostFct4DVarMF.h:131</a></div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a57e653ebb4c983b00a50c6b7fa50b8aa"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a57e653ebb4c983b00a50c6b7fa50b8aa">oops::CostTermBase::finalize</a></div><div class="ttdeci">virtual double finalize(const eckit::Configuration &amp;) const =0</div><div class="ttdoc">Perform computations after nonlinear model integration.</div></div>
<div class="ttc" id="aclassoops_1_1CostTermBase_html_a9978e5ad0a907e52ab609f26fc3b89e6"><div class="ttname"><a href="classoops_1_1CostTermBase.html#a9978e5ad0a907e52ab609f26fc3b89e6">oops::CostTermBase::finalizeTraj</a></div><div class="ttdeci">virtual double finalizeTraj(const eckit::Configuration &amp;)=0</div><div class="ttdoc">Perform computation after the linearisation trajectory computation.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
